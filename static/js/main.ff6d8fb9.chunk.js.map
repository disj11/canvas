{"version":3,"sources":["models/canvas/ToolTypes.tsx","templates/layout/Layout.tsx","components/tools/ToolButton.tsx","models/canvas/CanvasMode.tsx","models/canvas/CanvasEvent.tsx","models/canvas/Brush.tsx","models/canvas/Shape.tsx","stores/CanvasStore.tsx","utils/FileUtils.tsx","contexts/StoreContext.tsx","stores/RootStore.tsx","hooks/useStores.tsx","components/tools/MenuToolButton.tsx","components/tools/ToolBox.tsx","components/tools/BrushPropBox.tsx","components/tools/ShapePropBox.tsx","components/tools/PropBox.tsx","templates/canvas/Canvas.tsx","App.tsx","index.tsx"],"names":["ToolTypes","useStyles","makeStyles","progressWrapper","display","justifyContent","alignItems","Layout","loading","children","classes","Fragment","CssBaseline","className","CircularProgress","theme","button","cursor","color","paddingTop","spacing","paddingBottom","paddingRight","paddingLeft","textAlign","caption","fontSize","selected","background","ToolButton","icon","text","onClick","clsx","CanvasMode","canvasStore","this","canvas","isDrawingMode","selectable","defaultCursor","discardActiveObject","renderAll","resetCanvas","setTool","CanvasModeFactory","selectedTool","SELECT","SelectCanvasMode","BRUSH","BrushCanvasMode","SHAPE","ShapeCanvasMode","MIN_OBJECT_SIZE","CanvasEvent","shareObject","e","startCursorPosition","x","y","currentCursorPosition","isDown","on","MOUSE_UP","handleMouseUp","bind","MOUSE_MOVE","handleMouseMove","MOUSE_DOWN","handleMouseDown","SELECTION_CREATED","handleSelectObject","SELECTION_UPDATED","SELECTION_CLEARED","handleDeSelectObject","activeObject","getActiveObject","activeObjects","getActiveObjects","undefined","CanvasMouseUpEventFactory","getInstance","handle","getCursorPosition","CanvasMouseDownEventFactory","CanvasMouseMoveEventFactory","getPointer","ShapeCanvasMouseUpEvent","ShapeCanvasMouseDownEvent","ShapeCanvasMouseMoveEvent","object","isType","set","width","Math","max","height","setCoords","circle","radius","shapeType","getShape","left","top","hasBorder","stroke","strokeWidth","fill","hoverCursor","add","abs","BrushType","value","_values","push","PENCIL","fabric","PencilBrush","CIRCLE","CircleBrush","SPRAY","SprayBrush","values","find","v","ShapeType","options","RECT","Rect","Circle","TRIANGLE","Triangle","MimeType","CanvasStore","canvasId","_canvas","_width","_height","_backgroundColor","_selectedTool","_selectable","_brushType","_shapeType","_activeObject","_activeObjects","makeAutoObservable","el","Canvas","init","select","selection","getObjects","forEach","obj","freeDrawingBrush","getBrush","rootStore","StoreContext","React","createContext","StoreContextProvider","Provider","useStores","useContext","FileUtils","fileName","blob","Blob","type","TEXT","objectURL","window","URL","createObjectURL","write","dataURL","a","document","createElement","download","href","click","file","Promise","resolve","reject","reader","FileReader","onload","result","onerror","readAsText","StyledMenu","withStyles","paper","border","props","Menu","elevation","getContentAnchorEl","anchorOrigin","vertical","horizontal","transformOrigin","StyledMenuItem","root","backgroundColor","palette","primary","main","common","white","MenuItem","MenuToolButton","useState","anchorEl","setAnchorEl","inputRef","useRef","handleClose","onChange","target","files","item","read","then","jsonString","loadFromJSON","catch","console","error","ref","style","accept","event","currentTarget","keepMounted","open","Boolean","onClose","current","ListItemIcon","ListItemText","writeText","JSON","stringify","toJSON","fullQuality","toDataURL","appBarColor","center","flex","right","ToolBox","observer","AppBar","colorDefault","Toolbar","variant","title","marginBottom","input","padding","borderRadius","BrushPropBox","Typography","Box","mb","Select","native","brushType","valueOf","label","fullWidth","map","brush","ShapePropBox","shape","PropBox","flexDirection","flexBox","contents","flexBasis","canvasWrapper","useEffect","getElementById","initCanvas","id","App","ReactDOM","render","StrictMode"],"mappings":"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","file":"static/js/main.ff6d8fb9.chunk.js","sourcesContent":["export enum ToolTypes {\r\n    SELECT,\r\n    BRUSH,\r\n    SHAPE,\r\n}","import React from \"react\";\r\nimport CssBaseline from \"@material-ui/core/CssBaseline\";\r\nimport {CircularProgress} from \"@material-ui/core\";\r\nimport makeStyles from \"@material-ui/core/styles/makeStyles\";\r\n\r\nconst useStyles = makeStyles(() => ({\r\n    progressWrapper: {\r\n        display: \"flex\",\r\n        justifyContent: \"center\",\r\n        alignItems: \"center\",\r\n    }\r\n}))\r\n\r\nconst Layout = ({ loading, children }: Props) => {\r\n    const classes = useStyles();\r\n\r\n    return (\r\n        <React.Fragment>\r\n            <CssBaseline />\r\n            <div>\r\n                {loading ? (\r\n                    <div className={classes.progressWrapper}><CircularProgress /></div>\r\n                ) : children}\r\n            </div>\r\n        </React.Fragment>\r\n    )\r\n}\r\n\r\ninterface Props {\r\n    loading?: boolean;\r\n    children: React.ReactElement | React.ReactElement[];\r\n}\r\n\r\nexport default Layout;","import React from \"react\";\r\nimport makeStyles from \"@material-ui/core/styles/makeStyles\";\r\nimport clsx from \"clsx\";\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n    button: {\r\n        display: \"inline-block\",\r\n        cursor: \"pointer\",\r\n        color: \"#fff\",\r\n        paddingTop: theme.spacing(0.5),\r\n        paddingBottom: theme.spacing(0.5),\r\n        paddingRight: theme.spacing(3),\r\n        paddingLeft: theme.spacing(3),\r\n        textAlign: \"center\",\r\n    },\r\n    caption: {\r\n        fontSize: \"0.70rem\",\r\n    },\r\n    selected: {\r\n        background: \"linear-gradient(90deg, rgba(172,118,255,1) 0%, rgba(91,91,255,1) 100%)\",\r\n    }\r\n}));\r\n\r\nconst ToolButton = ({icon, text, onClick, selected}: Props) => {\r\n    const classes = useStyles();\r\n    return (\r\n        <div className={clsx(classes.button, {\r\n            [classes.selected]: selected,\r\n        })} onClick={onClick}>\r\n            {icon}\r\n            <div className={classes.caption}>{text}</div>\r\n        </div>\r\n    )\r\n}\r\n\r\ninterface Props {\r\n    icon: any;\r\n    text: string;\r\n    onClick: (event: React.MouseEvent<HTMLElement>) => void;\r\n    selected?: boolean;\r\n}\r\n\r\nexport default ToolButton;","import {ToolTypes} from \"./ToolTypes\";\r\nimport {CanvasStore} from \"../../stores/CanvasStore\";\r\n\r\nabstract class CanvasMode {\r\n    constructor(protected canvasStore: CanvasStore) {\r\n    }\r\n\r\n    protected abstract setTool(): void;\r\n\r\n    private resetCanvas() {\r\n        this.canvasStore.canvas.isDrawingMode = false;\r\n        this.canvasStore.selectable = false;\r\n        this.canvasStore.canvas.defaultCursor = \"default\";\r\n        this.canvasStore.canvas.discardActiveObject().renderAll();\r\n    }\r\n\r\n    public select() {\r\n        this.resetCanvas();\r\n        this.setTool();\r\n    }\r\n}\r\n\r\nexport class CanvasModeFactory {\r\n    public static getInstance(canvasStore: CanvasStore): CanvasMode {\r\n        switch (canvasStore.selectedTool) {\r\n            case ToolTypes.SELECT:\r\n                return new SelectCanvasMode(canvasStore);\r\n            case ToolTypes.BRUSH:\r\n                return new BrushCanvasMode(canvasStore);\r\n            case ToolTypes.SHAPE:\r\n                return new ShapeCanvasMode(canvasStore);\r\n            default:\r\n                return new BrushCanvasMode(canvasStore);\r\n        }\r\n    }\r\n}\r\n\r\nclass SelectCanvasMode extends CanvasMode {\r\n    protected setTool(): void {\r\n        this.canvasStore.selectable = true;\r\n    }\r\n}\r\n\r\nclass BrushCanvasMode extends CanvasMode {\r\n    protected setTool(): void {\r\n        this.canvasStore.canvas.isDrawingMode = true;\r\n    }\r\n}\r\n\r\nclass ShapeCanvasMode extends CanvasMode {\r\n    protected setTool(): void {\r\n        this.canvasStore.canvas.defaultCursor = \"crosshair\";\r\n    }\r\n}","import {CanvasStore} from \"../../stores/CanvasStore\";\r\nimport {ToolTypes} from \"./ToolTypes\";\r\nimport {IEvent} from \"fabric/fabric-impl\";\r\nimport {fabric} from \"fabric\";\r\n\r\nconst MIN_OBJECT_SIZE = 10;\r\n\r\ninterface CanvasEventObject {\r\n    e: IEvent,\r\n    canvasStore: CanvasStore,\r\n    startCursorPosition: {x: number, y: number}\r\n    currentCursorPosition: {x: number, y: number}\r\n    isDown: boolean,\r\n}\r\n\r\ninterface ShapeCanvasEvent extends CanvasEventObject {\r\n    object: fabric.Object,\r\n}\r\n\r\nexport class CanvasEvent {\r\n    protected static MOUSE_UP = \"mouse:up\";\r\n    protected static MOUSE_DOWN = \"mouse:down\";\r\n    protected static MOUSE_MOVE = \"mouse:move\";\r\n    protected static SELECTION_CLEARED = \"selection:cleared\";\r\n    protected static SELECTION_CREATED = \"selection:created\";\r\n    protected static SELECTION_UPDATED = \"selection:updated\";\r\n\r\n    private shareObject: CanvasEventObject = {\r\n        e: {} as IEvent,\r\n        canvasStore: this.canvasStore,\r\n        startCursorPosition: {x: 0, y: 0},\r\n        currentCursorPosition: {x: 0, y: 0},\r\n        isDown: false\r\n    };\r\n\r\n    constructor(private readonly canvasStore: CanvasStore) {\r\n    }\r\n\r\n    public init() {\r\n        const canvas = this.canvasStore.canvas;\r\n        canvas.on(CanvasEvent.MOUSE_UP, this.handleMouseUp.bind(this));\r\n        canvas.on(CanvasEvent.MOUSE_MOVE, this.handleMouseMove.bind(this));\r\n        canvas.on(CanvasEvent.MOUSE_DOWN, this.handleMouseDown.bind(this));\r\n        canvas.on(CanvasEvent.SELECTION_CREATED, this.handleSelectObject.bind(this));\r\n        canvas.on(CanvasEvent.SELECTION_UPDATED, this.handleSelectObject.bind(this));\r\n        canvas.on(CanvasEvent.SELECTION_CLEARED, this.handleDeSelectObject.bind(this));\r\n    }\r\n\r\n    private handleSelectObject() {\r\n        const canvas = this.canvasStore.canvas;\r\n        this.canvasStore.activeObject = canvas.getActiveObject();\r\n        this.canvasStore.activeObjects = canvas.getActiveObjects();\r\n    }\r\n\r\n    private handleDeSelectObject() {\r\n        this.canvasStore.activeObject = undefined;\r\n        this.canvasStore.activeObjects = [];\r\n    }\r\n\r\n    private handleMouseUp(e: IEvent) {\r\n        this.shareObject.e = e;\r\n        this.shareObject.isDown = false;\r\n        CanvasMouseUpEventFactory.getInstance(this.canvasStore)?.handle(this.shareObject);\r\n    }\r\n\r\n    private handleMouseDown(e: IEvent) {\r\n        this.shareObject.e = e;\r\n        this.shareObject.isDown = true;\r\n        this.shareObject.startCursorPosition = {...this.getCursorPosition(e)};\r\n        this.shareObject.currentCursorPosition = {...this.getCursorPosition(e)};\r\n        CanvasMouseDownEventFactory.getInstance(this.canvasStore)?.handle(this.shareObject);\r\n    };\r\n\r\n    private handleMouseMove(e: IEvent) {\r\n        this.shareObject.e = e;\r\n        this.shareObject.currentCursorPosition = {...this.getCursorPosition(e)};\r\n        if (this.shareObject.isDown) {\r\n            CanvasMouseMoveEventFactory.getInstance(this.canvasStore)?.handle(this.shareObject);\r\n        }\r\n    };\r\n\r\n    private getCursorPosition(e: IEvent) {\r\n        return this.canvasStore.canvas.getPointer(e.e);\r\n    }\r\n}\r\n\r\ninterface CanvasEventHandler<T extends CanvasEventObject> {\r\n    handle(e: T): void;\r\n}\r\n\r\nclass CanvasMouseUpEventFactory {\r\n    public static getInstance(canvasStore: CanvasStore): CanvasEventHandler<CanvasEventObject> | null {\r\n        switch (canvasStore.selectedTool) {\r\n            case ToolTypes.SHAPE:\r\n                return new ShapeCanvasMouseUpEvent();\r\n            default:\r\n                return null;\r\n        }\r\n    }\r\n}\r\n\r\nclass CanvasMouseDownEventFactory {\r\n    public static getInstance(canvasStore: CanvasStore): CanvasEventHandler<CanvasEventObject> | null {\r\n        switch (canvasStore.selectedTool) {\r\n            case ToolTypes.SHAPE:\r\n                return new ShapeCanvasMouseDownEvent();\r\n            default:\r\n                return null;\r\n        }\r\n    }\r\n}\r\n\r\nclass CanvasMouseMoveEventFactory {\r\n    public static getInstance(canvasStore: CanvasStore): CanvasEventHandler<CanvasEventObject> | null {\r\n        switch (canvasStore.selectedTool) {\r\n            case ToolTypes.SHAPE:\r\n                return new ShapeCanvasMouseMoveEvent();\r\n            default:\r\n                return null;\r\n        }\r\n    }\r\n}\r\n\r\nclass ShapeCanvasMouseUpEvent implements CanvasEventHandler<ShapeCanvasEvent> {\r\n    handle(e: ShapeCanvasEvent): void {\r\n        if (e.object.isType(\"rect\") || e.object.isType(\"triangle\")) {\r\n            e.object.set({\r\n                width: Math.max(MIN_OBJECT_SIZE, e.object.width || MIN_OBJECT_SIZE),\r\n                height: Math.max(MIN_OBJECT_SIZE, e.object.height || MIN_OBJECT_SIZE),\r\n            }).setCoords();\r\n        } else if (e.object.isType(\"circle\")) {\r\n            const circle = e.object as fabric.Circle;\r\n            circle.set(\"radius\", Math.max(MIN_OBJECT_SIZE, circle.radius || MIN_OBJECT_SIZE))\r\n                .setCoords();\r\n        }\r\n        e.canvasStore.canvas.renderAll();\r\n    }\r\n}\r\n\r\nclass ShapeCanvasMouseDownEvent implements CanvasEventHandler<ShapeCanvasEvent> {\r\n    handle(e: ShapeCanvasEvent): void {\r\n        e.object = e.canvasStore.shapeType.getShape({\r\n            left: e.startCursorPosition.x,\r\n            top: e.startCursorPosition.y,\r\n            hasBorder: true,\r\n            stroke: \"#000\",\r\n            strokeWidth: 3,\r\n            fill:\"transparent\",\r\n            selectable: false,\r\n            hoverCursor: \"default\",\r\n        });\r\n\r\n        if (e.object.isType(\"rect\") || e.object.isType(\"triangle\")) {\r\n            e.object.set({\r\n                width: 0,\r\n                height: 0,\r\n            })\r\n        } else if (e.object.isType(\"circle\")) {\r\n            (e.object as fabric.Circle).set(\"radius\", 0);\r\n        }\r\n\r\n        e.canvasStore.canvas.add(e.object);\r\n    }\r\n}\r\n\r\nclass ShapeCanvasMouseMoveEvent implements CanvasEventHandler<ShapeCanvasEvent> {\r\n    handle(e: ShapeCanvasEvent): void {\r\n        if(e.currentCursorPosition.x < e.startCursorPosition.x){\r\n            e.object.set(\"left\", Math.abs(e.currentCursorPosition.x));\r\n        }\r\n\r\n        if(e.currentCursorPosition.y < e.startCursorPosition.y){\r\n            e.object.set(\"top\", Math.abs(e.currentCursorPosition.y));\r\n        }\r\n\r\n        if (e.object.isType(\"rect\") || e.object.isType(\"triangle\")) {\r\n            e.object.set({\r\n                width: Math.abs(e.startCursorPosition.x - e.currentCursorPosition.x),\r\n                height: Math.abs(e.startCursorPosition.y - e.currentCursorPosition.y),\r\n            });\r\n        } else if (e.object.isType(\"circle\")) {\r\n            (e.object as fabric.Circle).set(\"radius\", Math.abs(e.startCursorPosition.x - e.currentCursorPosition.x));\r\n        }\r\n\r\n        e.canvasStore.canvas.renderAll();\r\n    }\r\n}\r\n\r\n","import {fabric} from \"fabric\";\r\n\r\nexport class BrushType {\r\n    private static readonly _values: BrushType[] = [];\r\n    public static readonly PENCIL = new BrushType(\"pencil\", \"연필\");\r\n    public static readonly CIRCLE = new BrushType(\"circle\", \"원형\");\r\n    public static readonly SPRAY = new BrushType(\"spray\", \"스프레이\");\r\n\r\n    constructor(\r\n        public readonly value: string,\r\n        public readonly display: string,\r\n    ) {\r\n        BrushType._values.push(this);\r\n    }\r\n\r\n    public static values() {\r\n        return this._values;\r\n    }\r\n\r\n    public static valueOf(value: string) {\r\n        return this.values().find(v => v.value === value);\r\n    }\r\n\r\n    public getBrush(canvas: fabric.Canvas) {\r\n        switch (this) {\r\n            case BrushType.PENCIL:\r\n                return new (fabric.PencilBrush as any)(canvas);\r\n            case BrushType.CIRCLE:\r\n                return new (fabric.CircleBrush as any)(canvas);\r\n            case BrushType.SPRAY:\r\n                return new (fabric.SprayBrush as any)(canvas);\r\n            default:\r\n                return new (fabric.PencilBrush as any)(canvas);\r\n        }\r\n    }\r\n}","import {fabric} from \"fabric\";\r\n\r\nexport class ShapeType {\r\n    private static readonly _values: ShapeType[] = [];\r\n    public static readonly RECT = new ShapeType(\"rect\", \"사각형\");\r\n    public static readonly CIRCLE = new ShapeType(\"circle\", \"원\");\r\n    public static readonly TRIANGLE = new ShapeType(\"triangle\", \"삼각형\");\r\n\r\n    constructor(\r\n        public readonly value: string,\r\n        public readonly display: string,\r\n    ) {\r\n        ShapeType._values.push(this);\r\n    }\r\n\r\n    public static values() {\r\n        return this._values;\r\n    }\r\n\r\n    public static valueOf(value: string) {\r\n        return this.values().find(v => v.value === value);\r\n    }\r\n\r\n    public getShape<T extends fabric.IObjectOptions>(options: T) {\r\n        switch (this) {\r\n            case ShapeType.RECT:\r\n                return new fabric.Rect(options);\r\n            case ShapeType.CIRCLE:\r\n                return new fabric.Circle(options);\r\n            case ShapeType.TRIANGLE:\r\n                return new fabric.Triangle(options);\r\n            default:\r\n                return new fabric.Rect(options);\r\n        }\r\n    }\r\n}","import {makeAutoObservable} from \"mobx\";\r\nimport {fabric} from \"fabric\";\r\nimport {ToolTypes} from \"../models/canvas/ToolTypes\";\r\nimport {CanvasModeFactory} from \"../models/canvas/CanvasMode\";\r\nimport {CanvasEvent} from \"../models/canvas/CanvasEvent\";\r\nimport {BrushType} from \"../models/canvas/Brush\";\r\nimport {ShapeType} from \"../models/canvas/Shape\";\r\n\r\nexport class CanvasStore {\r\n    public readonly canvasId = \"canvas\";\r\n    private _canvas = {} as fabric.Canvas;\r\n    private _width = 500;\r\n    private _height = 500;\r\n    private _backgroundColor = \"white\";\r\n    private _selectedTool: ToolTypes = ToolTypes.SELECT;\r\n    private _selectable = false;\r\n    private _brushType = BrushType.PENCIL;\r\n    private _shapeType = ShapeType.RECT;\r\n    private _activeObject: fabric.Object | undefined;\r\n    private _activeObjects: fabric.Object[] = [];\r\n\r\n    constructor() {\r\n        makeAutoObservable(this);\r\n    }\r\n\r\n    public initCanvas(el: HTMLCanvasElement, options?: fabric.ICanvasOptions) {\r\n        this._canvas = new fabric.Canvas(el, options);\r\n        this.selectedTool = this._selectedTool;\r\n        new CanvasEvent(this).init();\r\n    }\r\n\r\n    get canvas() {\r\n        return this._canvas;\r\n    }\r\n\r\n    get width(): number {\r\n        return this._width;\r\n    }\r\n\r\n    set width(value: number) {\r\n        this._width = value;\r\n    }\r\n\r\n    get height(): number {\r\n        return this._height;\r\n    }\r\n\r\n    set height(value: number) {\r\n        this._height = value;\r\n    }\r\n\r\n    get backgroundColor(): string {\r\n        return this._backgroundColor;\r\n    }\r\n\r\n    set backgroundColor(value: string) {\r\n        this._backgroundColor = value;\r\n    }\r\n\r\n    get selectedTool(): ToolTypes {\r\n        return this._selectedTool;\r\n    }\r\n\r\n    set selectedTool(value: ToolTypes) {\r\n        this._selectedTool = value;\r\n        CanvasModeFactory.getInstance(this).select();\r\n    }\r\n\r\n    get selectable(): boolean {\r\n        return this._selectable;\r\n    }\r\n\r\n    set selectable(value: boolean) {\r\n        this.canvas.selection = value;\r\n        this.canvas.getObjects().forEach(obj => {\r\n            obj.selectable = value;\r\n            obj.hoverCursor = value ? \"move\" : \"default\";\r\n        });\r\n    }\r\n\r\n    get brushType(): BrushType {\r\n        return this._brushType;\r\n    }\r\n\r\n    set brushType(value: BrushType) {\r\n        this._brushType = value;\r\n        this.canvas.freeDrawingBrush = value.getBrush(this.canvas);\r\n    }\r\n\r\n    get shapeType(): ShapeType {\r\n        return this._shapeType;\r\n    }\r\n\r\n    set shapeType(value: ShapeType) {\r\n        this._shapeType = value;\r\n    }\r\n\r\n    get activeObject(): fabric.Object | undefined {\r\n        return this._activeObject;\r\n    }\r\n\r\n    set activeObject(value: fabric.Object | undefined) {\r\n        this._activeObject = value;\r\n    }\r\n\r\n    get activeObjects(): fabric.Object[] {\r\n        return this._activeObjects;\r\n    }\r\n\r\n    set activeObjects(value: fabric.Object[]) {\r\n        this._activeObjects = value;\r\n    }\r\n}","enum MimeType {\r\n    TEXT = \"text/plain\",\r\n}\r\n\r\nexport class FileUtils {\r\n    public static writeText(fileName: string, text: string) {\r\n        const blob = new Blob([text], { type: MimeType.TEXT });\r\n        const objectURL = window.URL.createObjectURL(blob);\r\n        this.write(fileName, objectURL);\r\n    }\r\n\r\n    public static write(fileName: string, dataURL: string) {\r\n        const a = document.createElement('a');\r\n        a.download = fileName;\r\n        a.href = dataURL;\r\n        a.click();\r\n    }\r\n\r\n    public static async read(file: File): Promise<string> {\r\n        return new Promise((resolve, reject) => {\r\n            const reader = new FileReader();\r\n            reader.onload = () => resolve(reader.result as string);\r\n            reader.onerror = () => reject();\r\n            reader.readAsText(file);\r\n        });\r\n    }\r\n}","import React from \"react\";\r\nimport {RootStore} from \"../stores/RootStore\";\r\n\r\nconst rootStore = new RootStore();\r\nexport const StoreContext = React.createContext<RootStore>(rootStore);\r\nexport const StoreContextProvider = ({children}: StoreProviderProps) => {\r\n    return (\r\n        <StoreContext.Provider value={rootStore}>\r\n            {children}\r\n        </StoreContext.Provider>\r\n    )\r\n}\r\n\r\ninterface StoreProviderProps {\r\n    children: JSX.Element;\r\n}","import {CanvasStore} from \"./CanvasStore\";\r\n\r\nexport class RootStore {\r\n    public readonly canvasStore;\r\n\r\n    constructor() {\r\n        this.canvasStore = new CanvasStore();\r\n    }\r\n}","import React from \"react\";\r\nimport {RootStore} from \"../stores/RootStore\";\r\nimport {StoreContext} from \"../contexts/StoreContext\";\r\n\r\nexport const useStores = (): RootStore => React.useContext(StoreContext);","import React from \"react\";\r\nimport {withStyles} from \"@material-ui/core/styles\";\r\nimport Menu, {MenuProps} from \"@material-ui/core/Menu\";\r\nimport MenuItem from \"@material-ui/core/MenuItem\";\r\nimport ListItemIcon from \"@material-ui/core/ListItemIcon\";\r\nimport ListItemText from \"@material-ui/core/ListItemText\";\r\nimport ToolButton from \"./ToolButton\";\r\nimport MenuIcon from \"@material-ui/icons/Menu\";\r\nimport DescriptionIcon from \"@material-ui/icons/Description\";\r\nimport SaveIcon from \"@material-ui/icons/Save\";\r\nimport SaveAltIcon from \"@material-ui/icons/SaveAlt\";\r\nimport {useStores} from \"../../hooks/useStores\";\r\nimport {FileUtils} from \"../../utils/FileUtils\";\r\n\r\nconst StyledMenu = withStyles({\r\n    paper: {\r\n        border: \"1px solid #d3d4d5\",\r\n    },\r\n})((props: MenuProps) => (\r\n    <Menu\r\n        elevation={0}\r\n        getContentAnchorEl={null}\r\n        anchorOrigin={{\r\n            vertical: \"bottom\",\r\n            horizontal: \"center\",\r\n        }}\r\n        transformOrigin={{\r\n            vertical: \"top\",\r\n            horizontal: \"center\",\r\n        }}\r\n        {...props}\r\n    />\r\n));\r\n\r\nconst StyledMenuItem = withStyles((theme) => ({\r\n    root: {\r\n        \"&:focus\": {\r\n            backgroundColor: theme.palette.primary.main,\r\n            \"& .MuiListItemIcon-root, & .MuiListItemText-primary\": {\r\n                color: theme.palette.common.white,\r\n            },\r\n        },\r\n    },\r\n}))(MenuItem);\r\n\r\nexport default function MenuToolButton() {\r\n    const [anchorEl, setAnchorEl] = React.useState<null | HTMLElement>(null);\r\n    const {canvasStore} = useStores();\r\n    const inputRef = React.useRef<HTMLInputElement>(null);\r\n\r\n    const handleClick = (event: React.MouseEvent<HTMLElement>) => {\r\n        setAnchorEl(event.currentTarget);\r\n    };\r\n\r\n    const handleClose = () => {\r\n        setAnchorEl(null);\r\n    };\r\n\r\n    const handleFileOpen = () => {\r\n        inputRef.current?.click();\r\n        handleClose();\r\n    }\r\n\r\n    const handleFileChange = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n        const file = e.target.files?.item(0);\r\n        e.target.value = \"\";\r\n\r\n        if (!!file) {\r\n            FileUtils.read(file).then(jsonString => {\r\n                canvasStore.canvas.loadFromJSON(jsonString, () => {\r\n                    //\r\n                })\r\n            }).catch(e => console.error(e));\r\n        }\r\n    }\r\n\r\n    const handleSave = () => {\r\n        FileUtils.writeText(\"canvas.json\", JSON.stringify(canvasStore.canvas.toJSON()));\r\n        handleClose();\r\n    }\r\n\r\n    const handleImageSave = () => {\r\n        const fullQuality = canvasStore.canvas.toDataURL();\r\n        FileUtils.write(\"canvas.png\", fullQuality);\r\n        handleClose();\r\n    }\r\n\r\n    return (\r\n        <div>\r\n            <input\r\n                type={\"file\"}\r\n                onChange={handleFileChange}\r\n                ref={inputRef}\r\n                style={{display: \"none\"}}\r\n                accept=\"application/json\"\r\n            />\r\n            <ToolButton icon={<MenuIcon/>} text={\"메뉴\"} onClick={handleClick}/>\r\n            <StyledMenu\r\n                anchorEl={anchorEl}\r\n                keepMounted\r\n                open={Boolean(anchorEl)}\r\n                onClose={handleClose}\r\n            >\r\n                <StyledMenuItem onClick={handleFileOpen}>\r\n                    <ListItemIcon>\r\n                        <DescriptionIcon fontSize=\"small\"/>\r\n                    </ListItemIcon>\r\n                    <ListItemText primary=\"열기\"/>\r\n                </StyledMenuItem>\r\n                <StyledMenuItem onClick={handleSave}>\r\n                    <ListItemIcon>\r\n                        <SaveIcon fontSize=\"small\"/>\r\n                    </ListItemIcon>\r\n                    <ListItemText primary=\"저장\"/>\r\n                </StyledMenuItem>\r\n                <StyledMenuItem onClick={handleImageSave}>\r\n                    <ListItemIcon>\r\n                        <SaveAltIcon fontSize=\"small\"/>\r\n                    </ListItemIcon>\r\n                    <ListItemText primary=\"이미지로 저장\"/>\r\n                </StyledMenuItem>\r\n            </StyledMenu>\r\n        </div>\r\n    );\r\n}","import React from \"react\";\r\nimport {AppBar, Toolbar} from \"@material-ui/core\";\r\nimport makeStyles from \"@material-ui/core/styles/makeStyles\";\r\nimport {observer} from \"mobx-react\";\r\nimport {useStores} from \"../../hooks/useStores\";\r\nimport ToolButton from \"./ToolButton\";\r\nimport MouseIcon from '@material-ui/icons/Mouse';\r\nimport DashboardIcon from '@material-ui/icons/Dashboard';\r\nimport BrushIcon from \"@material-ui/icons/Brush\";\r\nimport {ToolTypes} from \"../../models/canvas/ToolTypes\";\r\nimport MenuToolButton from \"./MenuToolButton\";\r\n\r\nconst useStyles = makeStyles(() => ({\r\n    appBarColor: {\r\n        backgroundColor: \"rgba(30,30,30,0.95)\",\r\n    },\r\n    left: {\r\n        justifyContent: \"flex-start\",\r\n    },\r\n    center: {\r\n        display: \"flex\",\r\n        flex: 1,\r\n        justifyContent: \"center\",\r\n    },\r\n    right: {\r\n        justifyContent: \"flex-end\",\r\n    }\r\n}));\r\n\r\nconst ToolBox = observer(() => {\r\n    const classes = useStyles();\r\n    const {canvasStore} = useStores();\r\n\r\n    return (\r\n        <AppBar\r\n            classes={{\r\n                colorDefault: classes.appBarColor,\r\n            }}\r\n            color={\"default\"}\r\n            elevation={0}\r\n        >\r\n            <Toolbar variant={\"dense\"}>\r\n                <div className={classes.left}>\r\n                    <MenuToolButton/>\r\n                </div>\r\n                <div className={classes.center}>\r\n                    <ToolButton\r\n                        icon={<MouseIcon/>}\r\n                        text={\"선택\"}\r\n                        onClick={() => canvasStore.selectedTool = ToolTypes.SELECT}\r\n                        selected={canvasStore.selectedTool === ToolTypes.SELECT}\r\n                    />\r\n                    <ToolButton\r\n                        icon={<BrushIcon/>}\r\n                        text={\"브러시\"}\r\n                        onClick={() => canvasStore.selectedTool = ToolTypes.BRUSH}\r\n                        selected={canvasStore.selectedTool === ToolTypes.BRUSH}\r\n                    />\r\n                    <ToolButton\r\n                        icon={<DashboardIcon/>}\r\n                        text={\"셰이프\"}\r\n                        onClick={() => canvasStore.selectedTool = ToolTypes.SHAPE}\r\n                        selected={canvasStore.selectedTool === ToolTypes.SHAPE}\r\n                    />\r\n                </div>\r\n                <div className={classes.right}>\r\n                </div>\r\n            </Toolbar>\r\n        </AppBar>\r\n    )\r\n})\r\n\r\nexport default ToolBox;","import {Box, Select, Typography} from \"@material-ui/core\";\r\nimport {BrushType} from \"../../models/canvas/Brush\";\r\nimport React from \"react\";\r\nimport makeStyles from \"@material-ui/core/styles/makeStyles\";\r\nimport {observer} from \"mobx-react\";\r\nimport {useStores} from \"../../hooks/useStores\";\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n    title: {\r\n        marginBottom: theme.spacing(3),\r\n    },\r\n    input: {\r\n        padding: theme.spacing(1),\r\n        borderRadius: 4,\r\n        backgroundColor: \"#fff\",\r\n    }\r\n}))\r\n\r\nconst BrushPropBox = observer(() => {\r\n    const classes = useStyles();\r\n    const {canvasStore} = useStores();\r\n\r\n    const handleBrushChange = (e: any) => {\r\n        canvasStore.brushType = BrushType.valueOf(e.target.value) || BrushType.PENCIL;\r\n    }\r\n\r\n    return (\r\n        <div>\r\n            <div className={classes.title}>\r\n                <Typography variant={\"h6\"} color={\"primary\"}>브러시</Typography>\r\n            </div>\r\n            <div>\r\n                <Box mb={1}>\r\n                    <Typography variant={\"caption\"}>모양</Typography>\r\n                </Box>\r\n                <Select\r\n                    className={classes.input}\r\n                    native\r\n                    onChange={handleBrushChange}\r\n                    value={canvasStore.brushType.value}\r\n                    label=\"브러시 모양\"\r\n                    fullWidth\r\n                >\r\n                    {BrushType.values().map(brush => (\r\n                        <option key={brush.value} value={brush.value}>{brush.display}</option>\r\n                    ))}\r\n                </Select>\r\n            </div>\r\n        </div>\r\n    )\r\n})\r\n\r\nexport default BrushPropBox;","import {Box, Select, Typography} from \"@material-ui/core\";\r\nimport React from \"react\";\r\nimport makeStyles from \"@material-ui/core/styles/makeStyles\";\r\nimport {observer} from \"mobx-react\";\r\nimport {ShapeType} from \"../../models/canvas/Shape\";\r\nimport {useStores} from \"../../hooks/useStores\";\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n    title: {\r\n        marginBottom: theme.spacing(3),\r\n    },\r\n    input: {\r\n        padding: theme.spacing(1),\r\n        borderRadius: 4,\r\n        backgroundColor: \"#fff\",\r\n    }\r\n}))\r\n\r\nconst ShapePropBox = observer(() => {\r\n    const classes = useStyles();\r\n    const {canvasStore} = useStores();\r\n\r\n    const handleShapeChange = (e: any) => {\r\n        canvasStore.shapeType = ShapeType.valueOf(e.target.value) || ShapeType.CIRCLE;\r\n    }\r\n\r\n    return (\r\n        <div>\r\n            <div className={classes.title}>\r\n                <Typography variant={\"h6\"} color={\"primary\"}>셰이프</Typography>\r\n            </div>\r\n            <div>\r\n                <Box mb={1}>\r\n                    <Typography variant={\"caption\"}>모양</Typography>\r\n                </Box>\r\n                <Select\r\n                    className={classes.input}\r\n                    native\r\n                    onChange={handleShapeChange}\r\n                    value={canvasStore.shapeType.value}\r\n                    label=\"셰이프 모양\"\r\n                    fullWidth\r\n                >\r\n                    {ShapeType.values().map(shape => (\r\n                        <option key={shape.value} value={shape.value}>{shape.display}</option>\r\n                    ))}\r\n                </Select>\r\n            </div>\r\n        </div>\r\n    )\r\n})\r\n\r\nexport default ShapePropBox;","import React from \"react\";\r\nimport {observer} from \"mobx-react\";\r\nimport makeStyles from \"@material-ui/core/styles/makeStyles\";\r\nimport {useStores} from \"../../hooks/useStores\";\r\nimport {ToolTypes} from \"../../models/canvas/ToolTypes\";\r\nimport BrushPropBox from \"./BrushPropBox\";\r\nimport ShapePropBox from \"./ShapePropBox\";\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n    root: {\r\n        padding: theme.spacing(3),\r\n    }\r\n}));\r\n\r\nconst PropBox = observer(() => {\r\n    const classes = useStyles();\r\n    const {canvasStore} = useStores();\r\n    const selectedTool = canvasStore.selectedTool;\r\n\r\n    return (\r\n        <div className={classes.root}>\r\n            {selectedTool === ToolTypes.BRUSH && <BrushPropBox/>}\r\n            {selectedTool === ToolTypes.SHAPE && (<ShapePropBox/>)}\r\n        </div>\r\n    )\r\n})\r\n\r\nexport default PropBox;","import React from \"react\";\r\nimport {Layout} from \"../layout\";\r\nimport makeStyles from \"@material-ui/core/styles/makeStyles\";\r\nimport {PropBox, ToolBox} from \"../../components/tools\";\r\nimport {observer} from \"mobx-react\";\r\nimport {Toolbar} from \"@material-ui/core\";\r\nimport {useStores} from \"../../hooks/useStores\";\r\n\r\nconst leftMenuWidth = 240;\r\nconst useStyles = makeStyles((theme) => ({\r\n    root: {\r\n        display: \"flex\",\r\n        flexDirection: \"column\",\r\n        width: \"100vw\",\r\n        height: \"100vh\",\r\n    },\r\n    flexBox: {\r\n        display: \"flex\",\r\n        flex: 1,\r\n    },\r\n    contents: {\r\n        display: \"flex\",\r\n    },\r\n    left: {\r\n        flexBasis: `${leftMenuWidth}px`,\r\n        backgroundColor: \"#f0f0f0\",\r\n    },\r\n    canvasWrapper: {\r\n        display: \"flex\",\r\n        justifyContent: \"center\",\r\n        alignItems: \"center\",\r\n        flex: 1,\r\n        backgroundColor: \"#c0c0c0\",\r\n        padding: theme.spacing(3),\r\n    },\r\n}))\r\n\r\nconst Canvas = observer(() => {\r\n    const classes = useStyles();\r\n    const {canvasStore} = useStores();\r\n\r\n    React.useEffect(() => {\r\n        const el = document.getElementById(canvasStore.canvasId) as HTMLCanvasElement;\r\n        canvasStore.initCanvas(el, {\r\n            width: canvasStore.width,\r\n            height: canvasStore.height,\r\n            backgroundColor: canvasStore.backgroundColor,\r\n        });\r\n        // eslint-disable-next-line\r\n    }, []);\r\n\r\n    return (\r\n        <Layout>\r\n            <ToolBox/>\r\n            <div className={classes.root}>\r\n                <Toolbar variant={\"dense\"}/>\r\n                <div className={classes.flexBox}>\r\n                    <div className={classes.left}>\r\n                        <PropBox/>\r\n                    </div>\r\n                    <div className={classes.canvasWrapper}>\r\n                        <canvas id={canvasStore.canvasId}/>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </Layout>\r\n    )\r\n})\r\n\r\nexport default Canvas;","import {Canvas} from 'templates/canvas';\r\nimport React from 'react';\r\n\r\nfunction App() {\r\n    return (\r\n        <Canvas/>\r\n    );\r\n}\r\n\r\nexport default App;\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport App from './App';\r\nimport {StoreContextProvider} from \"./contexts/StoreContext\";\r\n\r\nReactDOM.render(\r\n    <React.StrictMode>\r\n        <StoreContextProvider>\r\n            <App/>\r\n        </StoreContextProvider>\r\n    </React.StrictMode>,\r\n    document.getElementById('root')\r\n);"],"sourceRoot":""}