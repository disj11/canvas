(this.webpackJsonpcanvas=this.webpackJsonpcanvas||[]).push([[0],{238:function(e,t){},239:function(e,t){},240:function(e,t){},350:function(e,t,i){"use strict";i.r(t);var s=i(2),n=i(0),r=i.n(n),o=i(15),a=i.n(o),c=i(381),l=i(382),u=i(16),h=i.n(u),d=h()((function(){return{progressWrapper:{display:"flex",justifyContent:"center",alignItems:"center"}}})),v=function(e){var t=e.loading,i=e.children,n=d();return Object(s.jsxs)(r.a.Fragment,{children:[Object(s.jsx)(c.a,{}),Object(s.jsx)("div",{children:t?Object(s.jsx)("div",{className:n.progressWrapper,children:Object(s.jsx)(l.a,{})}):i})]})},b=i(104),j=i(6),f="#ac76ff",O="linear-gradient(90deg, rgba(172,118,255,1) 0%, rgba(91,91,255,1) 100%)",p="linear-gradient(90deg, rgba(172,118,255,.4) 0%, rgba(91,91,255,.4) 100%)",x=h()((function(e){return{button:{display:"inline-block",cursor:"pointer",color:"#fff",paddingTop:e.spacing(.5),paddingBottom:e.spacing(.5),paddingRight:e.spacing(3),paddingLeft:e.spacing(3),textAlign:"center"},caption:{fontSize:"0.70rem"},selected:{background:O}}})),S=function(e){var t=e.icon,i=e.text,n=e.onClick,r=e.selected,o=x();return Object(s.jsxs)("div",{className:Object(j.a)(o.button,Object(b.a)({},o.selected,r)),onClick:n,children:[t,Object(s.jsx)("div",{className:o.caption,children:i})]})},y=i(385),E=i(386),m=i(27),g=r.a.createContext({}),k=g.Provider,C=function(){return r.a.useContext(g)},T=i(180),M=i.n(T),L=i(182),N=i.n(L),P=i(181),w=i.n(P),I=i(13),B=i(14),A=function(){function e(t,i){Object(I.a)(this,e),this.value=t,this.display=i,e._values.push(this)}return Object(B.a)(e,null,[{key:"values",value:function(){return this._values}},{key:"valueOf",value:function(e){return this.values().find((function(t){return t.value===e}))}}]),e}();A._values=[],A.SELECT=new A("select","\uc120\ud0dd"),A.BRUSH=new A("brush","\ube0c\ub7ec\uc26c"),A.SHAPE=new A("shape","\uc170\uc774\ud504"),A.TEXT=new A("text","\ud14d\uc2a4\ud2b8"),A.CANVAS=new A("canvas","\uce94\ubc84\uc2a4");var R,_=i(65),F=i(38),D=i(8),W=i(193),U=i(394),G=i(383),z=i(384),J=i(176),H=i.n(J),Z=i(177),V=i.n(Z),X=i(178),Y=i.n(X),K=i(179),q=i.n(K),Q=i(135),$=i.n(Q),ee=i(175);!function(e){e.TEXT="text/plain"}(R||(R={}));var te=function(){function e(){Object(I.a)(this,e)}return Object(B.a)(e,null,[{key:"writeText",value:function(e,t){var i=new Blob([t],{type:R.TEXT}),s=window.URL.createObjectURL(i);this.write(e,s)}},{key:"write",value:function(e,t){var i=document.createElement("a");i.download=e,i.href=t,i.click()}},{key:"read",value:function(){var e=Object(ee.a)($.a.mark((function e(t){return $.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,i){var s=new FileReader;s.onload=function(){return e(s.result)},s.onerror=function(){return i()},s.readAsText(t)})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),ie=Object(D.a)({paper:{border:"1px solid #d3d4d5"}})((function(e){return Object(s.jsx)(W.a,Object(F.a)({elevation:0,getContentAnchorEl:null,anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"}},e))})),se=Object(D.a)((function(e){return{root:{"&:focus":{backgroundColor:e.palette.primary.main,"& .MuiListItemIcon-root, & .MuiListItemText-primary":{color:e.palette.common.white}}}}}))(U.a);function ne(){var e=r.a.useState(null),t=Object(_.a)(e,2),i=t[0],n=t[1],o=C().canvasStore,a=r.a.useRef(null),c=function(){n(null)};return Object(s.jsxs)("div",{children:[Object(s.jsx)("input",{type:"file",onChange:function(e){var t,i=null===(t=e.target.files)||void 0===t?void 0:t.item(0);e.target.value="",i&&te.read(i).then((function(e){o.canvas.loadFromJSON(e,(function(){}))})).catch((function(e){return console.error(e)}))},ref:a,style:{display:"none"},accept:"application/json"}),Object(s.jsx)(S,{icon:Object(s.jsx)(H.a,{}),text:"\uba54\ub274",onClick:function(e){n(e.currentTarget)}}),Object(s.jsxs)(ie,{anchorEl:i,keepMounted:!0,open:Boolean(i),onClose:c,children:[Object(s.jsxs)(se,{onClick:function(){var e;null===(e=a.current)||void 0===e||e.click(),c()},children:[Object(s.jsx)(G.a,{children:Object(s.jsx)(V.a,{fontSize:"small"})}),Object(s.jsx)(z.a,{primary:"\uc5f4\uae30"})]}),Object(s.jsxs)(se,{onClick:function(){te.writeText("canvas.json",JSON.stringify(o.canvas.toJSON())),c()},children:[Object(s.jsx)(G.a,{children:Object(s.jsx)(Y.a,{fontSize:"small"})}),Object(s.jsx)(z.a,{primary:"\uc800\uc7a5"})]}),Object(s.jsxs)(se,{onClick:function(){var e=o.canvas.toDataURL();te.write("canvas.png",e),c()},children:[Object(s.jsx)(G.a,{children:Object(s.jsx)(q.a,{fontSize:"small"})}),Object(s.jsx)(z.a,{primary:"\uc774\ubbf8\uc9c0\ub85c \uc800\uc7a5"})]})]})]})}var re=i(183),oe=i.n(re),ae=i(184),ce=i.n(ae),le=h()((function(){return{appBarColor:{backgroundColor:"rgba(30,30,30,0.95)"},left:{justifyContent:"flex-start"},center:{display:"flex",flex:1,justifyContent:"center"},right:{justifyContent:"flex-end"}}})),ue=Object(m.a)((function(){var e=le(),t=C().canvasStore;return Object(s.jsx)(y.a,{classes:{colorDefault:e.appBarColor},color:"default",elevation:0,children:Object(s.jsxs)(E.a,{variant:"dense",children:[Object(s.jsx)("div",{className:e.left,children:Object(s.jsx)(ne,{})}),Object(s.jsxs)("div",{className:e.center,children:[Object(s.jsx)(S,{icon:Object(s.jsx)(M.a,{}),text:A.SELECT.display,onClick:function(){return t.setCanvasMode(A.SELECT)},selected:t.canvasMode===A.SELECT}),Object(s.jsx)(S,{icon:Object(s.jsx)(w.a,{}),text:A.BRUSH.display,onClick:function(){return t.setCanvasMode(A.BRUSH)},selected:t.canvasMode===A.BRUSH}),Object(s.jsx)(S,{icon:Object(s.jsx)(N.a,{}),text:A.SHAPE.display,onClick:function(){return t.setCanvasMode(A.SHAPE)},selected:t.canvasMode===A.SHAPE}),Object(s.jsx)(S,{icon:Object(s.jsx)(oe.a,{}),text:A.TEXT.display,onClick:function(){return t.setCanvasMode(A.TEXT)},selected:t.canvasMode===A.TEXT}),Object(s.jsx)(S,{icon:Object(s.jsx)(ce.a,{}),text:A.CANVAS.display,onClick:function(){return t.canvasMode=A.CANVAS},selected:t.canvasMode===A.CANVAS})]}),Object(s.jsx)("div",{className:e.right})]})})})),he=i(396),de=i(77),ve=i(391),be=i(26),je=function(){function e(t,i){Object(I.a)(this,e),this.value=t,this.display=i,e._values.push(this)}return Object(B.a)(e,[{key:"getBrush",value:function(t){switch(this){case e.PENCIL:return new be.fabric.PencilBrush(t);case e.CIRCLE:return new be.fabric.CircleBrush(t);case e.SPRAY:return new be.fabric.SprayBrush(t);default:return new be.fabric.PencilBrush(t)}}}],[{key:"values",value:function(){return this._values}},{key:"valueOf",value:function(e){return this.values().find((function(t){return t.value===e}))}}]),e}();je._values=[],je.PENCIL=new je("pencil","\uc5f0\ud544"),je.CIRCLE=new je("circle","\uc6d0\ud615"),je.SPRAY=new je("spray","\uc2a4\ud504\ub808\uc774");var fe=i(108),Oe=i(109),pe=i(395),xe=i(387),Se=i(388),ye=h()((function(e){return{label:{display:"flex",justifyContent:"space-between"}}})),Ee=function(e){var t=e.label,i=e.value,n=e.onChange,r=e.prefix,o=e.min,a=e.max,c=ye();return Object(s.jsxs)("div",{children:[Object(s.jsxs)("div",{className:c.label,children:[Object(s.jsx)(de.a,{variant:"caption",children:t}),Object(s.jsx)(xe.a,{value:i,margin:"dense",inputProps:{min:1,max:100,type:"number"},endAdornment:Object(s.jsx)(Se.a,{position:"end",children:r})})]}),Object(s.jsx)("div",{children:Object(s.jsx)(pe.a,{min:o,max:a,value:i,onChange:function(e,t){"number"===typeof t&&n(t)}})})]})},me=i(107),ge=i(392),ke=h()((function(e){return{colorBox:{width:"100%",height:35,border:1,borderStyle:"solid",borderColor:"#c0c0c0",backgroundColor:function(e){return e.color},cursor:function(e){return e.disabled?"default":"pointer"}}}})),Ce=function(e){var t=ke(e),i=r.a.useState(null),n=Object(_.a)(i,2),o=n[0],a=n[1],c=!!o;return Object(s.jsxs)("div",{children:[e.label&&Object(s.jsx)(de.a,{variant:"caption",children:e.label}),Object(s.jsxs)("div",{children:[Object(s.jsx)("div",{className:t.colorBox,onClick:function(e){a(e.currentTarget)}}),Object(s.jsx)(ge.a,{open:c&&!e.disabled,anchorEl:o,onClose:function(){a(null)},children:Object(s.jsx)(me.a,{color:e.color,disableAlpha:e.disableAlpha,onChangeComplete:e.onChange})})]})]})},Te=function(e){return Object(s.jsxs)("div",{children:[Object(s.jsx)(he.a,{mb:2,children:Object(s.jsx)(Ce,Object(F.a)({},e))}),Object(s.jsx)(me.b,{width:"100%",color:e.color,onChangeComplete:e.onChange})]})},Me=i(393),Le=i(389),Ne=function(e){var t=r.a.useRef();return r.a.useEffect((function(){t.current=e})),t.current},Pe=function(e){var t=e.color,i=e.onChange,n=Ne(t),o=r.a.useState(t?"solid":"none"),a=Object(_.a)(o,2),c=a[0],l=a[1];return Object(s.jsxs)(he.a,{display:"flex",children:[Object(s.jsx)(he.a,{mr:1.5,flexBasis:35,children:Object(s.jsx)(Ce,{color:t,onChange:function(e){var t=e.rgb.a||0===e.rgb.a?"rgba(".concat(e.rgb.r,", ").concat(e.rgb.g,", ").concat(e.rgb.b,", ").concat(e.rgb.a,")"):e.hex;i(t)},disabled:"none"===c})}),Object(s.jsx)(he.a,{flex:1,children:Object(s.jsx)(Le.a,{fullWidth:!0,children:Object(s.jsxs)(Me.a,{value:c,onChange:function(e){var t=e.target.value;l(t),i("none"===t?void 0:n||f)},children:[Object(s.jsx)(U.a,{value:"none",children:Object(s.jsx)("em",{children:"\uc5c6\uc74c"})}),Object(s.jsx)(U.a,{value:"solid",children:"\ub2e8\uc0c9"})]})})})]})},we=i(189),Ie=i.n(we),Be=i(190),Ae=i.n(Be),Re=i(191),_e=i.n(Re),Fe=i(390),De=h()((function(e){return{alignBox:{display:"flex"},alignButton:{flex:1}}})),We=function(e){var t=e.onLeft,i=e.onCenter,n=e.onRight,r=De();return Object(s.jsxs)("div",{className:r.alignBox,children:[Object(s.jsx)(Fe.a,{className:r.alignButton,onClick:t,children:Object(s.jsx)(Ie.a,{})}),Object(s.jsx)(Fe.a,{className:r.alignButton,onClick:i,children:Object(s.jsx)(Ae.a,{})}),Object(s.jsx)(Fe.a,{className:r.alignButton,onClick:n,children:Object(s.jsx)(_e.a,{})})]})},Ue=h()((function(e){return{root:{display:"flex",flexDirection:"column",height:"100%"},title:{marginBottom:e.spacing(3)},propBoxWrapper:{flex:1,display:"flex",flexDirection:"column"}}})),Ge=Object(m.a)((function(e){var t=e.children,i=Ue(),n=C(),r=n.canvasStore,o=n.objectManagerStore;return Object(s.jsxs)("div",{className:i.root,children:[Object(s.jsx)("div",{className:i.title,children:Object(s.jsx)(de.a,{variant:"h6",color:"primary",children:o.activeObject?o.getObjectTypeName():r.canvasMode.display})}),Object(s.jsx)("div",{className:i.propBoxWrapper,children:t})]})})),ze=h()((function(e){return{button:{borderRadius:"4px",cursor:"pointer",padding:e.spacing(1),marginRight:e.spacing(.5),"&:hover":{background:p,"& *":{color:"white"}}},selected:{background:O,"& *":{color:"white"}},propBox:{flex:1,"& > div":{marginBottom:e.spacing(3)}}}})),Je=Object(m.a)((function(){var e=ze(),t=C().brushStore;return Object(s.jsxs)(Ge,{children:[Object(s.jsxs)("div",{className:e.propBox,children:[!t.item&&Object(s.jsxs)("div",{children:[Object(s.jsx)(he.a,{mb:1,children:Object(s.jsx)(de.a,{variant:"caption",children:"\ubaa8\uc591"})}),Object(s.jsxs)(he.a,{display:"flex",children:[Object(s.jsx)("div",{className:Object(j.a)(e.button,t.brushType===je.PENCIL&&e.selected),onClick:function(){return t.setBrushType(je.PENCIL)},children:Object(s.jsx)(fe.a,{icon:Oe.b,size:"lg"})}),Object(s.jsx)("div",{className:Object(j.a)(e.button,t.brushType===je.SPRAY&&e.selected),onClick:function(){return t.setBrushType(je.SPRAY)},children:Object(s.jsx)(fe.a,{icon:Oe.c,size:"lg"})}),Object(s.jsx)("div",{className:Object(j.a)(e.button,t.brushType===je.CIRCLE&&e.selected),onClick:function(){return t.setBrushType(je.CIRCLE)},children:Object(s.jsx)(fe.a,{icon:Oe.a,size:"lg"})})]})]}),Object(s.jsx)("div",{children:Object(s.jsx)(Ee,{label:"\ub450\uaed8",value:t.strokeWidth,onChange:function(e){return t.setStrokeWidth(e)},prefix:"px",min:1})})]}),Object(s.jsxs)("div",{children:[Object(s.jsx)(he.a,{paddingTop:3,paddingBottom:3,children:Object(s.jsx)(ve.a,{})}),Object(s.jsx)(Te,{color:t.stroke,onChange:function(e){return t.setStroke(e.hex)},disableAlpha:!0})]})]})})),He=function(){function e(t,i){Object(I.a)(this,e),this.value=t,this.display=i,e._values.push(this)}return Object(B.a)(e,[{key:"getShape",value:function(t){switch(this){case e.RECT:return new be.fabric.Rect(t);case e.ELLIPSE:return new be.fabric.Ellipse(t);case e.TRIANGLE:return new be.fabric.Triangle(t);default:return new be.fabric.Rect(t)}}}],[{key:"values",value:function(){return this._values}},{key:"valueOf",value:function(e){return this.values().find((function(t){return t.value===e}))}}]),e}();He._values=[],He.RECT=new He("rect","\uc0ac\uac01\ud615"),He.ELLIPSE=new He("ellipse","\uc6d0"),He.TRIANGLE=new He("triangle","\uc0bc\uac01\ud615");var Ze,Ve=h()((function(e){return{button:{borderRadius:"4px",cursor:"pointer",padding:e.spacing(1),marginRight:e.spacing(.5),height:40,"&:hover":{background:p,"& svg > *":{stroke:"white"}}},selected:{background:O,"& svg > *":{stroke:"white"}},propBox:{"& > div":{marginBottom:e.spacing(3)}}}})),Xe=Object(m.a)((function(){var e=Ve(),t=C().shapeStore;return Object(s.jsx)(Ge,{children:Object(s.jsxs)("div",{className:e.propBox,children:[!t.item&&Object(s.jsxs)("div",{children:[Object(s.jsx)(he.a,{mb:1,children:Object(s.jsx)(de.a,{variant:"caption",children:"\ubaa8\uc591"})}),Object(s.jsxs)(he.a,{display:"flex",children:[Object(s.jsx)("div",{className:Object(j.a)(e.button,t.shapeType===He.ELLIPSE&&e.selected),onClick:function(){return t.setShapeType(He.ELLIPSE)},children:Object(s.jsx)("svg",{height:"24",width:"24",children:Object(s.jsx)("circle",{cx:"12",cy:"12",r:"10",stroke:"black",fill:"transparent",strokeWidth:2})})}),Object(s.jsx)("div",{className:Object(j.a)(e.button,t.shapeType===He.RECT&&e.selected),onClick:function(){return t.setShapeType(He.RECT)},children:Object(s.jsx)("svg",{width:"24",height:"24",children:Object(s.jsx)("rect",{width:"24",height:"24",stroke:"black",fill:"transparent",strokeWidth:4})})}),Object(s.jsx)("div",{className:Object(j.a)(e.button,t.shapeType===He.TRIANGLE&&e.selected),onClick:function(){return t.setShapeType(He.TRIANGLE)},children:Object(s.jsx)("svg",{width:"24",height:"24",children:Object(s.jsx)("polygon",{points:"12,2 22,22 2,22",stroke:"black",fill:"transparent",strokeWidth:2})})})]})]}),Object(s.jsx)("div",{children:Object(s.jsxs)(he.a,{mb:1,children:[Object(s.jsx)(de.a,{variant:"caption",children:"\ucc44\uc6b0\uae30"}),Object(s.jsx)("div",{children:Object(s.jsx)(Pe,{color:t.fill,onChange:function(e){return t.setFill(e)}})})]})}),Object(s.jsx)("div",{children:Object(s.jsxs)(he.a,{mb:1,children:[Object(s.jsx)(de.a,{variant:"caption",children:"\uc120 \uc0c9\uc0c1"}),Object(s.jsx)("div",{children:Object(s.jsx)(Pe,{color:t.stroke,onChange:function(e){return t.setStroke(e)}})})]})}),Object(s.jsx)("div",{children:Object(s.jsx)(Ee,{label:"\uc120 \ub450\uaed8",value:t.strokeWidth,onChange:function(e){return t.setStrokeWidth(e)},prefix:"px"})})]})})})),Ye=[8,9,10,11,12,14,16,18,20,22,24,26,28,36,48,72,94,130];!function(e){e[e.DEFAULT=0]="DEFAULT",e[e.GOOGLE=1]="GOOGLE"}(Ze||(Ze={}));var Ke=function(){function e(t,i,s){Object(I.a)(this,e),this.value=t,this.display=i,this.type=s,e._values.push(this)}return Object(B.a)(e,null,[{key:"values",value:function(){return this._values}},{key:"valueOf",value:function(e){return this.values().find((function(t){return t.value===e}))}},{key:"getGoogleFonts",value:function(){return this.values().filter((function(e){return e.type===Ze.GOOGLE}))}}]),e}();Ke._values=[],Ke.TIMES_NEW_ROMAN=new Ke("Times New Roman","Times New Roman",Ze.DEFAULT),Ke.NOTO_SANS_KR=new Ke("Noto Sans KR","Noto Sans KR",Ze.GOOGLE),Ke.EAST_SEA_DOKDO=new Ke("East Sea Dokdo","East Sea Dokdo",Ze.GOOGLE);var qe=h()((function(e){return{propBox:{"& > *":{marginBottom:e.spacing(3)}}}})),Qe=Object(m.a)((function(){var e=qe(),t=C().textStore;return Object(s.jsx)(Ge,{children:Object(s.jsxs)("div",{className:e.propBox,children:[Object(s.jsx)("div",{children:Object(s.jsx)(Le.a,{fullWidth:!0,children:Object(s.jsx)(Me.a,{value:t.fontFamily,onChange:function(e){var i=e.target.value;t.setFontFamily(i)},children:Ke.values().map((function(e){return Object(s.jsx)(U.a,{value:e.value,children:e.display},e.value)}))})})}),Object(s.jsx)("div",{children:Object(s.jsxs)(he.a,{display:"flex",children:[Object(s.jsx)(he.a,{flex:1,mr:1.5,children:Object(s.jsx)(Le.a,{fullWidth:!0,children:Object(s.jsx)(Me.a,{value:t.fontSize,onChange:function(e){var i=parseInt(e.target.value,10);t.setFontSize(i)},children:Ye.map((function(e){return Object(s.jsx)(U.a,{value:e,children:e},e)}))})})}),Object(s.jsx)(he.a,{flexBasis:35,children:Object(s.jsx)(Ce,{color:t.fill,onChange:function(e){return t.setFill(e.hex)}})})]})}),Object(s.jsx)("div",{children:Object(s.jsx)(We,{})})]})})})),$e=h()((function(e){return{root:{padding:e.spacing(3),height:"100%"}}})),et=Object(m.a)((function(){var e=$e(),t=C(),i=t.canvasStore,n=t.objectManagerStore,o=i.canvasMode,a=n.activeObject;return Object(s.jsx)(r.a.Fragment,{children:Object(s.jsxs)("div",{className:e.root,children:[!a&&Object(s.jsxs)(r.a.Fragment,{children:[o===A.BRUSH&&Object(s.jsx)(Je,{}),o===A.SHAPE&&Object(s.jsx)(Xe,{}),o===A.TEXT&&Object(s.jsx)(Qe,{})]}),a&&Object(s.jsxs)(r.a.Fragment,{children:[n.isPath()&&Object(s.jsx)(Je,{}),n.isShape()&&Object(s.jsx)(Xe,{}),n.isText()&&Object(s.jsx)(Qe,{})]})]})})})),tt=h()((function(e){return{root:{display:"flex",flexDirection:"column",width:"100vw",height:"100vh"},flexBox:{display:"flex",flex:1},contents:{display:"flex"},left:{flexBasis:"".concat(260,"px"),backgroundColor:"#f0f0f0"},canvasWrapper:{display:"flex",justifyContent:"center",alignItems:"center",flex:1,backgroundColor:"#c0c0c0",padding:e.spacing(3)}}})),it=Object(m.a)((function(){var e=tt(),t=C(),i=r.a.useRef(null);return r.a.useEffect((function(){i.current&&t.init(i.current)}),[i]),Object(s.jsxs)(v,{children:[Object(s.jsx)(ue,{}),Object(s.jsxs)("div",{className:e.root,children:[Object(s.jsx)(E.a,{variant:"dense"}),Object(s.jsxs)("div",{className:e.flexBox,children:[Object(s.jsx)("div",{className:e.left,children:Object(s.jsx)(et,{})}),Object(s.jsx)("div",{className:e.canvasWrapper,ref:i})]})]})]})}));var st,nt=function(){return Object(s.jsx)(it,{})},rt=i(10),ot={brushType:je.PENCIL,stroke:"#000000",strokeWidth:1},at=function(){function e(t){Object(I.a)(this,e),this.rootStore=t,this.brushType=ot.brushType,this.stroke=ot.stroke,this.strokeWidth=ot.strokeWidth,this.item=void 0,this.canvas=void 0,this.objectManager=void 0,Object(rt.k)(this),this.canvas=t.canvasStore.canvas,this.objectManager=t.objectManagerStore,this.addReactions()}return Object(B.a)(e,[{key:"setBrushType",value:function(e){this.brushType=e,this.setFreeDrawingBrush()}},{key:"setStroke",value:function(e){var t;this.stroke=e||ot.stroke,null===(t=this.item)||void 0===t||t.set("stroke",e),this.canvas.freeDrawingBrush.color=this.stroke,this.canvas.renderAll()}},{key:"setStrokeWidth",value:function(e){var t;this.strokeWidth=e||ot.strokeWidth,null===(t=this.item)||void 0===t||t.set("strokeWidth",e),this.canvas.freeDrawingBrush.width=this.strokeWidth,this.canvas.renderAll()}},{key:"setFreeDrawingBrush",value:function(){this.canvas.freeDrawingBrush=this.rootStore.brushStore.brushType.getBrush(this.canvas),this.canvas.freeDrawingBrush.color=this.stroke,this.canvas.freeDrawingBrush.width=this.strokeWidth}},{key:"addReactions",value:function(){this.objectManager.subscribe(this.updateObject.bind(this))}},{key:"updateObject",value:function(e){this.isBrush(e)?(this.item=e,this.updatePathStyles()):this.item=void 0}},{key:"setPathStyles",value:function(e){this.setStroke(e.stroke),this.setStrokeWidth(e.strokeWidth)}},{key:"updatePathStyles",value:function(){if(this.item){var e=this.item,t=e.stroke,i=e.strokeWidth;this.setPathStyles({stroke:t,strokeWidth:i})}}},{key:"isBrush",value:function(e){return null===e||void 0===e?void 0:e.isType("path")}}]),e}(),ct=500,lt=500,ut="#ffffff",ht=function(){function e(t,i){Object(I.a)(this,e),this.rootStore=t,this.canvas=i,this.width=ct,this.height=lt,this.backgroundColor=ut,this.canvasMode=A.BRUSH,Object(rt.k)(this),this.canvas.setWidth(this.width),this.canvas.setHeight(this.height),this.canvas.setBackgroundColor(this.backgroundColor,(function(){}))}return Object(B.a)(e,[{key:"init",value:function(){this.setCanvasMode(this.canvasMode)}},{key:"setCanvasMode",value:function(e){if(this.canvasMode=e,this.canvas.discardActiveObject().renderAll(),this.canvas.isDrawingMode=e===A.BRUSH,this.canvas.defaultCursor="default",this.setSelectable(!1),e===A.BRUSH){var t=this.rootStore.brushStore;t.setBrushType(t.brushType)}else e===A.SELECT?this.setSelectable(!0):e===A.SHAPE?this.canvas.defaultCursor="crosshair":e===A.TEXT&&(this.canvas.defaultCursor="text")}},{key:"setSelectable",value:function(e){this.canvas.selection=e,this.canvas.getObjects().forEach((function(t){t.selectable=e,t.hoverCursor=e?"move":"default"}))}}]),e}();!function(e){e.MOUSE_UP="mouse:up",e.MOUSE_DOWN="mouse:down",e.MOUSE_MOVE="mouse:move"}(st||(st={}));var dt,vt=function(){function e(t){Object(I.a)(this,e),this.rootStore=t,this.startCursorPosition={x:0,y:0},this.currentCursorPosition={x:0,y:0},this.observer=new Map,this.addEventListeners()}return Object(B.a)(e,[{key:"subscribe",value:function(e,t){var i;this.observer.has(e)||this.observer.set(e,[]),null===(i=this.observer.get(e))||void 0===i||i.push(t)}},{key:"unsubscribe",value:function(e,t){var i;this.observer.set(e,(null===(i=this.observer.get(e))||void 0===i?void 0:i.filter((function(e){return e!==t})))||[])}},{key:"onMouseDown",value:function(e){var t,i=this;this.startCursorPosition=Object(F.a)({},this.getCursorPosition(e)),this.currentCursorPosition=Object(F.a)({},this.getCursorPosition(e)),null===(t=this.observer.get(st.MOUSE_DOWN))||void 0===t||t.forEach((function(e){return e({startCursorPosition:i.startCursorPosition,currentCursorPosition:i.currentCursorPosition})}))}},{key:"onMouseMove",value:function(e){var t,i=this;this.currentCursorPosition=Object(F.a)({},this.getCursorPosition(e)),null===(t=this.observer.get(st.MOUSE_MOVE))||void 0===t||t.forEach((function(e){return e({startCursorPosition:i.startCursorPosition,currentCursorPosition:i.currentCursorPosition})}))}},{key:"onMouseUp",value:function(e){var t,i=this;this.currentCursorPosition=Object(F.a)({},this.getCursorPosition(e)),null===(t=this.observer.get(st.MOUSE_UP))||void 0===t||t.forEach((function(e){return e({startCursorPosition:i.startCursorPosition,currentCursorPosition:i.currentCursorPosition})}))}},{key:"addEventListeners",value:function(){var e=this.rootStore.canvasStore.canvas;e.on(st.MOUSE_DOWN,this.onMouseDown.bind(this)),e.on(st.MOUSE_MOVE,this.onMouseMove.bind(this)),e.on(st.MOUSE_UP,this.onMouseUp.bind(this))}},{key:"getCursorPosition",value:function(e){return this.rootStore.canvasStore.canvas.getPointer(e.e)}}]),e}();!function(e){e.SELECTION_CLEARED="selection:cleared",e.SELECTION_CREATED="selection:created",e.SELECTION_UPDATED="selection:updated"}(dt||(dt={}));var bt,jt=function(){function e(t){Object(I.a)(this,e),this.rootStore=t,this.canvasStore=void 0,this.listeners=void 0,this.observer=new Set,this.activeObject=void 0,Object(rt.k)(this),this.canvasStore=t.canvasStore,this.listeners={onSelected:this.onSelected.bind(this),onCleared:this.onCleared.bind(this)},this.addEventListeners()}return Object(B.a)(e,[{key:"onSelected",value:function(e){var t=e.target;t&&(this.activeObject=t)}},{key:"onCleared",value:function(){this.activeObject=void 0}},{key:"addEventListeners",value:function(){var e=this;this.canvasStore.canvas.on(dt.SELECTION_CREATED,this.listeners.onSelected),this.canvasStore.canvas.on(dt.SELECTION_UPDATED,this.listeners.onSelected),this.canvasStore.canvas.on(dt.SELECTION_CLEARED,this.listeners.onCleared),Object(rt.m)((function(){return e.activeObject}),(function(){console.log(e.activeObject),e.observer.forEach((function(t){return t(e.activeObject)}))}))}},{key:"subscribe",value:function(e){this.observer.add(e)}},{key:"unsubscribe",value:function(e){this.observer.delete(e)}},{key:"isRect",value:function(){var e;return null===(e=this.activeObject)||void 0===e?void 0:e.isType(He.RECT.value)}},{key:"isEllipse",value:function(){var e;return null===(e=this.activeObject)||void 0===e?void 0:e.isType(He.ELLIPSE.value)}},{key:"isTriangle",value:function(){var e;return null===(e=this.activeObject)||void 0===e?void 0:e.isType(He.TRIANGLE.value)}},{key:"isShape",value:function(){return this.isRect()||this.isEllipse()||this.isTriangle()}},{key:"isPath",value:function(){var e;return null===(e=this.activeObject)||void 0===e?void 0:e.isType("path")}},{key:"isText",value:function(){var e;return null===(e=this.activeObject)||void 0===e?void 0:e.isType("i-text")}},{key:"getObjectTypeName",value:function(){return this.isRect()?He.RECT.display:this.isEllipse()?He.ELLIPSE.display:this.isTriangle()?He.TRIANGLE.display:this.isPath()?"\ud328\uc2a4":this.isText()?"\ud14d\uc2a4\ud2b8":"\uc624\ube0c\uc81d\ud2b8"}}]),e}();!function(e){e.OBJECT_SCALING="object:scaling",e.OBJECT_MODIFIED="object:modified"}(bt||(bt={}));var ft=function(){function e(t){Object(I.a)(this,e),this.rootStore=t,this.observer=new Map,this.addEventListener()}return Object(B.a)(e,[{key:"addEventListener",value:function(){var e=this.rootStore.canvasStore.canvas;e.on(bt.OBJECT_SCALING,this.onScaling.bind(this)),e.on(bt.OBJECT_MODIFIED,this.onModified.bind(this))}},{key:"onScaling",value:function(e){var t;null===(t=this.observer.get(bt.OBJECT_SCALING))||void 0===t||t.forEach((function(t){return t(e)}))}},{key:"onModified",value:function(e){var t;null===(t=this.observer.get(bt.OBJECT_MODIFIED))||void 0===t||t.forEach((function(t){return t(e)}))}},{key:"subscribe",value:function(e,t){var i;this.observer.has(e)||this.observer.set(e,new Set),null===(i=this.observer.get(e))||void 0===i||i.add(t)}},{key:"unsubscribe",value:function(e,t){var i;null===(i=this.observer.get(e))||void 0===i||i.delete(t)}}]),e}(),Ot={shapeType:He.ELLIPSE,fill:void 0,strokeWidth:3,stroke:"#000000"},pt=function(){function e(t){Object(I.a)(this,e),this.rootStore=t,this.canvas=void 0,this.mouseEventStore=void 0,this.objectManager=void 0,this.isDragMode=!1,this.item=void 0,this.shapeType=Ot.shapeType,this.fill=Ot.fill,this.strokeWidth=Ot.strokeWidth,this.stroke=Ot.stroke,Object(rt.k)(this),this.canvas=t.canvasStore.canvas,this.mouseEventStore=t.mouseEventStore,this.objectManager=t.objectManagerStore,this.addEventListeners(),this.addReactions()}return Object(B.a)(e,[{key:"setShapeType",value:function(e){this.shapeType=e}},{key:"setFill",value:function(e){this.fill=e,this.item&&(this.item.set({fill:e}),this.canvas.renderAll())}},{key:"setStroke",value:function(e){this.stroke=e,this.item&&(this.item.set({stroke:e}),this.canvas.renderAll())}},{key:"setStrokeWidth",value:function(e){this.strokeWidth=e,this.item&&(this.item.set({strokeWidth:e}),this.canvas.renderAll())}},{key:"addReactions",value:function(){this.objectManager.subscribe(this.updateObject.bind(this))}},{key:"updateObject",value:function(e){this.isShape(e)?(this.item=e,this.updateShapeStyles()):this.item=void 0}},{key:"setShapeStyles",value:function(e){this.setFill(e.fill),this.setStroke(e.stroke),this.setStrokeWidth(e.strokeWidth)}},{key:"updateShapeStyles",value:function(){if(this.item){var e=this.item,t=e.stroke,i=e.strokeWidth,s=e.fill;this.setShapeStyles({fill:s,stroke:t,strokeWidth:i||Ot.strokeWidth})}}},{key:"addEventListeners",value:function(){this.mouseEventStore.subscribe(st.MOUSE_UP,this.onMouseUp.bind(this)),this.mouseEventStore.subscribe(st.MOUSE_DOWN,this.onMouseDown.bind(this)),this.mouseEventStore.subscribe(st.MOUSE_MOVE,this.onMouseMove.bind(this))}},{key:"isShapeTool",value:function(){return this.rootStore.canvasStore.canvasMode===A.SHAPE}},{key:"isShape",value:function(e){return(null===e||void 0===e?void 0:e.isType(He.ELLIPSE.value))||(null===e||void 0===e?void 0:e.isType(He.RECT.value))||(null===e||void 0===e?void 0:e.isType(He.TRIANGLE.value))}},{key:"onMouseDown",value:function(e){this.isShapeTool()&&(this.isDragMode=!0,this.item=this.shapeType.getShape({left:e.startCursorPosition.x,top:e.startCursorPosition.y,stroke:this.stroke,strokeWidth:this.strokeWidth,fill:this.fill,selectable:!1,hoverCursor:"default",strokeUniform:!0}),this.item.isType(He.RECT.value)||this.item.isType(He.TRIANGLE.value)?this.item.set({width:0,height:0}):this.item.isType(He.ELLIPSE.value)&&this.item.set({rx:0,ry:0}),this.rootStore.canvasStore.canvas.add(this.item))}},{key:"onMouseMove",value:function(e){this.isShapeTool()&&this.isDragMode&&this.item&&(e.currentCursorPosition.x<e.startCursorPosition.x&&this.item.set({left:Math.abs(e.currentCursorPosition.x)}),e.currentCursorPosition.y<e.startCursorPosition.y&&this.item.set({top:Math.abs(e.currentCursorPosition.y)}),this.item.set({flipX:e.currentCursorPosition.x<e.startCursorPosition.x}),this.item.set({flipY:e.currentCursorPosition.y<e.startCursorPosition.y}),this.item.isType(He.RECT.value)||this.item.isType(He.TRIANGLE.value)?this.item.set({width:Math.abs(e.startCursorPosition.x-e.currentCursorPosition.x),height:Math.abs(e.startCursorPosition.y-e.currentCursorPosition.y)}):this.item.isType(He.ELLIPSE.value)&&this.item.set({rx:Math.abs(e.startCursorPosition.x-e.currentCursorPosition.x)/2,ry:Math.abs(e.startCursorPosition.y-e.currentCursorPosition.y)/2}),this.rootStore.canvasStore.canvas.renderAll())}},{key:"onMouseUp",value:function(t){if(this.isShapeTool()&&this.item){if(this.isDragMode=!1,this.item.isType(He.RECT.value)||this.item.isType(He.TRIANGLE.value))this.item.set({width:Math.max(e.MIN_OBJECT_SIZE,this.item.width||e.MIN_OBJECT_SIZE),height:Math.max(e.MIN_OBJECT_SIZE,this.item.height||e.MIN_OBJECT_SIZE)}).setCoords();else if(this.item.isType(He.ELLIPSE.value)){var i=this.item;i.set({rx:Math.max(e.MIN_OBJECT_SIZE/2,i.rx||e.MIN_OBJECT_SIZE/2),ry:Math.max(e.MIN_OBJECT_SIZE/2,i.ry||e.MIN_OBJECT_SIZE/2)}).setCoords()}var s=this.rootStore.canvasStore;s.setCanvasMode(A.SELECT),s.canvas.setActiveObject(this.item),s.canvas.renderAll(),this.item=void 0}}}]),e}();pt.MIN_OBJECT_SIZE=30;var xt=function e(t){Object(I.a)(this,e),this.rootStore=t,Object(rt.k)(this)},St=i(192),yt=i.n(St),Et={FONT_SIZE:Ye[Ye.length/2],FILL:"#000000",FONT_FAMILY:Ke.TIMES_NEW_ROMAN.value},mt=function(){function e(t){Object(I.a)(this,e),this.rootStore=t,this.objectManager=void 0,this.mouseEventStore=void 0,this.objectEventStore=void 0,this.canvas=void 0,this.fontSize=Et.FONT_SIZE,this.fill=Et.FILL,this.fontFamily=Et.FONT_FAMILY,this.item=void 0,Object(rt.k)(this),this.loadFont(),this.objectManager=t.objectManagerStore,this.mouseEventStore=t.mouseEventStore,this.objectEventStore=t.objectEventStore,this.canvas=t.canvasStore.canvas,this.addEventListener(),this.addFontAutoRender()}return Object(B.a)(e,[{key:"setFontSize",value:function(e){this.fontSize=e,this.item&&(this.item.set({fontSize:e}),this.canvas.renderAll())}},{key:"setFill",value:function(e){this.fill=e,this.item&&(this.item.set({fill:e}),this.canvas.renderAll())}},{key:"setFontFamily",value:function(e){this.fontFamily=e,this.item&&(this.item.set({fontFamily:e}),this.canvas.renderAll())}},{key:"addEventListener",value:function(){this.mouseEventStore.subscribe(st.MOUSE_UP,this.onMouseUp.bind(this)),this.objectEventStore.subscribe(bt.OBJECT_MODIFIED,this.onModified.bind(this)),this.objectManager.subscribe(this.updateObject.bind(this))}},{key:"updateObject",value:function(e){e&&this.isText(e)?(this.item=e,this.updateTextStyles()):this.item=void 0}},{key:"updateTextStyles",value:function(){if(this.item){var e=this.item,t=e.fontSize,i=e.fill,s=e.fontFamily;this.setTextStyles({fontSize:t||Et.FONT_SIZE,fill:i||Et.FILL,fontFamily:s||Et.FONT_FAMILY})}}},{key:"setTextStyles",value:function(e){this.setFontSize(e.fontSize),this.setFill(e.fill),this.setFontFamily(e.fontFamily)}},{key:"onMouseUp",value:function(e){if(this.isTextTool()){this.item=new be.fabric.IText("\ud14d\uc2a4\ud2b8\ub97c \uc785\ub825\ud574\uc8fc\uc138\uc694",{top:e.currentCursorPosition.y,left:e.currentCursorPosition.x,fontFamily:this.fontFamily,fontSize:this.fontSize,lockUniScaling:!0,fill:this.fill}),this.item.setControlVisible("mt",!1),this.item.setControlVisible("mb",!1),this.item.setControlVisible("ml",!1),this.item.setControlVisible("mr",!1);var t=this.rootStore.canvasStore;t.canvas.add(this.item),t.setCanvasMode(A.SELECT),t.canvas.setActiveObject(this.item),this.item.selectAll(),this.item.enterEditing()}}},{key:"onModified",value:function(e){var t=e.target;if(t&&this.isText(t)){var i=t,s=parseInt(((i.fontSize||Et.FONT_SIZE)*(i.scaleX||1)).toFixed(0),10);i.set({scaleX:1,scaleY:1}),this.setFontSize(s)}}},{key:"isTextTool",value:function(){return this.rootStore.canvasStore.canvasMode===A.TEXT}},{key:"isText",value:function(e){return e.isType("i-text")}},{key:"loadFont",value:function(){yt.a.load({google:{families:Ke.getGoogleFonts().map((function(e){return e.value}))}})}},{key:"addFontAutoRender",value:function(){var e=this;setInterval((function(){e.canvas.getActiveObjects().filter((function(t){return e.isText(t)})).forEach((function(e){var t=e;t.initDimensions(),t.dirty=!0})),be.fabric.util.clearFabricFontCache(),e.canvas.renderAll()}),500)}}]),e}(),gt=new(function(){function e(){Object(I.a)(this,e),this.canvasElement=void 0,this.canvasStore=void 0,this.objectManagerStore=void 0,this.objectEventStore=void 0,this.mouseEventStore=void 0,this.brushStore=void 0,this.shapeStore=void 0,this.textStore=void 0,this.UIStore=void 0,this.canvasElement=document.createElement("canvas"),document.body.append(this.canvasElement),this.canvasStore=new ht(this,new be.fabric.Canvas(this.canvasElement)),this.objectManagerStore=new jt(this),this.objectEventStore=new ft(this),this.mouseEventStore=new vt(this),this.brushStore=new at(this),this.shapeStore=new pt(this),this.textStore=new mt(this),this.UIStore=new xt(this)}return Object(B.a)(e,[{key:"init",value:function(e){e.append(this.canvasElement.parentElement),this.canvasStore.init()}}]),e}());a.a.render(Object(s.jsx)(r.a.StrictMode,{children:Object(s.jsx)(k,{value:gt,children:Object(s.jsx)(nt,{})})}),document.getElementById("root"))}},[[350,1,2]]]);
//# sourceMappingURL=main.b0edc320.chunk.js.map