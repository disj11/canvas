(this.webpackJsonpcanvas=this.webpackJsonpcanvas||[]).push([[0],{240:function(e,t){},241:function(e,t){},242:function(e,t){},352:function(e,t,n){"use strict";n.r(t);var i=n(0),s=n.n(i),o=n(16),r=n.n(o),a=n(384),c=n(385),l=n(12),u=n.n(l),h=n(1),d=u()((function(){return{progressWrapper:{display:"flex",justifyContent:"center",alignItems:"center"}}})),v=function(e){var t=e.loading,n=e.children,i=d();return Object(h.jsxs)(s.a.Fragment,{children:[Object(h.jsx)(a.a,{}),Object(h.jsx)("div",{children:t?Object(h.jsx)("div",{className:i.progressWrapper,children:Object(h.jsx)(c.a,{})}):n})]})},b=n(109),f=n(4),j="#ac76ff",O="linear-gradient(90deg, rgba(172,118,255,1) 0%, rgba(91,91,255,1) 100%)",x="linear-gradient(90deg, rgba(172,118,255,.4) 0%, rgba(91,91,255,.4) 100%)",p=u()((function(e){return{button:{display:"inline-block",cursor:"pointer",color:"#fff",paddingTop:e.spacing(.5),paddingBottom:e.spacing(.5),paddingRight:e.spacing(3),paddingLeft:e.spacing(3),textAlign:"center"},caption:{fontSize:"0.70rem"},selected:{background:O}}})),g=function(e){var t=e.icon,n=e.text,i=e.onClick,s=e.selected,o=p();return Object(h.jsxs)("div",{className:Object(f.a)(o.button,Object(b.a)({},o.selected,s)),onClick:i,children:[t,Object(h.jsx)("div",{className:o.caption,children:n})]})},S=n(388),y=n(389),E=n(26),m=s.a.createContext({}),k=m.Provider,C=function(){return s.a.useContext(m)},T=n(181),M=n.n(T),I=n(183),w=n.n(I),N=n(182),A=n.n(N),L=n(13),P=n(14),_=function(){function e(t,n){Object(L.a)(this,e),this.value=t,this.display=n,e._values.push(this)}return Object(P.a)(e,null,[{key:"values",value:function(){return this._values}},{key:"valueOf",value:function(e){return this.values().find((function(t){return t.value===e}))}}]),e}();_._values=[],_.SELECT=new _("select","\uc120\ud0dd"),_.BRUSH=new _("brush","\ube0c\ub7ec\uc26c"),_.SHAPE=new _("shape","\uc170\uc774\ud504"),_.TEXT=new _("text","\ud14d\uc2a4\ud2b8"),_.CANVAS=new _("canvas","\uce94\ubc84\uc2a4");var B,R=n(43),F=n(31),D=n(8),U=n(194),W=n(396),G=n(386),z=n(387),H=n(177),J=n.n(H),V=n(178),X=n.n(V),Y=n(179),Z=n.n(Y),K=n(180),q=n.n(K),Q=n(137),$=n.n(Q),ee=n(176);!function(e){e.TEXT="text/plain"}(B||(B={}));var te=function(){function e(){Object(L.a)(this,e)}return Object(P.a)(e,null,[{key:"writeText",value:function(e,t){var n=new Blob([t],{type:B.TEXT}),i=window.URL.createObjectURL(n);this.write(e,i)}},{key:"write",value:function(e,t){var n=document.createElement("a");n.download=e,n.href=t,n.click()}},{key:"read",value:function(){var e=Object(ee.a)($.a.mark((function e(t){return $.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){var i=new FileReader;i.onload=function(){return e(i.result)},i.onerror=function(){return n()},i.readAsText(t)})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),ne=Object(D.a)({paper:{border:"1px solid #d3d4d5"}})((function(e){return Object(h.jsx)(U.a,Object(F.a)({elevation:0,getContentAnchorEl:null,anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"}},e))})),ie=Object(D.a)((function(e){return{root:{"&:focus":{backgroundColor:e.palette.primary.main,"& .MuiListItemIcon-root, & .MuiListItemText-primary":{color:e.palette.common.white}}}}}))(W.a);function se(){var e=s.a.useState(null),t=Object(R.a)(e,2),n=t[0],i=t[1],o=C().canvasStore,r=s.a.useRef(null),a=function(){i(null)};return Object(h.jsxs)("div",{children:[Object(h.jsx)("input",{type:"file",onChange:function(e){var t,n=null===(t=e.target.files)||void 0===t?void 0:t.item(0);e.target.value="",n&&te.read(n).then((function(e){o.canvas.loadFromJSON(e,(function(){}))})).catch((function(e){return console.error(e)}))},ref:r,style:{display:"none"},accept:"application/json"}),Object(h.jsx)(g,{icon:Object(h.jsx)(J.a,{}),text:"\uba54\ub274",onClick:function(e){i(e.currentTarget)}}),Object(h.jsxs)(ne,{anchorEl:n,keepMounted:!0,open:Boolean(n),onClose:a,children:[Object(h.jsxs)(ie,{onClick:function(){var e;null===(e=r.current)||void 0===e||e.click(),a()},children:[Object(h.jsx)(G.a,{children:Object(h.jsx)(X.a,{fontSize:"small"})}),Object(h.jsx)(z.a,{primary:"\uc5f4\uae30"})]}),Object(h.jsxs)(ie,{onClick:function(){te.writeText("canvas.json",JSON.stringify(o.canvas.toJSON())),a()},children:[Object(h.jsx)(G.a,{children:Object(h.jsx)(Z.a,{fontSize:"small"})}),Object(h.jsx)(z.a,{primary:"\uc800\uc7a5"})]}),Object(h.jsxs)(ie,{onClick:function(){var e=o.canvas.toDataURL();te.write("canvas.png",e),a()},children:[Object(h.jsx)(G.a,{children:Object(h.jsx)(q.a,{fontSize:"small"})}),Object(h.jsx)(z.a,{primary:"\uc774\ubbf8\uc9c0\ub85c \uc800\uc7a5"})]})]})]})}var oe=n(184),re=n.n(oe),ae=n(185),ce=n.n(ae),le=u()((function(){return{appBarColor:{backgroundColor:"rgba(30,30,30,0.95)"},left:{justifyContent:"flex-start"},center:{display:"flex",flex:1,justifyContent:"center"},right:{justifyContent:"flex-end"}}})),ue=Object(E.a)((function(){var e=le(),t=C().canvasStore;return Object(h.jsx)(S.a,{classes:{colorDefault:e.appBarColor},color:"default",elevation:0,children:Object(h.jsxs)(y.a,{variant:"dense",children:[Object(h.jsx)("div",{className:e.left,children:Object(h.jsx)(se,{})}),Object(h.jsxs)("div",{className:e.center,children:[Object(h.jsx)(g,{icon:Object(h.jsx)(M.a,{}),text:_.SELECT.display,onClick:function(){return t.setCanvasMode(_.SELECT)},selected:t.canvasMode===_.SELECT}),Object(h.jsx)(g,{icon:Object(h.jsx)(A.a,{}),text:_.BRUSH.display,onClick:function(){return t.setCanvasMode(_.BRUSH)},selected:t.canvasMode===_.BRUSH}),Object(h.jsx)(g,{icon:Object(h.jsx)(w.a,{}),text:_.SHAPE.display,onClick:function(){return t.setCanvasMode(_.SHAPE)},selected:t.canvasMode===_.SHAPE}),Object(h.jsx)(g,{icon:Object(h.jsx)(re.a,{}),text:_.TEXT.display,onClick:function(){return t.setCanvasMode(_.TEXT)},selected:t.canvasMode===_.TEXT}),Object(h.jsx)(g,{icon:Object(h.jsx)(ce.a,{}),text:_.CANVAS.display,onClick:function(){return t.setCanvasMode(_.CANVAS)},selected:t.canvasMode===_.CANVAS})]}),Object(h.jsx)("div",{className:e.right})]})})})),he=n(398),de=n(22),ve=function(){function e(t,n){Object(L.a)(this,e),this.value=t,this.display=n,e._values.push(this)}return Object(P.a)(e,[{key:"getBrush",value:function(t){switch(this){case e.PENCIL:return new de.fabric.PencilBrush(t);case e.CIRCLE:return new de.fabric.CircleBrush(t);case e.SPRAY:return new de.fabric.SprayBrush(t);default:return new de.fabric.PencilBrush(t)}}}],[{key:"values",value:function(){return this._values}},{key:"valueOf",value:function(e){return this.values().find((function(t){return t.value===e}))}}]),e}();ve._values=[],ve.PENCIL=new ve("pencil","\uc5f0\ud544"),ve.CIRCLE=new ve("circle","\uc6d0\ud615"),ve.SPRAY=new ve("spray","\uc2a4\ud504\ub808\uc774");var be,fe=n(37),je=n(39),Oe=n(397),xe=n(390),pe=n(81),ge=n(391),Se=u()((function(e){return{label:{display:"flex",justifyContent:"space-between"}}})),ye=function(e){var t=e.label,n=e.value,i=e.onChange,s=e.prefix,o=e.min,r=e.max,a=Se();return Object(h.jsxs)("div",{children:[Object(h.jsxs)("div",{className:a.label,children:[Object(h.jsx)(pe.a,{variant:"caption",children:t}),Object(h.jsx)(xe.a,{value:n,margin:"dense",inputProps:{min:1,max:100,type:"number"},endAdornment:Object(h.jsx)(ge.a,{position:"end",children:s})})]}),Object(h.jsx)("div",{children:Object(h.jsx)(Oe.a,{min:o,max:r,value:n,onChange:function(e,t){"number"===typeof t&&i(t)}})})]})},Ee=n(112),me=n(394),ke=u()((function(e){return{colorBox:{width:"100%",height:35,border:1,borderStyle:"solid",borderColor:"#c0c0c0",backgroundColor:function(e){return e.color},cursor:function(e){return e.disabled?"default":"pointer"}}}})),Ce=function(e){var t=ke(e),n=s.a.useState(null),i=Object(R.a)(n,2),o=i[0],r=i[1],a=!!o;return Object(h.jsxs)("div",{children:[e.label&&Object(h.jsx)(pe.a,{variant:"caption",children:e.label}),Object(h.jsxs)("div",{children:[Object(h.jsx)("div",{className:t.colorBox,onClick:function(e){r(e.currentTarget)}}),Object(h.jsx)(me.a,{open:a&&!e.disabled,anchorEl:o,onClose:function(){r(null)},children:Object(h.jsx)(Ee.a,{color:e.color,disableAlpha:e.disableAlpha,onChangeComplete:e.onChange})})]})]})},Te=function(e){return Object(h.jsxs)("div",{children:[Object(h.jsx)(he.a,{mb:2,children:Object(h.jsx)(Ce,Object(F.a)({},e))}),Object(h.jsx)(Ee.b,{width:"100%",color:e.color,onChangeComplete:e.onChange})]})},Me=n(395),Ie=n(392),we=function(e){var t=s.a.useRef();return s.a.useEffect((function(){t.current=e})),t.current},Ne=function(e){var t=e.color,n=e.onChange,i=we(t),o=s.a.useState(t?"solid":"none"),r=Object(R.a)(o,2),a=r[0],c=r[1];return Object(h.jsxs)(he.a,{display:"flex",children:[Object(h.jsx)(he.a,{mr:1.5,flexBasis:35,children:Object(h.jsx)(Ce,{color:t,onChange:function(e){var t=e.rgb.a||0===e.rgb.a?"rgba(".concat(e.rgb.r,", ").concat(e.rgb.g,", ").concat(e.rgb.b,", ").concat(e.rgb.a,")"):e.hex;n(t)},disabled:"none"===a})}),Object(h.jsx)(he.a,{flex:1,children:Object(h.jsx)(Ie.a,{fullWidth:!0,children:Object(h.jsxs)(Me.a,{value:a,onChange:function(e){var t=e.target.value;c(t),n("none"===t?void 0:i||j)},children:[Object(h.jsx)(W.a,{value:"none",children:Object(h.jsx)("em",{children:"\uc5c6\uc74c"})}),Object(h.jsx)(W.a,{value:"solid",children:"\ub2e8\uc0c9"})]})})})]})},Ae=n(190),Le=n.n(Ae),Pe=n(191),_e=n.n(Pe),Be=n(192),Re=n.n(Be),Fe=n(393),De=[8,9,10,11,12,14,16,18,20,22,24,26,28,36,48,72,94,130];!function(e){e[e.DEFAULT=0]="DEFAULT",e[e.GOOGLE=1]="GOOGLE"}(be||(be={}));var Ue="left",We="center",Ge="right",ze="normal",He="bold",Je="normal",Ve="italic",Xe=function(){function e(t,n,i){Object(L.a)(this,e),this.value=t,this.display=n,this.type=i,e._values.push(this)}return Object(P.a)(e,null,[{key:"values",value:function(){return this._values}},{key:"valueOf",value:function(e){return this.values().find((function(t){return t.value===e}))}},{key:"getGoogleFonts",value:function(){return this.values().filter((function(e){return e.type===be.GOOGLE}))}}]),e}();Xe._values=[],Xe.TIMES_NEW_ROMAN=new Xe("Times New Roman","Times New Roman",be.DEFAULT),Xe.NOTO_SANS_KR=new Xe("Noto Sans KR","\ub178\ud1a0\uc0b0\uc2a4",be.GOOGLE),Xe.NANUM_GOTHIC=new Xe("Nanum Gothic","\ub098\ub214\uace0\ub515",be.GOOGLE),Xe.NANUM_PEN_SCRIPT=new Xe("Nanum Pen Script","\ub098\ub214\ud39c",be.GOOGLE),Xe.SONG_MYUNG=new Xe("Song Myung","\uc1a1\uba85",be.GOOGLE);var Ye=u()((function(e){return{alignBox:{display:"flex",border:2,borderStyle:"solid",borderColor:"#ddd"},alignButton:{flex:1,borderRadius:0},selected:{background:O,color:"#ffffff"}}})),Ze=function(e){var t=e.textAlign,n=e.onChange,i=Ye();return Object(h.jsxs)("div",{className:i.alignBox,children:[Object(h.jsx)(Fe.a,{className:Object(f.a)(i.alignButton,t===Ue&&i.selected),onClick:function(){return n(Ue)},children:Object(h.jsx)(Le.a,{})}),Object(h.jsx)(Fe.a,{className:Object(f.a)(i.alignButton,t===We&&i.selected),onClick:function(){return n(We)},children:Object(h.jsx)(_e.a,{})}),Object(h.jsx)(Fe.a,{className:Object(f.a)(i.alignButton,t===Ge&&i.selected),onClick:function(){return n(Ge)},children:Object(h.jsx)(Re.a,{})})]})},Ke=u()((function(){return{button:{borderRadius:0,border:2,borderStyle:"solid",borderColor:"#ddd"},selected:{background:O,color:"#ffffff"}}})),qe=function(e){var t=e.bold,n=e.toggle,i=Ke();return Object(h.jsx)(Fe.a,{className:Object(f.a)(i.button,t&&i.selected),onClick:function(){return n(!t)},children:Object(h.jsx)(fe.a,{icon:je.a,size:"lg"})})},Qe=u()((function(){return{button:{borderRadius:0,border:2,borderStyle:"solid",borderColor:"#ddd"},selected:{background:O,color:"#ffffff"}}})),$e=function(e){var t=e.italic,n=e.toggle,i=Qe();return Object(h.jsx)(Fe.a,{className:Object(f.a)(i.button,t&&i.selected),onClick:function(){return n(!t)},children:Object(h.jsx)(fe.a,{icon:je.c,size:"lg"})})},et=u()((function(){return{button:{borderRadius:0,border:2,borderStyle:"solid",borderColor:"#ddd"},selected:{background:O,color:"#ffffff"}}})),tt=function(e){var t=e.underline,n=e.toggle,i=et();return Object(h.jsx)(Fe.a,{className:Object(f.a)(i.button,t&&i.selected),onClick:function(){return n(!t)},children:Object(h.jsx)(fe.a,{icon:je.f,size:"lg"})})},nt=u()((function(e){return{alignBox:{display:"flex","& > *":{flex:1,marginRight:e.spacing(1),paddingTop:e.spacing(1),paddingBottom:e.spacing(1),"&:last-child":{marginRight:0}}}}})),it=function(e){var t=e.bold,n=e.italic,i=e.underline,s=e.toggleBold,o=e.toggleItalic,r=e.toggleUnderline,a=nt();return Object(h.jsxs)("div",{className:a.alignBox,children:[Object(h.jsx)(qe,{bold:t,toggle:s}),Object(h.jsx)($e,{italic:n,toggle:o}),Object(h.jsx)(tt,{underline:i,toggle:r})]})},st=u()((function(e){return{root:{display:"flex",flexDirection:"column",height:"100%"},title:{marginBottom:e.spacing(3)},propBoxWrapper:{flex:1,display:"flex",flexDirection:"column"}}})),ot=Object(E.a)((function(e){var t=e.children,n=st(),i=C(),s=i.canvasStore,o=i.objectManagerStore;return Object(h.jsxs)("div",{className:n.root,children:[Object(h.jsx)("div",{className:n.title,children:Object(h.jsx)(pe.a,{variant:"h6",color:"primary",children:o.activeObject?o.getObjectTypeName():s.canvasMode.display})}),Object(h.jsx)("div",{className:n.propBoxWrapper,children:t})]})})),rt=n(195),at=function(e){var t=e.label,n=e.children,i=Object(rt.a)(e,["label","children"]);return Object(h.jsxs)(he.a,Object(F.a)(Object(F.a)({},i),{},{children:[t&&Object(h.jsx)(he.a,{mb:1,children:Object(h.jsx)(pe.a,{variant:"caption",children:t})}),n]}))},ct=u()((function(e){return{button:{borderRadius:"4px",cursor:"pointer",padding:e.spacing(1),marginRight:e.spacing(.5),"&:hover":{background:x,"& *":{color:"white"}}},selected:{background:O,"& *":{color:"white"}}}})),lt=Object(E.a)((function(){var e=ct(),t=C().brushStore;return Object(h.jsxs)(ot,{children:[!t.item&&Object(h.jsx)("div",{children:Object(h.jsx)(at,{label:"\ubaa8\uc591",mb:3,children:Object(h.jsxs)(he.a,{display:"flex",children:[Object(h.jsx)("div",{className:Object(f.a)(e.button,t.brushType===ve.PENCIL&&e.selected),onClick:function(){return t.setBrushType(ve.PENCIL)},children:Object(h.jsx)(fe.a,{icon:je.d,size:"lg"})}),Object(h.jsx)("div",{className:Object(f.a)(e.button,t.brushType===ve.SPRAY&&e.selected),onClick:function(){return t.setBrushType(ve.SPRAY)},children:Object(h.jsx)(fe.a,{icon:je.e,size:"lg"})}),Object(h.jsx)("div",{className:Object(f.a)(e.button,t.brushType===ve.CIRCLE&&e.selected),onClick:function(){return t.setBrushType(ve.CIRCLE)},children:Object(h.jsx)(fe.a,{icon:je.b,size:"lg"})})]})})}),Object(h.jsx)(at,{mb:3,children:Object(h.jsx)(ye,{label:"\ub450\uaed8",value:t.strokeWidth,onChange:function(e){return t.setStrokeWidth(e)},prefix:"px",min:1})}),Object(h.jsx)(at,{label:"\uc0c9\uc0c1",children:Object(h.jsx)(Te,{color:t.stroke,onChange:function(e){return t.setStroke(e.hex)},disableAlpha:!0})})]})})),ut=function(){function e(t,n){Object(L.a)(this,e),this.value=t,this.display=n,e._values.push(this)}return Object(P.a)(e,[{key:"getShape",value:function(t){switch(this){case e.RECT:return new de.fabric.Rect(t);case e.ELLIPSE:return new de.fabric.Ellipse(t);case e.TRIANGLE:return new de.fabric.Triangle(t);default:return new de.fabric.Rect(t)}}}],[{key:"values",value:function(){return this._values}},{key:"valueOf",value:function(e){return this.values().find((function(t){return t.value===e}))}}]),e}();ut._values=[],ut.RECT=new ut("rect","\uc0ac\uac01\ud615"),ut.ELLIPSE=new ut("ellipse","\uc6d0"),ut.TRIANGLE=new ut("triangle","\uc0bc\uac01\ud615");var ht=u()((function(e){return{button:{borderRadius:"4px",cursor:"pointer",padding:e.spacing(1),marginRight:e.spacing(.5),height:40,"&:hover":{background:x,"& svg > *":{stroke:"white"}}},selected:{background:O,"& svg > *":{stroke:"white"}},propBox:{"& > div":{marginBottom:e.spacing(3)}}}})),dt=Object(E.a)((function(){var e=ht(),t=C().shapeStore;return Object(h.jsx)(ot,{children:Object(h.jsxs)("div",{className:e.propBox,children:[!t.item&&Object(h.jsx)("div",{children:Object(h.jsx)(at,{label:"\ubaa8\uc591",children:Object(h.jsxs)(he.a,{display:"flex",children:[Object(h.jsx)("div",{className:Object(f.a)(e.button,t.shapeType===ut.ELLIPSE&&e.selected),onClick:function(){return t.setShapeType(ut.ELLIPSE)},children:Object(h.jsx)("svg",{height:"24",width:"24",children:Object(h.jsx)("circle",{cx:"12",cy:"12",r:"10",stroke:"black",fill:"transparent",strokeWidth:2})})}),Object(h.jsx)("div",{className:Object(f.a)(e.button,t.shapeType===ut.RECT&&e.selected),onClick:function(){return t.setShapeType(ut.RECT)},children:Object(h.jsx)("svg",{width:"24",height:"24",children:Object(h.jsx)("rect",{width:"24",height:"24",stroke:"black",fill:"transparent",strokeWidth:4})})}),Object(h.jsx)("div",{className:Object(f.a)(e.button,t.shapeType===ut.TRIANGLE&&e.selected),onClick:function(){return t.setShapeType(ut.TRIANGLE)},children:Object(h.jsx)("svg",{width:"24",height:"24",children:Object(h.jsx)("polygon",{points:"12,2 22,22 2,22",stroke:"black",fill:"transparent",strokeWidth:2})})})]})})}),Object(h.jsx)(at,{label:"\ucc44\uc6b0\uae30",children:Object(h.jsx)(Ne,{color:t.fill,onChange:function(e){return t.setFill(e)}})}),Object(h.jsx)(at,{label:"\uc120 \uc0c9\uc0c1",children:Object(h.jsx)(Ne,{color:t.stroke,onChange:function(e){return t.setStroke(e)}})}),Object(h.jsx)(at,{children:Object(h.jsx)(ye,{label:"\uc120 \ub450\uaed8",value:t.strokeWidth,onChange:function(e){return t.setStrokeWidth(e)},prefix:"px"})})]})})})),vt=u()((function(e){return{propBox:{"& > *":{marginBottom:e.spacing(3)}}}})),bt=Object(E.a)((function(){var e=vt(),t=C().textStore;return Object(h.jsx)(ot,{children:Object(h.jsxs)("div",{className:e.propBox,children:[Object(h.jsx)(at,{label:"\ud3f0\ud2b8",children:Object(h.jsx)(Ie.a,{fullWidth:!0,children:Object(h.jsx)(Me.a,{value:t.fontFamily,onChange:function(e){var n=e.target.value;t.setFontFamily(n)},children:Xe.values().map((function(e){return Object(h.jsx)(W.a,{value:e.value,style:{fontFamily:e.value},children:e.display},e.value)}))})})}),Object(h.jsx)(at,{label:"\ud3f0\ud2b8 \ud06c\uae30",children:Object(h.jsxs)(he.a,{display:"flex",children:[Object(h.jsx)(he.a,{flex:1,mr:1.5,children:Object(h.jsx)(Ie.a,{fullWidth:!0,children:Object(h.jsxs)(Me.a,{value:t.fontSize,onChange:function(e){var n=parseInt(e.target.value,10);t.setFontSize(n)},children:[Object(h.jsx)(W.a,{value:t.fontSize,children:t.fontSize}),De.map((function(e){return t.fontSize!==e&&Object(h.jsx)(W.a,{value:e,children:e},e)}))]})})}),Object(h.jsx)(he.a,{flexBasis:35,children:Object(h.jsx)(Ce,{color:t.fill,onChange:function(e){return t.setFill(e.hex)}})})]})}),Object(h.jsx)(at,{label:"\ud3f0\ud2b8 \uc2a4\ud0c0\uc77c",children:Object(h.jsx)(it,{bold:t.isBold(),italic:t.isItalic(),underline:t.underline,toggleBold:function(e){return t.setBold(e)},toggleItalic:function(e){return t.setItalic(e)},toggleUnderline:function(e){return t.setUnderline(e)}})}),Object(h.jsx)(at,{label:"\uc815\ub82c",children:Object(h.jsx)(Ze,{textAlign:t.textAlign,onChange:function(e){return t.setTextAlign(e)}})})]})})})),ft=n(399),jt=Object(E.a)((function(){var e=C().canvasStore,t=s.a.useState(e.width),n=Object(R.a)(t,2),i=n[0],o=n[1],r=s.a.useState(e.height),a=Object(R.a)(r,2),c=a[0],l=a[1];return Object(h.jsxs)(ot,{children:[Object(h.jsx)(at,{label:"\uce94\ubc84\uc2a4 \ud06c\uae30 \uc870\uc815",mb:3,children:Object(h.jsxs)(he.a,{display:"flex",children:[Object(h.jsx)(he.a,{flex:1,mr:1.5,children:Object(h.jsxs)(Ie.a,{fullWidth:!0,children:[Object(h.jsx)(ft.a,{htmlFor:"canvas-width",children:"\ub108\ube44"}),Object(h.jsx)(xe.a,{id:"canvas-width",type:"number",value:i,onChange:function(e){return o(parseInt(e.target.value))},onBlur:function(){return e.setWidth(i)},endAdornment:Object(h.jsx)(ge.a,{position:"end",children:"px"})})]})}),Object(h.jsx)(he.a,{flex:1,children:Object(h.jsxs)(Ie.a,{fullWidth:!0,children:[Object(h.jsx)(ft.a,{htmlFor:"canvas-width",children:"\ub192\uc774"}),Object(h.jsx)(xe.a,{id:"canvas-width",type:"number",value:c,onChange:function(e){return l(parseInt(e.target.value))},onBlur:function(){return e.setHeight(c)},endAdornment:Object(h.jsx)(ge.a,{position:"end",children:"px"})})]})})]})}),Object(h.jsx)(at,{label:"\ubc30\uacbd",children:Object(h.jsx)(Te,{color:e.backgroundColor,onChange:function(t){return e.setBackgroundColor(t.hex)},disableAlpha:!0})})]})})),Ot=function(){return Object(h.jsx)(ot,{children:"\uc624\ube0c\uc81d\ud2b8\ub97c \uc120\ud0dd\ud558\uba74 \uc18d\uc131\uc744 \ubcc0\uacbd\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4."})},xt=u()((function(e){return{root:{padding:e.spacing(3),height:"100%"}}})),pt=Object(E.a)((function(){var e=xt(),t=C(),n=t.canvasStore,i=t.objectManagerStore,o=n.canvasMode,r=i.activeObject;return Object(h.jsx)(s.a.Fragment,{children:Object(h.jsxs)("div",{className:e.root,children:[!r&&Object(h.jsxs)(s.a.Fragment,{children:[o===_.SELECT&&Object(h.jsx)(Ot,{}),o===_.BRUSH&&Object(h.jsx)(lt,{}),o===_.SHAPE&&Object(h.jsx)(dt,{}),o===_.TEXT&&Object(h.jsx)(bt,{}),o===_.CANVAS&&Object(h.jsx)(jt,{})]}),r&&Object(h.jsxs)(s.a.Fragment,{children:[i.isPath()&&Object(h.jsx)(lt,{}),i.isShape()&&Object(h.jsx)(dt,{}),i.isText()&&Object(h.jsx)(bt,{})]})]})})})),gt=u()((function(e){return{root:{display:"flex",flexDirection:"column",width:"100vw",height:"100vh"},flexBox:{display:"flex",flex:1},contents:{display:"flex"},left:{flexBasis:"".concat(260,"px"),backgroundColor:"#f0f0f0"},canvasWrapper:{display:"flex",justifyContent:"center",alignItems:"center",flex:1,backgroundColor:"#c0c0c0",padding:e.spacing(3)}}})),St=Object(E.a)((function(){var e=gt(),t=C(),n=s.a.useRef(null);return s.a.useEffect((function(){if(n.current)return t.init(n.current),function(){return t.onDestroy()}}),[t,n]),Object(h.jsxs)(v,{children:[Object(h.jsx)(ue,{}),Object(h.jsxs)("div",{className:e.root,children:[Object(h.jsx)(y.a,{variant:"dense"}),Object(h.jsxs)("div",{className:e.flexBox,children:[Object(h.jsx)("div",{className:e.left,children:Object(h.jsx)(pt,{})}),Object(h.jsx)("div",{className:e.canvasWrapper,ref:n})]})]})]})})),yt=function(){return s.a.useEffect((function(){document.title="\uce94\ubc84\uc2a4"}),[]),Object(h.jsx)(St,{})},Et=n(9),mt={brushType:ve.PENCIL,stroke:"#000000",strokeWidth:1},kt=function(){function e(t){Object(L.a)(this,e),this.rootStore=t,this.brushType=mt.brushType,this.stroke=mt.stroke,this.strokeWidth=mt.strokeWidth,this.item=void 0,this.listeners=void 0,this.canvas=void 0,this.objectManager=void 0,Object(Et.l)(this),t.canvasStore.registerCanvasModeManager(_.BRUSH,this),this.canvas=t.canvasStore.canvas,this.objectManager=t.objectManagerStore,this.listeners={updateObject:this.updateObject.bind(this)}}return Object(P.a)(e,[{key:"onInit",value:function(){this.addReactions()}},{key:"onDestroy",value:function(){this.removeReactions()}},{key:"onSessionStart",value:function(){this.canvas.isDrawingMode=!0,this.setBrushType(this.brushType)}},{key:"onSessionEnd",value:function(){this.canvas.isDrawingMode=!1}},{key:"setBrushType",value:function(e){this.brushType=e,this.setFreeDrawingBrush()}},{key:"setStroke",value:function(e){var t;this.stroke=e||mt.stroke,null===(t=this.item)||void 0===t||t.set("stroke",e),this.canvas.freeDrawingBrush.color=this.stroke,this.canvas.renderAll()}},{key:"setStrokeWidth",value:function(e){var t;this.strokeWidth=e||mt.strokeWidth,null===(t=this.item)||void 0===t||t.set("strokeWidth",e),this.canvas.freeDrawingBrush.width=this.strokeWidth,this.canvas.renderAll()}},{key:"setFreeDrawingBrush",value:function(){this.canvas.freeDrawingBrush=this.rootStore.brushStore.brushType.getBrush(this.canvas),this.canvas.freeDrawingBrush.color=this.stroke,this.canvas.freeDrawingBrush.width=this.strokeWidth}},{key:"updateObject",value:function(e){this.isBrush(e)?(this.item=e,this.updatePathStyles()):this.item=void 0}},{key:"setPathStyles",value:function(e){this.setStroke(e.stroke),this.setStrokeWidth(e.strokeWidth)}},{key:"updatePathStyles",value:function(){if(this.item){var e=this.item,t=e.stroke,n=e.strokeWidth;this.setPathStyles({stroke:t,strokeWidth:n})}}},{key:"isBrush",value:function(e){return null===e||void 0===e?void 0:e.isType("path")}},{key:"addReactions",value:function(){this.objectManager.subscribe(this.listeners.updateObject)}},{key:"removeReactions",value:function(){this.objectManager.unsubscribe(this.listeners.updateObject)}}]),e}(),Ct=document.createElement("img");Ct.src="data:image/svg+xml,%3C%3Fxml version='1.0' encoding='utf-8'%3F%3E%3C!DOCTYPE svg PUBLIC '-//W3C//DTD SVG 1.1//EN' 'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd'%3E%3Csvg version='1.1' id='Ebene_1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' width='595.275px' height='595.275px' viewBox='200 215 230 470' xml:space='preserve'%3E%3Ccircle style='fill:%23F44336;' cx='299.76' cy='439.067' r='218.516'/%3E%3Cg%3E%3Crect x='267.162' y='307.978' transform='matrix(0.7071 -0.7071 0.7071 0.7071 -222.6202 340.6915)' style='fill:white;' width='65.545' height='262.18'/%3E%3Crect x='266.988' y='308.153' transform='matrix(0.7071 0.7071 -0.7071 0.7071 398.3889 -83.3116)' style='fill:white;' width='65.544' height='262.179'/%3E%3C/g%3E%3C/svg%3E";var Tt,Mt=function(){function e(){Object(L.a)(this,e)}return Object(P.a)(e,null,[{key:"init",value:function(e){de.fabric.Object.prototype.controls.deleteControl=new de.fabric.Control({x:.5,y:-.5,offsetY:-16,offsetX:16,cursorStyle:"pointer",mouseUpHandler:e,render:this.renderIcon(Ct)})}},{key:"renderIcon",value:function(e){return function(t,n,i,s,o){var r=o.cornerSize;r&&(t.save(),t.translate(n,i),t.rotate(de.fabric.util.degreesToRadians(o.angle||0)),t.drawImage(e,-r/2,-r/2,r,r),t.restore())}}}]),e}(),It=500,wt=500,Nt="#ffffff",At=function(){function e(t,n){Object(L.a)(this,e),this.rootStore=t,this.canvas=n,this.canvasModeManagers=new Map,this.width=It,this.height=wt,this.backgroundColor=Nt,this.canvasMode=_.CANVAS,Object(Et.l)(this)}return Object(P.a)(e,[{key:"onInit",value:function(){this.canvas.setWidth(this.width),this.canvas.setHeight(this.height),this.canvas.setBackgroundColor(this.backgroundColor,(function(){})),this.setCanvasMode(this.canvasMode),Mt.init(this.removeActiveObjects.bind(this))}},{key:"onDestroy",value:function(){this.canvas.dispose()}},{key:"registerCanvasModeManager",value:function(e,t){this.canvasModeManagers.set(e,t)}},{key:"setCanvasMode",value:function(e){var t,n,i=this.canvasMode;this.canvasMode=e,this.canvas.discardActiveObject().renderAll(),this.setAllCursor("default"),this.setSelectable(!1),null===(t=this.canvasModeManagers.get(i))||void 0===t||t.onSessionEnd(),null===(n=this.canvasModeManagers.get(e))||void 0===n||n.onSessionStart()}},{key:"setSelectable",value:function(e){this.canvas.selection=e,this.canvas.getObjects().forEach((function(t){t.selectable=e}))}},{key:"setDefaultCursor",value:function(e){this.canvas.defaultCursor=e}},{key:"setHoverCursor",value:function(e){this.canvas.getObjects().forEach((function(t){t.hoverCursor=e}))}},{key:"setAllCursor",value:function(e){this.setDefaultCursor(e),this.setHoverCursor(e)}},{key:"setWidth",value:function(e){this.width=e,this.canvas.setWidth(e)}},{key:"setHeight",value:function(e){this.height=e,this.canvas.setHeight(e)}},{key:"setBackgroundColor",value:function(e){this.backgroundColor=e,this.canvas.setBackgroundColor(e,(function(){}))}},{key:"removeActiveObjects",value:function(){var e=this;return 0!==this.canvas.getActiveObjects().length&&(this.canvas.getActiveObjects().forEach((function(t){return e.canvas.remove(t)})),this.canvas.discardActiveObject(),this.canvas.requestRenderAll(),!0)}}]),e}();!function(e){e.MOUSE_UP="mouse:up",e.MOUSE_DOWN="mouse:down",e.MOUSE_MOVE="mouse:move"}(Tt||(Tt={}));var Lt,Pt=function(){function e(t){Object(L.a)(this,e),this.rootStore=t,this.listeners=void 0,this.startCursorPosition={x:0,y:0},this.currentCursorPosition={x:0,y:0},this.observer=new Map,this.listeners={onMouseDown:this.onMouseDown.bind(this),onMouseUp:this.onMouseUp.bind(this),onMouseMove:this.onMouseMove.bind(this)}}return Object(P.a)(e,[{key:"onInit",value:function(){this.addEventListeners()}},{key:"onDestroy",value:function(){this.removeEventListeners()}},{key:"subscribe",value:function(e,t){var n;this.observer.has(e)||this.observer.set(e,[]),null===(n=this.observer.get(e))||void 0===n||n.push(t)}},{key:"unsubscribe",value:function(e,t){var n;this.observer.set(e,(null===(n=this.observer.get(e))||void 0===n?void 0:n.filter((function(e){return e!==t})))||[])}},{key:"onMouseDown",value:function(e){var t,n=this;this.startCursorPosition=Object(F.a)({},this.getCursorPosition(e)),this.currentCursorPosition=Object(F.a)({},this.getCursorPosition(e)),null===(t=this.observer.get(Tt.MOUSE_DOWN))||void 0===t||t.forEach((function(e){return e({startCursorPosition:n.startCursorPosition,currentCursorPosition:n.currentCursorPosition})}))}},{key:"onMouseMove",value:function(e){var t,n=this;this.currentCursorPosition=Object(F.a)({},this.getCursorPosition(e)),null===(t=this.observer.get(Tt.MOUSE_MOVE))||void 0===t||t.forEach((function(e){return e({startCursorPosition:n.startCursorPosition,currentCursorPosition:n.currentCursorPosition})}))}},{key:"onMouseUp",value:function(e){var t,n=this;this.currentCursorPosition=Object(F.a)({},this.getCursorPosition(e)),null===(t=this.observer.get(Tt.MOUSE_UP))||void 0===t||t.forEach((function(e){return e({startCursorPosition:n.startCursorPosition,currentCursorPosition:n.currentCursorPosition})}))}},{key:"addEventListeners",value:function(){var e=this.rootStore.canvasStore.canvas;e.on(Tt.MOUSE_DOWN,this.listeners.onMouseDown),e.on(Tt.MOUSE_MOVE,this.listeners.onMouseMove),e.on(Tt.MOUSE_UP,this.listeners.onMouseUp)}},{key:"removeEventListeners",value:function(){var e=this.rootStore.canvasStore.canvas;e.off(Tt.MOUSE_DOWN,this.listeners.onMouseDown),e.off(Tt.MOUSE_MOVE,this.listeners.onMouseMove),e.off(Tt.MOUSE_UP,this.listeners.onMouseUp)}},{key:"getCursorPosition",value:function(e){return this.rootStore.canvasStore.canvas.getPointer(e.e)}}]),e}();!function(e){e.SELECTION_CLEARED="selection:cleared",e.SELECTION_CREATED="selection:created",e.SELECTION_UPDATED="selection:updated"}(Lt||(Lt={}));var _t,Bt=function(){function e(t){Object(L.a)(this,e),this.rootStore=t,this.canvasStore=void 0,this.listeners=void 0,this.observer=new Set,this.activeObject=void 0,Object(Et.l)(this),this.canvasStore=t.canvasStore,this.listeners={onSelected:this.onSelected.bind(this),onCleared:this.onCleared.bind(this)},this.addEventListeners()}return Object(P.a)(e,[{key:"onSelected",value:function(e){var t=e.target;t&&(this.activeObject=t)}},{key:"onCleared",value:function(){this.activeObject=void 0}},{key:"addEventListeners",value:function(){var e=this;this.canvasStore.canvas.on(Lt.SELECTION_CREATED,this.listeners.onSelected),this.canvasStore.canvas.on(Lt.SELECTION_UPDATED,this.listeners.onSelected),this.canvasStore.canvas.on(Lt.SELECTION_CLEARED,this.listeners.onCleared),Object(Et.o)((function(){return e.activeObject}),(function(){return e.observer.forEach((function(t){return t(e.activeObject)}))}))}},{key:"subscribe",value:function(e){this.observer.add(e)}},{key:"unsubscribe",value:function(e){console.trace("unsubscribe"),this.observer.delete(e)}},{key:"isRect",value:function(){var e;return null===(e=this.activeObject)||void 0===e?void 0:e.isType(ut.RECT.value)}},{key:"isEllipse",value:function(){var e;return null===(e=this.activeObject)||void 0===e?void 0:e.isType(ut.ELLIPSE.value)}},{key:"isTriangle",value:function(){var e;return null===(e=this.activeObject)||void 0===e?void 0:e.isType(ut.TRIANGLE.value)}},{key:"isShape",value:function(){return this.isRect()||this.isEllipse()||this.isTriangle()}},{key:"isPath",value:function(){var e;return null===(e=this.activeObject)||void 0===e?void 0:e.isType("path")}},{key:"isText",value:function(){var e;return null===(e=this.activeObject)||void 0===e?void 0:e.isType("i-text")}},{key:"isActiveSelection",value:function(){var e;return null===(e=this.activeObject)||void 0===e?void 0:e.isType("activeSelection")}},{key:"isGroup",value:function(){var e;return null===(e=this.activeObject)||void 0===e?void 0:e.isType("group")}},{key:"getObjectTypeName",value:function(){return this.isRect()?ut.RECT.display:this.isEllipse()?ut.ELLIPSE.display:this.isTriangle()?ut.TRIANGLE.display:this.isPath()?"\ud328\uc2a4":this.isText()?"\ud14d\uc2a4\ud2b8":this.isGroup()?"\uadf8\ub8f9":"\uc624\ube0c\uc81d\ud2b8"}}]),e}();!function(e){e.OBJECT_SCALING="object:scaling",e.OBJECT_MODIFIED="object:modified"}(_t||(_t={}));var Rt=function(){function e(t){Object(L.a)(this,e),this.rootStore=t,this.listeners=void 0,this.observer=new Map,this.listeners={onScaling:this.onScaling.bind(this),onModified:this.onModified.bind(this)}}return Object(P.a)(e,[{key:"onInit",value:function(){this.addEventListener()}},{key:"onDestroy",value:function(){this.removeEventListener()}},{key:"addEventListener",value:function(){var e=this.rootStore.canvasStore.canvas;e.on(_t.OBJECT_SCALING,this.listeners.onScaling),e.on(_t.OBJECT_MODIFIED,this.listeners.onModified)}},{key:"removeEventListener",value:function(){var e=this.rootStore.canvasStore.canvas;e.off(_t.OBJECT_SCALING,this.listeners.onScaling),e.off(_t.OBJECT_MODIFIED,this.listeners.onModified)}},{key:"onScaling",value:function(e){var t;null===(t=this.observer.get(_t.OBJECT_SCALING))||void 0===t||t.forEach((function(t){return t(e)}))}},{key:"onModified",value:function(e){var t;null===(t=this.observer.get(_t.OBJECT_MODIFIED))||void 0===t||t.forEach((function(t){return t(e)}))}},{key:"subscribe",value:function(e,t){var n;this.observer.has(e)||this.observer.set(e,new Set),null===(n=this.observer.get(e))||void 0===n||n.add(t)}},{key:"unsubscribe",value:function(e,t){var n;null===(n=this.observer.get(e))||void 0===n||n.delete(t)}}]),e}(),Ft={shapeType:ut.ELLIPSE,fill:void 0,strokeWidth:3,stroke:"#000000"},Dt=function(){function e(t){Object(L.a)(this,e),this.rootStore=t,this.canvas=void 0,this.mouseEventStore=void 0,this.objectManager=void 0,this.listeners=void 0,this.isDragMode=!1,this.item=void 0,this.shapeType=Ft.shapeType,this.fill=Ft.fill,this.strokeWidth=Ft.strokeWidth,this.stroke=Ft.stroke,Object(Et.l)(this),t.canvasStore.registerCanvasModeManager(_.SHAPE,this),this.canvas=t.canvasStore.canvas,this.mouseEventStore=t.mouseEventStore,this.objectManager=t.objectManagerStore,this.listeners={onMouseUp:this.onMouseUp.bind(this),onMouseDown:this.onMouseDown.bind(this),onMouseMove:this.onMouseMove.bind(this),updateObject:this.updateObject.bind(this)}}return Object(P.a)(e,[{key:"onInit",value:function(){this.addEventListeners(),this.addReactions()}},{key:"onDestroy",value:function(){this.removeEventListener(),this.removeReactions()}},{key:"onSessionStart",value:function(){this.rootStore.canvasStore.setAllCursor("crosshair")}},{key:"onSessionEnd",value:function(){}},{key:"setShapeType",value:function(e){this.shapeType=e}},{key:"setFill",value:function(e){this.fill=e,this.item&&(this.item.set({fill:e}),this.canvas.renderAll())}},{key:"setStroke",value:function(e){this.stroke=e,this.item&&(this.item.set({stroke:e}),this.canvas.renderAll())}},{key:"setStrokeWidth",value:function(e){this.strokeWidth=e,this.item&&(this.item.set({strokeWidth:e}),this.canvas.renderAll())}},{key:"addReactions",value:function(){this.objectManager.subscribe(this.listeners.updateObject)}},{key:"removeReactions",value:function(){this.objectManager.unsubscribe(this.listeners.updateObject)}},{key:"updateObject",value:function(e){this.isShape(e)?(this.item=e,this.updateShapeStyles()):this.item=void 0}},{key:"setShapeStyles",value:function(e){this.setFill(e.fill),this.setStroke(e.stroke),this.setStrokeWidth(e.strokeWidth)}},{key:"updateShapeStyles",value:function(){if(this.item){var e=this.item,t=e.stroke,n=e.strokeWidth,i=e.fill;this.setShapeStyles({fill:i,stroke:t,strokeWidth:n||Ft.strokeWidth})}}},{key:"addEventListeners",value:function(){this.mouseEventStore.subscribe(Tt.MOUSE_UP,this.listeners.onMouseUp),this.mouseEventStore.subscribe(Tt.MOUSE_DOWN,this.listeners.onMouseDown),this.mouseEventStore.subscribe(Tt.MOUSE_MOVE,this.listeners.onMouseMove)}},{key:"removeEventListener",value:function(){this.mouseEventStore.unsubscribe(Tt.MOUSE_UP,this.listeners.onMouseUp),this.mouseEventStore.unsubscribe(Tt.MOUSE_DOWN,this.listeners.onMouseDown),this.mouseEventStore.unsubscribe(Tt.MOUSE_MOVE,this.listeners.onMouseMove)}},{key:"isShapeTool",value:function(){return this.rootStore.canvasStore.canvasMode===_.SHAPE}},{key:"isShape",value:function(e){return(null===e||void 0===e?void 0:e.isType(ut.ELLIPSE.value))||(null===e||void 0===e?void 0:e.isType(ut.RECT.value))||(null===e||void 0===e?void 0:e.isType(ut.TRIANGLE.value))}},{key:"onMouseDown",value:function(e){this.isShapeTool()&&(this.isDragMode=!0,this.item=this.shapeType.getShape({left:e.startCursorPosition.x,top:e.startCursorPosition.y,stroke:this.stroke,strokeWidth:this.strokeWidth,fill:this.fill,selectable:!1,hoverCursor:"default",strokeUniform:!0}),this.item.isType(ut.RECT.value)||this.item.isType(ut.TRIANGLE.value)?this.item.set({width:0,height:0}):this.item.isType(ut.ELLIPSE.value)&&this.item.set({rx:0,ry:0}),this.rootStore.canvasStore.canvas.add(this.item))}},{key:"onMouseMove",value:function(e){this.isShapeTool()&&this.isDragMode&&this.item&&(e.currentCursorPosition.x<e.startCursorPosition.x&&this.item.set({left:Math.abs(e.currentCursorPosition.x)}),e.currentCursorPosition.y<e.startCursorPosition.y&&this.item.set({top:Math.abs(e.currentCursorPosition.y)}),this.item.set({flipX:e.currentCursorPosition.x<e.startCursorPosition.x}),this.item.set({flipY:e.currentCursorPosition.y<e.startCursorPosition.y}),this.item.isType(ut.RECT.value)||this.item.isType(ut.TRIANGLE.value)?this.item.set({width:Math.abs(e.startCursorPosition.x-e.currentCursorPosition.x),height:Math.abs(e.startCursorPosition.y-e.currentCursorPosition.y)}):this.item.isType(ut.ELLIPSE.value)&&this.item.set({rx:Math.abs(e.startCursorPosition.x-e.currentCursorPosition.x)/2,ry:Math.abs(e.startCursorPosition.y-e.currentCursorPosition.y)/2}),this.rootStore.canvasStore.canvas.renderAll())}},{key:"onMouseUp",value:function(t){if(this.isShapeTool()&&this.item){if(this.isDragMode=!1,this.item.isType(ut.RECT.value)||this.item.isType(ut.TRIANGLE.value))this.item.set({width:Math.max(e.MIN_OBJECT_SIZE,this.item.width||e.MIN_OBJECT_SIZE),height:Math.max(e.MIN_OBJECT_SIZE,this.item.height||e.MIN_OBJECT_SIZE)}).setCoords();else if(this.item.isType(ut.ELLIPSE.value)){var n=this.item;n.set({rx:Math.max(e.MIN_OBJECT_SIZE/2,n.rx||e.MIN_OBJECT_SIZE/2),ry:Math.max(e.MIN_OBJECT_SIZE/2,n.ry||e.MIN_OBJECT_SIZE/2)}).setCoords()}var i=this.rootStore.canvasStore;i.setCanvasMode(_.SELECT),i.canvas.setActiveObject(this.item),i.canvas.renderAll(),this.item=void 0}}}]),e}();Dt.MIN_OBJECT_SIZE=30;var Ut=function e(t){Object(L.a)(this,e),this.rootStore=t,Object(Et.l)(this)},Wt=n(193),Gt=n.n(Wt),zt={FONT_SIZE:De[De.length/2],FILL:"#000000",FONT_FAMILY:Xe.TIMES_NEW_ROMAN.value,TEXT_ALIGN:Ue,FONT_STYLE:Je,FONT_WEIGHT:ze,UNDERLINE:!1},Ht=function(){function e(t){Object(L.a)(this,e),this.rootStore=t,this.objectManager=void 0,this.mouseEventStore=void 0,this.objectEventStore=void 0,this.canvas=void 0,this.listeners=void 0,this.fontStyle=zt.FONT_STYLE,this.fontWeight=zt.FONT_WEIGHT,this.autoRenderId=void 0,this.fontSize=zt.FONT_SIZE,this.fill=zt.FILL,this.fontFamily=zt.FONT_FAMILY,this.textAlign=zt.TEXT_ALIGN,this.underline=zt.UNDERLINE,this.item=void 0,Object(Et.l)(this),t.canvasStore.registerCanvasModeManager(_.TEXT,this),this.loadFont(),this.objectManager=t.objectManagerStore,this.mouseEventStore=t.mouseEventStore,this.objectEventStore=t.objectEventStore,this.canvas=t.canvasStore.canvas,this.listeners={onMouseUp:this.onMouseUp.bind(this),onModified:this.onModified.bind(this),updateObject:this.updateObject.bind(this)}}return Object(P.a)(e,[{key:"onInit",value:function(){this.addEventListener(),this.addFontAutoRender()}},{key:"onDestroy",value:function(){this.removeEventListener(),this.removeFontAutoRender()}},{key:"onSessionStart",value:function(){this.rootStore.canvasStore.setAllCursor("text")}},{key:"onSessionEnd",value:function(){}},{key:"setFontSize",value:function(e){this.fontSize=e,this.item&&(this.item.set({fontSize:e}),this.canvas.renderAll())}},{key:"setFill",value:function(e){this.fill=e,this.item&&(this.item.set({fill:e}),this.canvas.renderAll())}},{key:"setFontFamily",value:function(e){this.fontFamily=e,this.item&&(this.item.set({fontFamily:e}),this.canvas.renderAll())}},{key:"setTextAlign",value:function(e){this.textAlign=e,this.item&&(this.item.set({textAlign:e}),this.canvas.renderAll())}},{key:"setUnderline",value:function(e){this.underline=e,this.item&&(this.item.set({underline:e}),this.canvas.renderAll())}},{key:"setBold",value:function(e){var t=e?He:ze;this.fontWeight=t,this.item&&(this.item.set({fontWeight:t}),this.canvas.renderAll())}},{key:"isBold",value:function(){return this.fontWeight===He}},{key:"setItalic",value:function(e){var t=e?Ve:Je;this.fontStyle=t,this.item&&(this.item.set({fontStyle:t}),this.canvas.renderAll())}},{key:"isItalic",value:function(){return this.fontStyle===Ve}},{key:"addEventListener",value:function(){this.mouseEventStore.subscribe(Tt.MOUSE_UP,this.listeners.onMouseUp),this.objectEventStore.subscribe(_t.OBJECT_MODIFIED,this.listeners.onModified),this.objectManager.subscribe(this.listeners.updateObject)}},{key:"removeEventListener",value:function(){this.mouseEventStore.unsubscribe(Tt.MOUSE_UP,this.listeners.onMouseUp),this.objectEventStore.unsubscribe(_t.OBJECT_MODIFIED,this.listeners.onModified),this.objectManager.unsubscribe(this.listeners.updateObject)}},{key:"updateObject",value:function(e){e&&this.isText(e)?(this.item=e,this.updateTextStyles()):this.item=void 0}},{key:"updateTextStyles",value:function(){if(this.item){var e=this.item,t=e.fontSize,n=e.fill,i=e.fontFamily,s=e.textAlign,o=e.fontStyle,r=e.fontWeight,a=e.underline;this.setTextStyles({fontSize:t||zt.FONT_SIZE,fill:n||zt.FILL,fontFamily:i||zt.FONT_FAMILY,textAlign:s||zt.TEXT_ALIGN,fontStyle:o||zt.FONT_STYLE,fontWeight:r||zt.FONT_WEIGHT,underline:!!a})}}},{key:"setTextStyles",value:function(e){this.setFontSize(e.fontSize),this.setFill(e.fill),this.setFontFamily(e.fontFamily),this.setTextAlign(e.textAlign)}},{key:"onMouseUp",value:function(e){if(this.isTextTool()){this.item=new de.fabric.IText("\ud14d\uc2a4\ud2b8\ub97c \uc785\ub825\ud574\uc8fc\uc138\uc694",{top:e.currentCursorPosition.y,left:e.currentCursorPosition.x,fontFamily:this.fontFamily,fontSize:this.fontSize,textAlign:this.textAlign,lockUniScaling:!0,fill:this.fill}),this.item.setControlVisible("mt",!1),this.item.setControlVisible("mb",!1),this.item.setControlVisible("ml",!1),this.item.setControlVisible("mr",!1);var t=this.rootStore.canvasStore;t.canvas.add(this.item),t.setCanvasMode(_.SELECT),t.canvas.setActiveObject(this.item),this.item.selectAll(),this.item.enterEditing()}}},{key:"onModified",value:function(e){var t=e.target;if(t&&this.isText(t)){var n=t,i=parseInt(((n.fontSize||zt.FONT_SIZE)*(n.scaleX||1)).toFixed(0),10);n.set({scaleX:1,scaleY:1}),this.setFontSize(i)}}},{key:"isTextTool",value:function(){return this.rootStore.canvasStore.canvasMode===_.TEXT}},{key:"isText",value:function(e){return e.isType("i-text")}},{key:"loadFont",value:function(){Gt.a.load({google:{families:Xe.getGoogleFonts().map((function(e){return e.value}))}})}},{key:"addFontAutoRender",value:function(){var e=this;this.autoRenderId=setInterval((function(){e.canvas.getActiveObjects().filter((function(t){return e.isText(t)})).forEach((function(e){var t=e;t.initDimensions(),t.dirty=!0})),de.fabric.util.clearFabricFontCache(),e.canvas.renderAll()}),1e3)}},{key:"removeFontAutoRender",value:function(){this.autoRenderId&&clearInterval(this.autoRenderId)}}]),e}(),Jt=function(){function e(t){Object(L.a)(this,e),this.rootStore=t,t.canvasStore.registerCanvasModeManager(_.SELECT,this)}return Object(P.a)(e,[{key:"onSessionStart",value:function(){this.rootStore.canvasStore.setSelectable(!0),this.rootStore.canvasStore.setHoverCursor("move")}},{key:"onSessionEnd",value:function(){}}]),e}(),Vt=new(function(){function e(){Object(L.a)(this,e),this.canvasElement=void 0,this.canvasStore=void 0,this.objectManagerStore=void 0,this.objectEventStore=void 0,this.mouseEventStore=void 0,this.brushStore=void 0,this.shapeStore=void 0,this.textStore=void 0,this.selectStore=void 0,this.UIStore=void 0,this.canvasElement=document.createElement("canvas"),document.body.append(this.canvasElement),this.canvasStore=new At(this,new de.fabric.Canvas(this.canvasElement)),this.objectManagerStore=new Bt(this),this.objectEventStore=new Rt(this),this.mouseEventStore=new Pt(this),this.brushStore=new kt(this),this.shapeStore=new Dt(this),this.textStore=new Ht(this),this.selectStore=new Jt(this),this.UIStore=new Ut(this)}return Object(P.a)(e,[{key:"onInit",value:function(){}},{key:"onDestroy",value:function(){Object.values(this).forEach((function(e){e.onDestory&&e.onDestory()}))}},{key:"init",value:function(e){e.append(this.canvasElement.parentElement),Object.values(this).forEach((function(e){e.onInit&&e.onInit()}))}}]),e}());r.a.render(Object(h.jsx)(s.a.StrictMode,{children:Object(h.jsx)(k,{value:Vt,children:Object(h.jsx)(yt,{})})}),document.getElementById("root"))}},[[352,1,2]]]);
//# sourceMappingURL=main.34a2bc7e.chunk.js.map