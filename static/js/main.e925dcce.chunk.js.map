{"version":3,"sources":["templates/layout/Layout.tsx","models/color/CommonColor.tsx","components/tools/ToolButton.tsx","contexts/storeContext.ts","hooks/useStores.tsx","models/tools/ToolTypes.ts","utils/FileUtils.ts","components/tools/MenuToolButton.tsx","components/tools/ToolBox.tsx","models/tools/Brush.ts","models/tools/Text.ts","components/input/Range.tsx","components/input/ColorPicker.tsx","components/input/ColorPalette.tsx","hooks/usePrevious.tsx","components/input/ColorSelect.tsx","components/input/AlignButton.tsx","components/input/BoldButton.tsx","components/input/ItalicButton.tsx","components/input/UnderlineButton.tsx","components/input/TextStyleButton.tsx","components/propbox/PropBoxLayout.tsx","components/propbox/PropBoxItem.tsx","components/propbox/BrushPropBox.tsx","models/tools/Shape.ts","components/propbox/ShapePropBox.tsx","stores/mouseEventStore.ts","components/propbox/TextPropBox.tsx","components/propbox/CanvasPropBox.tsx","components/propbox/SelectPropBox.tsx","components/propbox/PropBox.tsx","templates/canvas/Canvas.tsx","stores/brushStore.ts","stores/canvasStore.ts","components/element/DeleteImageElement.tsx","models/object/DeleteControl.ts","stores/objectManagerStore.ts","stores/objectEventStore.ts","stores/shapeStore.ts","stores/UIStore.ts","stores/textStore.ts","stores/selectStore.ts","stores/rootStore.ts","App.tsx","index.tsx"],"names":["useStyles","makeStyles","progressWrapper","display","justifyContent","alignItems","Layout","loading","children","classes","Fragment","CssBaseline","className","CircularProgress","CommonColor","theme","button","cursor","color","paddingTop","spacing","paddingBottom","paddingRight","paddingLeft","textAlign","caption","fontSize","selected","background","ToolButton","icon","text","onClick","clsx","StoreContext","React","createContext","StoreProvider","Provider","useStores","useContext","ToolTypes","value","_values","push","this","values","find","v","SELECT","BRUSH","SHAPE","TEXT","CANVAS","MimeType","FileUtils","fileName","blob","Blob","type","objectURL","window","URL","createObjectURL","write","dataURL","a","document","createElement","download","href","click","file","Promise","resolve","reject","reader","FileReader","onload","result","onerror","readAsText","StyledMenu","withStyles","paper","border","props","Menu","elevation","getContentAnchorEl","anchorOrigin","vertical","horizontal","transformOrigin","StyledMenuItem","root","backgroundColor","palette","primary","main","common","white","MenuItem","MenuToolButton","useState","anchorEl","setAnchorEl","canvasStore","inputRef","useRef","handleClose","onChange","e","target","files","item","read","then","jsonString","canvas","loadFromJSON","catch","console","error","ref","style","accept","event","currentTarget","keepMounted","open","Boolean","onClose","current","ListItemIcon","ListItemText","writeText","JSON","stringify","toJSON","fullQuality","toDataURL","appBarColor","left","center","flex","right","ToolBox","observer","AppBar","colorDefault","Toolbar","variant","setCanvasMode","canvasMode","BrushType","PENCIL","fabric","PencilBrush","CIRCLE","CircleBrush","SPRAY","SprayBrush","FontFaceType","label","Range","prefix","min","max","Typography","Input","margin","inputProps","endAdornment","InputAdornment","position","Slider","newValue","colorBox","width","height","borderStyle","borderColor","disabled","ColorPicker","Popover","disableAlpha","onChangeComplete","ColorPalette","Box","mb","usePrevious","useEffect","ColorSelect","previousColor","selectedValue","setSelectedValue","mr","flexBasis","rgb","r","g","b","hex","FormControl","fullWidth","Select","undefined","fontSizes","TextAlign","FontWeight","FontStyle","FontFaces","filter","font","GOOGLE","TIMES_NEW_ROMAN","DEFAULT","NOTO_SANS_KR","NANUM_GOTHIC","NANUM_PEN_SCRIPT","SONG_MYUNG","alignBox","alignButton","borderRadius","AlignButton","Button","BoldButton","bold","toggle","faBold","size","ItalicButton","italic","faItalic","UnderlineButton","underline","faUnderline","marginRight","TextStyleButton","toggleBold","toggleItalic","toggleUnderline","flexDirection","title","marginBottom","propBoxWrapper","PropBoxLayout","objectManagerStore","activeObject","getObjectTypeName","PropBoxItem","other","padding","BrushPropBox","brushStore","brushType","setBrushType","faPencilAlt","faSprayCan","faCircle","strokeWidth","setStrokeWidth","stroke","setStroke","ShapeType","options","RECT","Rect","ELLIPSE","Ellipse","TRIANGLE","Triangle","MouseEventType","propBox","ShapePropBox","shapeStore","shapeType","setShapeType","cx","cy","fill","points","setFill","TextPropBox","textStore","fontFamily","setFontFamily","map","parseInt","setFontSize","isBold","isItalic","setBold","setItalic","setUnderline","setTextAlign","CanvasPropBox","setWidth","setHeight","InputLabel","htmlFor","id","onBlur","setBackgroundColor","SelectPropBox","PropBox","selectedTool","isPath","isShape","isText","flexBox","contents","canvasWrapper","Canvas","rootStore","canvasRef","init","onInit","onDestroy","defaultStyles","BrushStore","listeners","objectManager","makeAutoObservable","registerCanvasModeManager","updateObject","bind","addReactions","removeReactions","isDrawingMode","setFreeDrawingBrush","set","freeDrawingBrush","renderAll","getBrush","object","isBrush","updatePathStyles","styles","setPathStyles","isType","subscribe","unsubscribe","CanvasStore","canvasModeManagers","Map","dispose","mode","manager","previousMode","discardActiveObject","setAllCursor","setSelectable","get","onSessionEnd","onSessionStart","selectable","selection","getObjects","forEach","obj","defaultCursor","hoverCursor","setDefaultCursor","setHoverCursor","MouseEventStore","startCursorPosition","x","y","currentCursorPosition","onMouseDown","onMouseUp","onMouseMove","addEventListeners","removeEventListeners","eventType","listener","has","fn","getCursorPosition","MOUSE_DOWN","callback","MOUSE_MOVE","MOUSE_UP","on","off","getPointer","DeleteImageElement","src","SelectionEventType","DeleteControl","deleteAction","Object","prototype","controls","deleteControl","Control","offsetY","offsetX","cursorStyle","mouseUpHandler","render","renderIcon","ctx","top","styleOverride","fabricObject","cornerSize","save","translate","rotate","util","degreesToRadians","angle","drawImage","restore","ObjectEventType","ObjectManagerStore","Set","onSelected","onCleared","initControl","SELECTION_CREATED","SELECTION_UPDATED","SELECTION_CLEARED","reaction","removeActiveObjects","_eventData","transform","getActiveObjects","length","remove","requestRenderAll","add","delete","isRect","isEllipse","isTriangle","isGroup","ObjectEventStore","onScaling","onModified","addEventListener","removeEventListener","OBJECT_SCALING","OBJECT_MODIFIED","callbackFn","ShapeStore","mouseEventStore","isDragMode","updateShapeStyles","setShapeStyles","isShapeTool","getShape","strokeUniform","rx","ry","Math","abs","flipX","flipY","MIN_OBJECT_SIZE","setCoords","circle","setActiveObject","UIStore","FONT_SIZE","FILL","FONT_FAMILY","TEXT_ALIGN","FONT_STYLE","FONT_WEIGHT","UNDERLINE","TextStore","objectEventStore","fontStyle","fontWeight","autoRenderId","loadFont","addFontAutoRender","removeFontAutoRender","changedValue","updateTextStyles","setTextStyles","isTextTool","IText","lockUniScaling","setControlVisible","selectAll","enterEditing","scaleX","toFixed","scaleY","WebFont","load","google","families","getGoogleFonts","setInterval","textObject","initDimensions","dirty","clearFabricFontCache","clearInterval","SelectStore","canvasElement","selectStore","body","append","onDestory","container","parentElement","App","ReactDOM","getElementById"],"mappings":"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","file":"static/js/main.e925dcce.chunk.js","sourcesContent":["import React from \"react\";\nimport CssBaseline from \"@material-ui/core/CssBaseline\";\nimport {CircularProgress} from \"@material-ui/core\";\nimport makeStyles from \"@material-ui/core/styles/makeStyles\";\n\nconst useStyles = makeStyles(() => ({\n    progressWrapper: {\n        display: \"flex\",\n        justifyContent: \"center\",\n        alignItems: \"center\",\n    }\n}))\n\nconst Layout = ({ loading, children }: Props) => {\n    const classes = useStyles();\n\n    return (\n        <React.Fragment>\n            <CssBaseline />\n            <div>\n                {loading ? (\n                    <div className={classes.progressWrapper}><CircularProgress /></div>\n                ) : children}\n            </div>\n        </React.Fragment>\n    )\n}\n\ninterface Props {\n    loading?: boolean;\n    children: React.ReactElement | React.ReactElement[];\n}\n\nexport default Layout;","export const CommonColor = {\n    PRIMARY: \"#ac76ff\",\n    BACKGROUND_GRADIENT: \"linear-gradient(90deg, rgba(172,118,255,1) 0%, rgba(91,91,255,1) 100%)\",\n    BACKGROUND_GRADIENT_HOVER: \"linear-gradient(90deg, rgba(172,118,255,.4) 0%, rgba(91,91,255,.4) 100%)\",\n}","import React from \"react\";\nimport makeStyles from \"@material-ui/core/styles/makeStyles\";\nimport clsx from \"clsx\";\nimport {CommonColor} from \"../../models/color/CommonColor\";\n\nconst useStyles = makeStyles((theme) => ({\n    button: {\n        display: \"inline-block\",\n        cursor: \"pointer\",\n        color: \"#fff\",\n        paddingTop: theme.spacing(0.5),\n        paddingBottom: theme.spacing(0.5),\n        paddingRight: theme.spacing(3),\n        paddingLeft: theme.spacing(3),\n        textAlign: \"center\",\n    },\n    caption: {\n        fontSize: \"0.70rem\",\n    },\n    selected: {\n        background: CommonColor.BACKGROUND_GRADIENT,\n    }\n}));\n\nconst ToolButton = ({icon, text, onClick, selected}: Props) => {\n    const classes = useStyles();\n    return (\n        <div className={clsx(classes.button, {\n            [classes.selected]: selected,\n        })} onClick={onClick}>\n            {icon}\n            <div className={classes.caption}>{text}</div>\n        </div>\n    )\n}\n\ninterface Props {\n    icon: any;\n    text: string;\n    onClick: (event: React.MouseEvent<HTMLElement>) => void;\n    selected?: boolean;\n}\n\nexport default ToolButton;","import React from \"react\";\nimport { RootStore } from \"stores/rootStore\";\n\nexport const StoreContext = React.createContext<RootStore>({} as RootStore);\nexport const StoreProvider = StoreContext.Provider;","import React from \"react\";\nimport {RootStore} from \"../stores/rootStore\";\nimport {StoreContext} from \"../contexts/storeContext\";\n\nexport const useStores = (): RootStore => React.useContext(StoreContext);","export class ToolTypes {\n    private static readonly _values: ToolTypes[] = [];\n    public static readonly SELECT = new ToolTypes(\"select\", \"선택\");\n    public static readonly BRUSH = new ToolTypes(\"brush\", \"브러쉬\");\n    public static readonly SHAPE = new ToolTypes(\"shape\", \"셰이프\");\n    public static readonly TEXT = new ToolTypes(\"text\", \"텍스트\");\n    public static readonly CANVAS = new ToolTypes(\"canvas\", \"캔버스\");\n\n    constructor(\n        public readonly value: string,\n        public readonly display: string,\n    ) {\n        ToolTypes._values.push(this);\n    }\n\n    public static values() {\n        return this._values;\n    }\n\n    public static valueOf(value: string) {\n        return this.values().find(v => v.value === value);\n    }\n}","enum MimeType {\n    TEXT = \"text/plain\",\n}\n\nexport class FileUtils {\n    public static writeText(fileName: string, text: string) {\n        const blob = new Blob([text], { type: MimeType.TEXT });\n        const objectURL = window.URL.createObjectURL(blob);\n        this.write(fileName, objectURL);\n    }\n\n    public static write(fileName: string, dataURL: string) {\n        const a = document.createElement('a');\n        a.download = fileName;\n        a.href = dataURL;\n        a.click();\n    }\n\n    public static async read(file: File): Promise<string> {\n        return new Promise((resolve, reject) => {\n            const reader = new FileReader();\n            reader.onload = () => resolve(reader.result as string);\n            reader.onerror = () => reject();\n            reader.readAsText(file);\n        });\n    }\n}","import React from \"react\";\nimport {withStyles} from \"@material-ui/core/styles\";\nimport Menu, {MenuProps} from \"@material-ui/core/Menu\";\nimport MenuItem from \"@material-ui/core/MenuItem\";\nimport ListItemIcon from \"@material-ui/core/ListItemIcon\";\nimport ListItemText from \"@material-ui/core/ListItemText\";\nimport ToolButton from \"./ToolButton\";\nimport MenuIcon from \"@material-ui/icons/Menu\";\nimport DescriptionIcon from \"@material-ui/icons/Description\";\nimport SaveIcon from \"@material-ui/icons/Save\";\nimport SaveAltIcon from \"@material-ui/icons/SaveAlt\";\nimport {useStores} from \"../../hooks/useStores\";\nimport {FileUtils} from \"../../utils/FileUtils\";\n\nconst StyledMenu = withStyles({\n    paper: {\n        border: \"1px solid #d3d4d5\",\n    },\n})((props: MenuProps) => (\n    <Menu\n        elevation={0}\n        getContentAnchorEl={null}\n        anchorOrigin={{\n            vertical: \"bottom\",\n            horizontal: \"center\",\n        }}\n        transformOrigin={{\n            vertical: \"top\",\n            horizontal: \"center\",\n        }}\n        {...props}\n    />\n));\n\nconst StyledMenuItem = withStyles((theme) => ({\n    root: {\n        \"&:focus\": {\n            backgroundColor: theme.palette.primary.main,\n            \"& .MuiListItemIcon-root, & .MuiListItemText-primary\": {\n                color: theme.palette.common.white,\n            },\n        },\n    },\n}))(MenuItem);\n\nexport default function MenuToolButton() {\n    const [anchorEl, setAnchorEl] = React.useState<null | HTMLElement>(null);\n    const {canvasStore} = useStores();\n    const inputRef = React.useRef<HTMLInputElement>(null);\n\n    const handleClick = (event: React.MouseEvent<HTMLElement>) => {\n        setAnchorEl(event.currentTarget);\n    };\n\n    const handleClose = () => {\n        setAnchorEl(null);\n    };\n\n    const handleFileOpen = () => {\n        inputRef.current?.click();\n        handleClose();\n    }\n\n    const handleFileChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n        const file = e.target.files?.item(0);\n        e.target.value = \"\";\n\n        if (!!file) {\n            FileUtils.read(file).then(jsonString => {\n                canvasStore.canvas.loadFromJSON(jsonString, () => {\n                    //\n                })\n            }).catch(e => console.error(e));\n        }\n    }\n\n    const handleSave = () => {\n        FileUtils.writeText(\"canvas.json\", JSON.stringify(canvasStore.canvas.toJSON()));\n        handleClose();\n    }\n\n    const handleImageSave = () => {\n        const fullQuality = canvasStore.canvas.toDataURL();\n        FileUtils.write(\"canvas.png\", fullQuality);\n        handleClose();\n    }\n\n    return (\n        <div>\n            <input\n                type={\"file\"}\n                onChange={handleFileChange}\n                ref={inputRef}\n                style={{display: \"none\"}}\n                accept=\"application/json\"\n            />\n            <ToolButton icon={<MenuIcon/>} text={\"메뉴\"} onClick={handleClick}/>\n            <StyledMenu\n                anchorEl={anchorEl}\n                keepMounted\n                open={Boolean(anchorEl)}\n                onClose={handleClose}\n            >\n                <StyledMenuItem onClick={handleFileOpen}>\n                    <ListItemIcon>\n                        <DescriptionIcon fontSize=\"small\"/>\n                    </ListItemIcon>\n                    <ListItemText primary=\"열기\"/>\n                </StyledMenuItem>\n                <StyledMenuItem onClick={handleSave}>\n                    <ListItemIcon>\n                        <SaveIcon fontSize=\"small\"/>\n                    </ListItemIcon>\n                    <ListItemText primary=\"저장\"/>\n                </StyledMenuItem>\n                <StyledMenuItem onClick={handleImageSave}>\n                    <ListItemIcon>\n                        <SaveAltIcon fontSize=\"small\"/>\n                    </ListItemIcon>\n                    <ListItemText primary=\"이미지로 저장\"/>\n                </StyledMenuItem>\n            </StyledMenu>\n        </div>\n    );\n}","import React from \"react\";\nimport {AppBar, Toolbar} from \"@material-ui/core\";\nimport makeStyles from \"@material-ui/core/styles/makeStyles\";\nimport {observer} from \"mobx-react\";\nimport {useStores} from \"../../hooks/useStores\";\nimport ToolButton from \"./ToolButton\";\nimport MouseIcon from '@material-ui/icons/Mouse';\nimport DashboardIcon from '@material-ui/icons/Dashboard';\nimport BrushIcon from \"@material-ui/icons/Brush\";\nimport {ToolTypes} from \"../../models/tools/ToolTypes\";\nimport MenuToolButton from \"./MenuToolButton\";\nimport TextFieldsIcon from \"@material-ui/icons/TextFields\";\nimport PhotoSizeSelectSmallIcon from \"@material-ui/icons/PhotoSizeSelectSmall\";\n\nconst useStyles = makeStyles(() => ({\n    appBarColor: {\n        backgroundColor: \"rgba(30,30,30,0.95)\",\n    },\n    left: {\n        justifyContent: \"flex-start\",\n    },\n    center: {\n        display: \"flex\",\n        flex: 1,\n        justifyContent: \"center\",\n    },\n    right: {\n        justifyContent: \"flex-end\",\n    }\n}));\n\nconst ToolBox = observer(() => {\n    const classes = useStyles();\n    const {canvasStore} = useStores();\n\n    return (\n        <AppBar\n            classes={{\n                colorDefault: classes.appBarColor,\n            }}\n            color={\"default\"}\n            elevation={0}\n        >\n            <Toolbar variant={\"dense\"}>\n                <div className={classes.left}>\n                    <MenuToolButton/>\n                </div>\n                <div className={classes.center}>\n                    <ToolButton\n                        icon={<MouseIcon/>}\n                        text={ToolTypes.SELECT.display}\n                        onClick={() => canvasStore.setCanvasMode(ToolTypes.SELECT)}\n                        selected={canvasStore.canvasMode === ToolTypes.SELECT}\n                    />\n                    <ToolButton\n                        icon={<BrushIcon/>}\n                        text={ToolTypes.BRUSH.display}\n                        onClick={() => canvasStore.setCanvasMode(ToolTypes.BRUSH)}\n                        selected={canvasStore.canvasMode === ToolTypes.BRUSH}\n                    />\n                    <ToolButton\n                        icon={<DashboardIcon/>}\n                        text={ToolTypes.SHAPE.display}\n                        onClick={() => canvasStore.setCanvasMode(ToolTypes.SHAPE)}\n                        selected={canvasStore.canvasMode === ToolTypes.SHAPE}\n                    />\n                    <ToolButton\n                        icon={<TextFieldsIcon/>}\n                        text={ToolTypes.TEXT.display}\n                        onClick={() => canvasStore.setCanvasMode(ToolTypes.TEXT)}\n                        selected={canvasStore.canvasMode === ToolTypes.TEXT}\n                    />\n                    <ToolButton\n                        icon={<PhotoSizeSelectSmallIcon/>}\n                        text={ToolTypes.CANVAS.display}\n                        onClick={() => canvasStore.setCanvasMode(ToolTypes.CANVAS)}\n                        selected={canvasStore.canvasMode === ToolTypes.CANVAS}\n                    />\n                </div>\n                <div className={classes.right}>\n                </div>\n            </Toolbar>\n        </AppBar>\n    )\n})\n\nexport default ToolBox;","import {fabric} from \"fabric\";\n\nexport class BrushType {\n    private static readonly _values: BrushType[] = [];\n    public static readonly PENCIL = new BrushType(\"pencil\", \"연필\");\n    public static readonly CIRCLE = new BrushType(\"circle\", \"원형\");\n    public static readonly SPRAY = new BrushType(\"spray\", \"스프레이\");\n\n    constructor(\n        public readonly value: string,\n        public readonly display: string,\n    ) {\n        BrushType._values.push(this);\n    }\n\n    public static values() {\n        return this._values;\n    }\n\n    public static valueOf(value: string) {\n        return this.values().find(v => v.value === value);\n    }\n\n    public getBrush(canvas: fabric.Canvas) {\n        switch (this) {\n            case BrushType.PENCIL:\n                return new (fabric.PencilBrush as any)(canvas);\n            case BrushType.CIRCLE:\n                return new (fabric.CircleBrush as any)(canvas);\n            case BrushType.SPRAY:\n                return new (fabric.SprayBrush as any)(canvas);\n            default:\n                return new (fabric.PencilBrush as any)(canvas);\n        }\n    }\n}","export const fontSizes = [8, 9, 10, 11, 12, 14, 16, 18, 20, 22, 24, 26, 28, 36, 48, 72, 94, 130];\n\nexport enum FontFaceType {\n    DEFAULT,\n    GOOGLE,\n}\n\nexport const TextAlign = {\n    LEFT: \"left\",\n    CENTER: \"center\",\n    RIGHT: \"right\",\n}\n\nexport const FontWeight = {\n    NORMAL: \"normal\",\n    BOLD: \"bold\",\n}\n\nexport const FontStyle = {\n    NORMAL: \"normal\",\n    ITALIC: \"italic\",\n}\n\nexport class FontFaces {\n    private static readonly _values: FontFaces[] = [];\n    public static readonly TIMES_NEW_ROMAN = new FontFaces(\"Times New Roman\", \"Times New Roman\", FontFaceType.DEFAULT);\n    public static readonly NOTO_SANS_KR = new FontFaces(\"Noto Sans KR\", \"노토산스\", FontFaceType.GOOGLE);\n    public static readonly NANUM_GOTHIC = new FontFaces(\"Nanum Gothic\", \"나눔고딕\", FontFaceType.GOOGLE);\n    public static readonly NANUM_PEN_SCRIPT = new FontFaces(\"Nanum Pen Script\", \"나눔펜\", FontFaceType.GOOGLE);\n    public static readonly SONG_MYUNG = new FontFaces(\"Song Myung\", \"송명\", FontFaceType.GOOGLE);\n\n    constructor(\n        public readonly value: string,\n        public readonly display: string,\n        public readonly type: FontFaceType,\n    ) {\n        FontFaces._values.push(this);\n    }\n\n    public static values() {\n        return this._values;\n    }\n\n    public static valueOf(value: string) {\n        return this.values().find(v => v.value === value);\n    }\n\n    public static getGoogleFonts() {\n        return this.values().filter(font => font.type === FontFaceType.GOOGLE);\n    }\n}","import React from \"react\";\nimport makeStyles from \"@material-ui/core/styles/makeStyles\";\nimport { Slider } from \"@material-ui/core\";\nimport { Input } from \"@material-ui/core\";\nimport { Typography } from \"@material-ui/core\";\nimport { InputAdornment } from \"@material-ui/core\";\n\ninterface Props {\n    label: string;\n    value: number;\n    onChange: (value: number) => void;\n    prefix?: string;\n    min?: number;\n    max?: number;\n}\n\nconst useStyles = makeStyles(theme => ({\n    label: {\n        display: \"flex\",\n        justifyContent: \"space-between\",\n    }\n}));\n\nconst Range = ({ label, value, onChange, prefix, min, max }: Props) => {\n    const classes = useStyles();\n\n    const handleSliderChange = (event: any, newValue: number | number[]) => {\n        if (typeof newValue === \"number\") {\n            onChange(newValue);\n        }\n    };\n\n    return (\n        <div>\n            <div className={classes.label}>\n                <Typography variant={\"caption\"}>{label}</Typography>\n                <Input\n                    value={value}\n                    margin=\"dense\"\n                    inputProps={{\n                        min: 1,\n                        max: 100,\n                        type: 'number',\n                    }}\n                    endAdornment={<InputAdornment position=\"end\">{prefix}</InputAdornment>}\n                />\n            </div>\n            <div>\n                <Slider\n                    min={min}\n                    max={max}\n                    value={value}\n                    onChange={handleSliderChange}\n                />\n            </div>\n        </div>\n    )\n}\n\nexport default Range;","import {Popover, Typography} from \"@material-ui/core\";\nimport React from \"react\";\nimport {ChromePicker, ColorResult} from \"react-color\"\nimport makeStyles from \"@material-ui/core/styles/makeStyles\";\n\ninterface Props {\n    label?: string,\n    color: string | undefined,\n    disableAlpha?: boolean,\n    disabled?: boolean,\n    onChange: (color: ColorResult) => void;\n}\n\nconst useStyles = makeStyles(() => ({\n    colorBox: {\n        width: \"100%\",\n        height: 35,\n        border: 1,\n        borderStyle: \"solid\",\n        borderColor: \"#c0c0c0\",\n        backgroundColor: (props: Props) => props.color,\n        cursor: (props: Props) => !props.disabled ? \"pointer\" : \"default\",\n    }\n}));\n\nconst ColorPicker = (props: Props) => {\n    const classes = useStyles(props);\n    const [anchorEl, setAnchorEl] = React.useState<HTMLDivElement | null>(null);\n    const open = !!anchorEl;\n\n    const handleClick = (event: React.MouseEvent<HTMLDivElement>) => {\n        setAnchorEl(event.currentTarget);\n    };\n\n    const handleClose = () => {\n        setAnchorEl(null);\n    };\n\n    return (\n        <div>\n            {props.label && <Typography variant={\"caption\"}>{props.label}</Typography>}\n            <div>\n                <div className={classes.colorBox} onClick={handleClick}/>\n                <Popover\n                    open={open && !props.disabled}\n                    anchorEl={anchorEl}\n                    onClose={handleClose}\n                >\n                    <ChromePicker color={props.color} disableAlpha={props.disableAlpha}\n                                  onChangeComplete={props.onChange}/>\n                </Popover>\n            </div>\n        </div>\n    )\n}\n\nexport default ColorPicker;","import { Box } from \"@material-ui/core\";\nimport React from \"react\";\nimport { ColorResult, TwitterPicker } from \"react-color\"\nimport ColorPicker from \"./ColorPicker\";\n\ninterface Props {\n    color: string | undefined,\n    disableAlpha?: boolean,\n    onChange: (color: ColorResult) => void;\n}\n\nconst ColorPalette = (props: Props) => {\n    return (\n        <div>\n            <Box mb={2}>\n                <ColorPicker {...props} />\n            </Box>\n            <TwitterPicker width={\"100%\"} color={props.color} onChangeComplete={props.onChange} />\n        </div>\n    )\n}\n\nexport default ColorPalette;","import React from \"react\";\n\nconst usePrevious = (value: any) => {\n    const ref = React.useRef();\n    React.useEffect(() => {\n        ref.current = value;\n    });\n\n    return ref.current;\n}\n\nexport default usePrevious;","import { Select } from \"@material-ui/core\";\nimport { MenuItem } from \"@material-ui/core\";\nimport { FormControl } from \"@material-ui/core\";\nimport { Box } from \"@material-ui/core\";\nimport usePrevious from \"hooks/usePrevious\";\nimport { CommonColor } from \"models/color/CommonColor\";\nimport React from \"react\"\nimport { ColorResult } from \"react-color\"\nimport ColorPicker from \"./ColorPicker\"\n\ninterface Props {\n    color: string | undefined;\n    onChange: (color: string | undefined) => void;\n}\n\nconst ColorSelect = ({ color, onChange }: Props) => {\n    const previousColor = usePrevious(color);\n    const [selectedValue, setSelectedValue] = React.useState<string>(!color ? \"none\" : \"solid\");\n\n    const handleColorChange = (color: ColorResult) => {\n        const rgb = !color.rgb.a && color.rgb.a !== 0 ? color.hex : `rgba(${color.rgb.r}, ${color.rgb.g}, ${color.rgb.b}, ${color.rgb.a})`;\n        onChange(rgb);\n    }\n\n    const handleSelectedValueChange = (event: React.ChangeEvent<{ value: unknown }>) => {\n        const value = event.target.value as string;\n        setSelectedValue(value);\n\n        if (value === \"none\") {\n            onChange(undefined);\n        } else {\n            onChange(previousColor || CommonColor.PRIMARY);\n        }\n    };\n\n    return (\n        <Box display={\"flex\"}>\n            <Box mr={1.5} flexBasis={35}>\n                <ColorPicker color={color} onChange={handleColorChange} disabled={selectedValue === \"none\"} />\n            </Box>\n            <Box flex={1}>\n                <FormControl fullWidth>\n                    <Select\n                        value={selectedValue}\n                        onChange={handleSelectedValueChange}\n                    >\n                        <MenuItem value=\"none\">\n                            <em>없음</em>\n                        </MenuItem>\n                        <MenuItem value={\"solid\"}>단색</MenuItem>\n                    </Select>\n                </FormControl>\n            </Box>\n        </Box>\n    )\n}\n\nexport default ColorSelect","import FormatAlignLeftIcon from '@material-ui/icons/FormatAlignLeft';\nimport FormatAlignCenterIcon from '@material-ui/icons/FormatAlignCenter';\nimport FormatAlignRightIcon from '@material-ui/icons/FormatAlignRight';\nimport React from 'react';\nimport makeStyles from '@material-ui/core/styles/makeStyles';\nimport { Button } from '@material-ui/core';\nimport clsx from 'clsx';\nimport { TextAlign } from 'models/tools/Text';\nimport { CommonColor } from 'models/color/CommonColor';\n\nconst useStyles = makeStyles((theme) => ({\n    alignBox: {\n        display: \"flex\",\n        border: 2,\n        borderStyle: \"solid\",\n        borderColor: \"#ddd\",\n    },\n    alignButton: {\n        flex: 1,\n        borderRadius: 0,\n    },\n    selected: {\n        background: CommonColor.BACKGROUND_GRADIENT,\n        color: \"#ffffff\",\n    }\n}));\n\ninterface Props {\n    textAlign: string,\n    onChange: (textAlign: string) => void,\n}\n\nconst AlignButton = ({textAlign, onChange}: Props) => {\n    const classes = useStyles();\n    \n    return (\n        <div className={classes.alignBox}>\n            <Button className={clsx(classes.alignButton, textAlign === TextAlign.LEFT && classes.selected)} onClick={() => onChange(TextAlign.LEFT)}>\n                <FormatAlignLeftIcon/>\n            </Button>\n            <Button className={clsx(classes.alignButton, textAlign === TextAlign.CENTER && classes.selected)} onClick={() => onChange(TextAlign.CENTER)}>\n                <FormatAlignCenterIcon/>\n            </Button>\n            <Button className={clsx(classes.alignButton, textAlign === TextAlign.RIGHT && classes.selected)} onClick={() => onChange(TextAlign.RIGHT)}>\n                <FormatAlignRightIcon/>\n            </Button>\n        </div>\n    )\n}\n\nexport default AlignButton;","import { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { faBold } from \"@fortawesome/free-solid-svg-icons\";\nimport React from \"react\";\nimport { Button } from \"@material-ui/core\";\nimport makeStyles from \"@material-ui/core/styles/makeStyles\";\nimport { CommonColor } from \"models/color/CommonColor\";\nimport clsx from \"clsx\";\n\nconst useStyles = makeStyles(() => ({\n    button: {\n        borderRadius: 0,\n        border: 2,\n        borderStyle: \"solid\",\n        borderColor: \"#ddd\",\n    },\n    selected: {\n        background: CommonColor.BACKGROUND_GRADIENT,\n        color: \"#ffffff\",\n    }\n}));\n\n\ninterface Props {\n    bold: boolean,\n    toggle: (bold: boolean) => void,\n}\n\nconst BoldButton = ({bold, toggle}: Props) => {\n    const classes = useStyles();\n    return (\n        <Button className={clsx(classes.button, bold && classes.selected)} onClick={() => toggle(!bold)}>\n            <FontAwesomeIcon icon={faBold} size=\"lg\" />\n        </Button>\n    )\n}\n\nexport default BoldButton;","import { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { faItalic } from \"@fortawesome/free-solid-svg-icons\";\nimport React from \"react\";\nimport { Button } from \"@material-ui/core\";\nimport makeStyles from \"@material-ui/core/styles/makeStyles\";\nimport { CommonColor } from \"models/color/CommonColor\";\nimport clsx from \"clsx\";\n\nconst useStyles = makeStyles(() => ({\n    button: {\n        borderRadius: 0,\n        border: 2,\n        borderStyle: \"solid\",\n        borderColor: \"#ddd\",\n    },\n    selected: {\n        background: CommonColor.BACKGROUND_GRADIENT,\n        color: \"#ffffff\",\n    }\n}));\n\n\ninterface Props {\n    italic: boolean,\n    toggle: (bold: boolean) => void,\n}\n\nconst ItalicButton = ({italic, toggle}: Props) => {\n    const classes = useStyles();\n    return (\n        <Button className={clsx(classes.button, italic && classes.selected)} onClick={() => toggle(!italic)}>\n            <FontAwesomeIcon icon={faItalic} size=\"lg\" />\n        </Button>\n    )\n}\n\nexport default ItalicButton;","import { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { faUnderline } from \"@fortawesome/free-solid-svg-icons\";\nimport React from \"react\";\nimport { Button } from \"@material-ui/core\";\nimport makeStyles from \"@material-ui/core/styles/makeStyles\";\nimport { CommonColor } from \"models/color/CommonColor\";\nimport clsx from \"clsx\";\n\nconst useStyles = makeStyles(() => ({\n    button: {\n        borderRadius: 0,\n        border: 2,\n        borderStyle: \"solid\",\n        borderColor: \"#ddd\",\n    },\n    selected: {\n        background: CommonColor.BACKGROUND_GRADIENT,\n        color: \"#ffffff\",\n    }\n}));\n\n\ninterface Props {\n    underline: boolean,\n    toggle: (bold: boolean) => void,\n}\n\nconst UnderlineButton = ({underline, toggle}: Props) => {\n    const classes = useStyles();\n    return (\n        <Button className={clsx(classes.button, underline && classes.selected)} onClick={() => toggle(!underline)}>\n            <FontAwesomeIcon icon={faUnderline} size=\"lg\" />\n        </Button>\n    )\n}\n\nexport default UnderlineButton;","import React from 'react';\nimport makeStyles from '@material-ui/core/styles/makeStyles';\nimport BoldButton from './BoldButton';\nimport ItalicButton from './ItalicButton';\nimport UnderlineButton from './UnderlineButton';\n\nconst useStyles = makeStyles((theme) => ({\n    alignBox: {\n        display: \"flex\",\n        \"& > *\": {\n            flex: 1,\n            marginRight: theme.spacing(1),\n            paddingTop: theme.spacing(1),\n            paddingBottom: theme.spacing(1),\n            \"&:last-child\": {\n                marginRight: 0,\n            }\n        }\n    },\n}));\n\ninterface Props {\n    bold: boolean;\n    italic: boolean;\n    underline: boolean;\n    toggleBold: (bold: boolean) => void;\n    toggleItalic: (italic: boolean) => void;\n    toggleUnderline: (underline: boolean) => void;\n}\n\nconst TextStyleButton = ({bold, italic, underline, toggleBold, toggleItalic, toggleUnderline}: Props) => {\n    const classes = useStyles();\n    \n    return (\n        <div className={classes.alignBox}>\n            <BoldButton bold={bold} toggle={toggleBold}/>\n            <ItalicButton italic={italic} toggle={toggleItalic}/>\n            <UnderlineButton underline={underline} toggle={toggleUnderline}/>\n        </div>\n    )\n}\n\nexport default TextStyleButton;","import {Typography} from \"@material-ui/core\";\nimport makeStyles from \"@material-ui/core/styles/makeStyles\";\nimport { useStores } from \"hooks/useStores\";\nimport { observer } from \"mobx-react\";\nimport React from \"react\";\n\nconst useStyles = makeStyles(theme => ({\n    root: {\n        display: \"flex\",\n        flexDirection: \"column\",\n        height: \"100%\",\n    },\n    title: {\n        marginBottom: theme.spacing(3),\n    },\n    propBoxWrapper: {\n        flex: 1,\n        display: \"flex\",\n        flexDirection: \"column\",\n    },\n}))\n\nconst PropBoxLayout: React.FC = observer(({ children }) => {\n    const classes = useStyles();\n    const { canvasStore, objectManagerStore } = useStores();\n\n    return (\n        <div className={classes.root}>\n            <div className={classes.title}>\n                <Typography variant={\"h6\"} color={\"primary\"}>{objectManagerStore.activeObject ? objectManagerStore.getObjectTypeName() : canvasStore.canvasMode.display}</Typography>\n            </div>\n            <div className={classes.propBoxWrapper}>\n                {children}\n            </div>\n        </div>\n    )\n})\n\nexport default PropBoxLayout;","import React from \"react\";\nimport {Box, BoxProps, Typography} from \"@material-ui/core\";\n\ninterface Props extends BoxProps {\n    label?: string,\n}\n\nconst PropBoxItem: React.FC<Props> = ({label, children, ...other}) => {\n    return (\n        <Box {...other}>\n            {label && (\n                <Box mb={1}>\n                    <Typography variant={\"caption\"}>{label}</Typography>\n                </Box>\n            )}\n            {children}\n        </Box>\n    )\n}\n\nexport default PropBoxItem;","import {Box} from \"@material-ui/core\";\nimport {BrushType} from \"../../models/tools/Brush\";\nimport React from \"react\";\nimport makeStyles from \"@material-ui/core/styles/makeStyles\";\nimport {observer} from \"mobx-react\";\nimport {useStores} from \"../../hooks/useStores\";\nimport {FontAwesomeIcon} from \"@fortawesome/react-fontawesome\";\nimport {faCircle, faPencilAlt, faSprayCan} from \"@fortawesome/free-solid-svg-icons\";\nimport clsx from \"clsx\";\nimport {CommonColor} from \"../../models/color/CommonColor\";\nimport {ColorPalette, Range} from \"components/input\";\nimport PropBoxLayout from \"./PropBoxLayout\";\nimport PropBoxItem from \"./PropBoxItem\";\n\nconst useStyles = makeStyles(theme => ({\n    button: {\n        borderRadius: \"4px\",\n        cursor: \"pointer\",\n        padding: theme.spacing(1),\n        marginRight: theme.spacing(0.5),\n        \"&:hover\": {\n            background: CommonColor.BACKGROUND_GRADIENT_HOVER,\n            \"& *\": {\n                color: \"white\",\n            }\n        },\n    },\n    selected: {\n        background: CommonColor.BACKGROUND_GRADIENT,\n        \"& *\": {\n            color: \"white\",\n        }\n    },\n}))\n\nconst BrushPropBox = observer(() => {\n    const classes = useStyles();\n    const {brushStore} = useStores();\n\n    return (\n        <PropBoxLayout>\n            {!brushStore.item && <div>\n                <PropBoxItem label={\"모양\"} mb={3}>\n                    <Box display=\"flex\">\n                        <div\n                            className={clsx(classes.button, brushStore.brushType === BrushType.PENCIL && classes.selected)}\n                            onClick={() => brushStore.setBrushType(BrushType.PENCIL)}\n                        >\n                            <FontAwesomeIcon icon={faPencilAlt} size=\"lg\"/>\n                        </div>\n                        <div\n                            className={clsx(classes.button, brushStore.brushType === BrushType.SPRAY && classes.selected)}\n                            onClick={() => brushStore.setBrushType(BrushType.SPRAY)}\n                        >\n                            <FontAwesomeIcon icon={faSprayCan} size=\"lg\"/>\n                        </div>\n                        <div\n                            className={clsx(classes.button, brushStore.brushType === BrushType.CIRCLE && classes.selected)}\n                            onClick={() => brushStore.setBrushType(BrushType.CIRCLE)}\n                        >\n                            <FontAwesomeIcon icon={faCircle} size=\"lg\"/>\n                        </div>\n                    </Box>\n                </PropBoxItem>\n            </div>}\n            <PropBoxItem mb={3}>\n                <Range\n                    label=\"두께\"\n                    value={brushStore.strokeWidth}\n                    onChange={(strokeWidth) => brushStore.setStrokeWidth(strokeWidth)}\n                    prefix={\"px\"}\n                    min={1}\n                />\n            </PropBoxItem>\n            <PropBoxItem label={\"색상\"}>\n                <ColorPalette color={brushStore.stroke} onChange={(color) => brushStore.setStroke(color.hex)}\n                              disableAlpha={true}/>\n            </PropBoxItem>\n        </PropBoxLayout>\n    )\n})\n\nexport default BrushPropBox;","import {fabric} from \"fabric\";\n\nexport class ShapeType {\n    private static readonly _values: ShapeType[] = [];\n    public static readonly RECT = new ShapeType(\"rect\", \"사각형\");\n    public static readonly ELLIPSE = new ShapeType(\"ellipse\", \"원\");\n    public static readonly TRIANGLE = new ShapeType(\"triangle\", \"삼각형\");\n\n    constructor(\n        public readonly value: string,\n        public readonly display: string,\n    ) {\n        ShapeType._values.push(this);\n    }\n\n    public static values() {\n        return this._values;\n    }\n\n    public static valueOf(value: string) {\n        return this.values().find(v => v.value === value);\n    }\n\n    public getShape<T extends fabric.IObjectOptions>(options?: T) {\n        switch (this) {\n            case ShapeType.RECT:\n                return new fabric.Rect(options);\n            case ShapeType.ELLIPSE:\n                return new fabric.Ellipse(options);\n            case ShapeType.TRIANGLE:\n                return new fabric.Triangle(options);\n            default:\n                return new fabric.Rect(options);\n        }\n    }\n}","import {Box} from \"@material-ui/core\";\nimport React from \"react\";\nimport makeStyles from \"@material-ui/core/styles/makeStyles\";\nimport {observer} from \"mobx-react\";\nimport {ShapeType} from \"../../models/tools/Shape\";\nimport clsx from \"clsx\";\nimport {CommonColor} from \"../../models/color/CommonColor\";\nimport PropBoxLayout from \"./PropBoxLayout\";\nimport {useStores} from \"hooks/useStores\";\nimport {ColorSelect, Range} from \"components/input\";\nimport PropBoxItem from \"./PropBoxItem\";\n\nconst useStyles = makeStyles(theme => ({\n    button: {\n        borderRadius: \"4px\",\n        cursor: \"pointer\",\n        padding: theme.spacing(1),\n        marginRight: theme.spacing(0.5),\n        height: 40,\n        \"&:hover\": {\n            background: CommonColor.BACKGROUND_GRADIENT_HOVER,\n            \"& svg > *\": {\n                stroke: \"white\",\n            }\n        },\n    },\n    selected: {\n        background: CommonColor.BACKGROUND_GRADIENT,\n        \"& svg > *\": {\n            stroke: \"white\",\n        }\n    },\n    propBox: {\n        \"& > div\": {\n            marginBottom: theme.spacing(3),\n        }\n    }\n}))\n\nconst ShapePropBox = observer(() => {\n    const classes = useStyles();\n    const { shapeStore } = useStores();\n\n    return (\n        <PropBoxLayout>\n            <div className={classes.propBox}>\n                {!shapeStore.item && <div>\n                    <PropBoxItem label={\"모양\"}>\n                        <Box display={\"flex\"}>\n                            <div\n                                className={clsx(classes.button, shapeStore.shapeType === ShapeType.ELLIPSE && classes.selected)}\n                                onClick={() => shapeStore.setShapeType(ShapeType.ELLIPSE)}\n                            >\n                                <svg height=\"24\" width=\"24\">\n                                    <circle cx=\"12\" cy=\"12\" r=\"10\" stroke=\"black\" fill=\"transparent\" strokeWidth={2} />\n                                </svg>\n                            </div>\n                            <div\n                                className={clsx(classes.button, shapeStore.shapeType === ShapeType.RECT && classes.selected)}\n                                onClick={() => shapeStore.setShapeType(ShapeType.RECT)}\n                            >\n                                <svg width=\"24\" height=\"24\">\n                                    <rect width=\"24\" height=\"24\" stroke=\"black\" fill=\"transparent\" strokeWidth={4} />\n                                </svg>\n                            </div>\n                            <div\n                                className={clsx(classes.button, shapeStore.shapeType === ShapeType.TRIANGLE && classes.selected)}\n                                onClick={() => shapeStore.setShapeType(ShapeType.TRIANGLE)}\n                            >\n                                <svg width=\"24\" height=\"24\">\n                                    <polygon points=\"12,2 22,22 2,22\" stroke=\"black\" fill=\"transparent\" strokeWidth={2} />\n                                </svg>\n                            </div>\n                        </Box>\n                    </PropBoxItem>\n                </div>}\n                <PropBoxItem label={\"채우기\"}>\n                    <ColorSelect color={shapeStore.fill} onChange={(color: string | undefined) => shapeStore.setFill(color)} />\n                </PropBoxItem>\n                <PropBoxItem label={\"선 색상\"}>\n                    <ColorSelect color={shapeStore.stroke} onChange={(color: string | undefined) => shapeStore.setStroke(color)} />\n                </PropBoxItem>\n                <PropBoxItem>\n                    <Range label=\"선 두께\" value={shapeStore.strokeWidth} onChange={(strokeWidth) => shapeStore.setStrokeWidth(strokeWidth)} prefix={\"px\"} />\n                </PropBoxItem>\n            </div>\n        </PropBoxLayout>\n    )\n})\n\nexport default ShapePropBox;","import { IEvent } from \"fabric/fabric-impl\";\nimport { RootStore, Store } from \"./rootStore\";\n\nexport enum MouseEventType {\n    MOUSE_UP = \"mouse:up\",\n    MOUSE_DOWN = \"mouse:down\",\n    MOUSE_MOVE = \"mouse:move\",\n}\n\nexport interface MouseEventObject {\n    startCursorPosition: {x: number, y: number},\n    currentCursorPosition: {x: number, y: number},\n}\n\nexport class MouseEventStore implements Store {\n    private readonly listeners: any;\n    private startCursorPosition = { x: 0, y: 0 };\n    private currentCursorPosition = { x: 0, y: 0 };\n    private observer: Map<MouseEventType, Array<(e: MouseEventObject) => void>> = new Map();\n\n    constructor(private readonly rootStore: RootStore) {\n        // this.addEventListeners();\n        this.listeners = {\n            onMouseDown: this.onMouseDown.bind(this),\n            onMouseUp: this.onMouseUp.bind(this),\n            onMouseMove: this.onMouseMove.bind(this),\n        }\n    }\n\n    onInit() {\n        this.addEventListeners();\n    }\n\n    onDestroy() {\n        this.removeEventListeners();\n    }\n\n    subscribe(eventType: MouseEventType, listener: (e: MouseEventObject) => void) {\n        if (!this.observer.has(eventType)) {\n            this.observer.set(eventType, []);\n        }\n        \n        this.observer.get(eventType)?.push(listener);\n    }\n\n    unsubscribe(eventType: MouseEventType, listener: (e: MouseEventObject) => void) {\n        this.observer.set(eventType, this.observer.get(eventType)?.filter(fn => fn !== listener) || []);\n    }\n\n    private onMouseDown(e: IEvent) {\n        this.startCursorPosition = { ...this.getCursorPosition(e) };\n        this.currentCursorPosition = { ...this.getCursorPosition(e) };\n\n        this.observer.get(MouseEventType.MOUSE_DOWN)?.forEach(callback => callback({\n            startCursorPosition: this.startCursorPosition,\n            currentCursorPosition: this.currentCursorPosition,    \n        }));\n    }\n\n    private onMouseMove(e: IEvent) {\n        this.currentCursorPosition = { ...this.getCursorPosition(e) };\n\n        this.observer.get(MouseEventType.MOUSE_MOVE)?.forEach(callback => callback({\n            startCursorPosition: this.startCursorPosition,\n            currentCursorPosition: this.currentCursorPosition,    \n        }));\n    }\n\n    private onMouseUp(e: IEvent) {\n        this.currentCursorPosition = { ...this.getCursorPosition(e) };\n\n        this.observer.get(MouseEventType.MOUSE_UP)?.forEach(callback => callback({\n            startCursorPosition: this.startCursorPosition,\n            currentCursorPosition: this.currentCursorPosition,    \n        }));\n    }\n\n    private addEventListeners() {\n        const { canvas } = this.rootStore.canvasStore;\n        canvas.on(MouseEventType.MOUSE_DOWN, this.listeners.onMouseDown);\n        canvas.on(MouseEventType.MOUSE_MOVE, this.listeners.onMouseMove);\n        canvas.on(MouseEventType.MOUSE_UP, this.listeners.onMouseUp);\n    }\n\n    private removeEventListeners() {\n        const { canvas } = this.rootStore.canvasStore;\n        canvas.off(MouseEventType.MOUSE_DOWN, this.listeners.onMouseDown);\n        canvas.off(MouseEventType.MOUSE_MOVE, this.listeners.onMouseMove);\n        canvas.off(MouseEventType.MOUSE_UP, this.listeners.onMouseUp);\n    }\n\n    private getCursorPosition(e: IEvent) {\n        return this.rootStore.canvasStore.canvas.getPointer(e.e);\n    }\n}","import makeStyles from \"@material-ui/core/styles/makeStyles\";\nimport React from \"react\";\nimport PropBoxLayout from \"./PropBoxLayout\";\nimport { AlignButton, ColorPicker, TextStyleButton } from \"../input\";\nimport { useStores } from \"hooks/useStores\";\nimport { observer } from \"mobx-react\";\nimport { Box, FormControl, Select } from \"@material-ui/core\";\nimport { MenuItem } from \"@material-ui/core\";\nimport { FontFaces, fontSizes } from \"models/tools/Text\";\nimport PropBoxItem from \"./PropBoxItem\";\n\nconst useStyles = makeStyles(theme => ({\n    propBox: {\n        \"& > *\": {\n            marginBottom: theme.spacing(3),\n        }\n    }\n}));\n\nconst TextPropBox = observer(() => {\n    const classes = useStyles();\n    const { textStore } = useStores();\n\n    const handleFontSizeChange = (event: React.ChangeEvent<{ value: unknown }>) => {\n        const fontSize = parseInt(event.target.value as string, 10);\n        textStore.setFontSize(fontSize);\n    };\n\n    const handleFontFamilyChange = (event: React.ChangeEvent<{ value: unknown }>) => {\n        const fontFamily = event.target.value as string;\n        textStore.setFontFamily(fontFamily);\n    };\n\n    return (\n        <PropBoxLayout>\n            <div className={classes.propBox}>\n                <PropBoxItem label={\"폰트\"}>\n                    <FormControl fullWidth>\n                        <Select\n                            value={textStore.fontFamily}\n                            onChange={handleFontFamilyChange}\n                        >\n                            {FontFaces.values().map(font => (\n                                <MenuItem\n                                    key={font.value}\n                                    value={font.value}\n                                    style={{\n                                        fontFamily: font.value,\n                                    }}\n                                >\n                                    {font.display}\n                                </MenuItem>\n                            ))}\n                        </Select>\n                    </FormControl>\n                </PropBoxItem>\n                <PropBoxItem label={\"폰트 크기\"}>\n                    <Box display={\"flex\"}>\n                        <Box flex={1} mr={1.5}>\n                            <FormControl fullWidth>\n                                <Select\n                                    value={textStore.fontSize}\n                                    onChange={handleFontSizeChange}\n                                >\n                                    <MenuItem value={textStore.fontSize}>{textStore.fontSize}</MenuItem>\n                                    {fontSizes.map(fontSize => (\n                                        textStore.fontSize !== fontSize && <MenuItem key={fontSize} value={fontSize}>{fontSize}</MenuItem>\n                                    ))}\n                                </Select>\n                            </FormControl>\n                        </Box>\n                        <Box flexBasis={35}>\n                            <ColorPicker color={textStore.fill} onChange={(color) => textStore.setFill(color.hex)} />\n                        </Box>\n                    </Box>\n                </PropBoxItem>\n                <PropBoxItem label={\"폰트 스타일\"}>\n                    <TextStyleButton\n                        bold={textStore.isBold()}\n                        italic={textStore.isItalic()}\n                        underline={textStore.underline}\n                        toggleBold={(bold) => textStore.setBold(bold)}\n                        toggleItalic={(italic) => textStore.setItalic(italic)}\n                        toggleUnderline={(underline) => textStore.setUnderline(underline)}\n                    />\n                </PropBoxItem>\n                <PropBoxItem label={\"정렬\"}>\n                    <AlignButton textAlign={textStore.textAlign} onChange={(textAlign) => textStore.setTextAlign(textAlign)} />\n                </PropBoxItem>\n            </div>\n        </PropBoxLayout>\n    )\n})\n\nexport default TextPropBox;","import {observer} from \"mobx-react\";\nimport {useStores} from \"../../hooks/useStores\";\nimport PropBoxLayout from \"./PropBoxLayout\";\nimport {Box, FormControl, Input, InputAdornment, InputLabel} from \"@material-ui/core\";\nimport React from \"react\";\nimport {ColorPalette} from \"../input\";\nimport PropBoxItem from \"./PropBoxItem\";\n\nconst CanvasPropBox = observer(() => {\n    const {canvasStore} = useStores();\n    const [width, setWidth] = React.useState(canvasStore.width);\n    const [height, setHeight] = React.useState(canvasStore.height);\n\n    return (\n        <PropBoxLayout>\n            <PropBoxItem label={\"캔버스 크기 조정\"} mb={3}>\n                <Box display={\"flex\"}>\n                    <Box flex={1} mr={1.5}>\n                        <FormControl fullWidth>\n                            <InputLabel htmlFor={\"canvas-width\"}>너비</InputLabel>\n                            <Input\n                                id={\"canvas-width\"}\n                                type={\"number\"}\n                                value={width}\n                                onChange={(event) => setWidth(parseInt(event.target.value))}\n                                onBlur={() => canvasStore.setWidth(width)}\n                                endAdornment={<InputAdornment position=\"end\">px</InputAdornment>}\n                            />\n                        </FormControl>\n                    </Box>\n                    <Box flex={1}>\n                        <FormControl fullWidth>\n                            <InputLabel htmlFor={\"canvas-width\"}>높이</InputLabel>\n                            <Input\n                                id={\"canvas-width\"}\n                                type={\"number\"}\n                                value={height}\n                                onChange={(event) => setHeight(parseInt(event.target.value))}\n                                onBlur={() => canvasStore.setHeight(height)}\n                                endAdornment={<InputAdornment position=\"end\">px</InputAdornment>}\n                            />\n                        </FormControl>\n                    </Box>\n                </Box>\n            </PropBoxItem>\n            <PropBoxItem label={\"배경\"}>\n                <ColorPalette\n                    color={canvasStore.backgroundColor}\n                    onChange={(event) => canvasStore.setBackgroundColor(event.hex)}\n                    disableAlpha={true}\n                />\n            </PropBoxItem>\n        </PropBoxLayout>\n    )\n})\n\nexport default CanvasPropBox;","import PropBoxLayout from \"./PropBoxLayout\";\n\nconst SelectPropBox = () => {\n    return (\n        <PropBoxLayout>\n            오브젝트를 선택하면 속성을 변경할 수 있습니다.\n        </PropBoxLayout>\n    )\n}\n\nexport default SelectPropBox;","import React from \"react\";\nimport {observer} from \"mobx-react\";\nimport makeStyles from \"@material-ui/core/styles/makeStyles\";\nimport {useStores} from \"../../hooks/useStores\";\nimport {ToolTypes} from \"../../models/tools/ToolTypes\";\nimport BrushPropBox from \"./BrushPropBox\";\nimport ShapePropBox from \"./ShapePropBox\";\nimport TextPropBox from \"./TextPropBox\";\nimport CanvasPropBox from \"./CanvasPropBox\";\nimport SelectPropBox from \"./SelectPropBox\";\n\nconst useStyles = makeStyles((theme) => ({\n    root: {\n        padding: theme.spacing(3),\n        height: \"100%\",\n    }\n}));\n\nconst PropBox = observer(() => {\n    const classes = useStyles();\n    const {canvasStore, objectManagerStore} = useStores();\n    const selectedTool = canvasStore.canvasMode;\n    const activeObject = objectManagerStore.activeObject;\n\n    return (\n        <React.Fragment>\n            <div className={classes.root}>\n                {!activeObject && <React.Fragment>\n                    {selectedTool === ToolTypes.SELECT && (<SelectPropBox/>)}\n                    {selectedTool === ToolTypes.BRUSH && (<BrushPropBox/>)}\n                    {selectedTool === ToolTypes.SHAPE && (<ShapePropBox/>)}\n                    {selectedTool === ToolTypes.TEXT && (<TextPropBox/>)}\n                    {selectedTool === ToolTypes.CANVAS && (<CanvasPropBox/>)}\n                </React.Fragment>}\n                {activeObject && <React.Fragment>\n                    {objectManagerStore.isPath() && <BrushPropBox/>}\n                    {objectManagerStore.isShape() && <ShapePropBox/>}\n                    {objectManagerStore.isText() && <TextPropBox/>}\n                </React.Fragment>}\n            </div>\n        </React.Fragment>\n    )\n})\n\nexport default PropBox;","import React from \"react\";\nimport {Layout} from \"../layout\";\nimport makeStyles from \"@material-ui/core/styles/makeStyles\";\nimport {ToolBox} from \"../../components/tools\";\nimport {observer} from \"mobx-react\";\nimport {Toolbar} from \"@material-ui/core\";\nimport {useStores} from \"../../hooks/useStores\";\nimport {PropBox} from \"../../components/propbox\";\n\nconst leftMenuWidth = 260;\nconst useStyles = makeStyles((theme) => ({\n    root: {\n        display: \"flex\",\n        flexDirection: \"column\",\n        width: \"100vw\",\n        height: \"100vh\",\n    },\n    flexBox: {\n        display: \"flex\",\n        flex: 1,\n    },\n    contents: {\n        display: \"flex\",\n    },\n    left: {\n        flexBasis: `${leftMenuWidth}px`,\n        backgroundColor: \"#f0f0f0\",\n    },\n    canvasWrapper: {\n        display: \"flex\",\n        justifyContent: \"center\",\n        alignItems: \"center\",\n        flex: 1,\n        backgroundColor: \"#c0c0c0\",\n        padding: theme.spacing(3),\n    },\n}))\n\nconst Canvas = observer(() => {\n    const classes = useStyles();\n    const rootStore = useStores();\n    const canvasRef = React.useRef<HTMLDivElement>(null);\n\n    React.useEffect(() => {\n        if (!canvasRef.current) {\n            return;\n        }\n\n        rootStore.init(canvasRef.current);\n        rootStore.onInit();\n        return () => rootStore.onDestroy();\n    }, [rootStore, canvasRef]);\n\n    return (\n        <Layout>\n            <ToolBox/>\n            <div className={classes.root}>\n                <Toolbar variant={\"dense\"}/>\n                <div className={classes.flexBox}>\n                    <div className={classes.left}>\n                        <PropBox/>\n                    </div>\n                    <div className={classes.canvasWrapper} ref={canvasRef}/>\n                </div>\n            </div>\n        </Layout>\n    )\n})\n\nexport default Canvas;","import { makeAutoObservable } from \"mobx\";\nimport { BrushType } from \"models/tools/Brush\";\nimport { RootStore, Store } from \"./rootStore\";\nimport { fabric } from \"fabric\";\nimport { ObjectManagerStore } from \"./objectManagerStore\";\nimport { CanvasModeManager } from \"./canvasStore\";\nimport { ToolTypes } from \"models/tools/ToolTypes\";\n\nconst defaultStyles = {\n    brushType: BrushType.PENCIL,\n    stroke: \"#000000\",\n    strokeWidth: 1,\n}\n\ninterface PathStyles {\n    stroke: string | undefined,\n    strokeWidth: number | undefined,\n}\n\nexport class BrushStore implements Store, CanvasModeManager {\n    brushType = defaultStyles.brushType;\n    stroke = defaultStyles.stroke;\n    strokeWidth = defaultStyles.strokeWidth;\n    item: fabric.Path | undefined;\n\n    private readonly listeners: any;\n    private readonly canvas: fabric.Canvas;\n    private readonly objectManager: ObjectManagerStore;\n\n    constructor(\n        private readonly rootStore: RootStore,\n    ) {\n        makeAutoObservable(this);\n        rootStore.canvasStore.registerCanvasModeManager(ToolTypes.BRUSH, this);\n        this.canvas = rootStore.canvasStore.canvas;\n        this.objectManager = rootStore.objectManagerStore;\n        this.listeners = {\n            updateObject: this.updateObject.bind(this),\n        }\n    }\n\n    onInit() {\n        this.addReactions();\n    }\n\n    onDestroy() {\n        this.removeReactions();\n    }\n\n    onSessionStart() {\n        this.canvas.isDrawingMode = true;\n        this.setBrushType(this.brushType);\n    }\n\n    onSessionEnd() {\n        this.canvas.isDrawingMode = false;\n    }\n\n    setBrushType(brushType: BrushType) {\n        this.brushType = brushType;\n        this.setFreeDrawingBrush();\n    }\n\n    setStroke(stroke: string | undefined) {\n        this.stroke = stroke || defaultStyles.stroke;\n        this.item?.set(\"stroke\", stroke);\n        this.canvas.freeDrawingBrush.color = this.stroke;\n        this.canvas.renderAll();\n    }\n\n    setStrokeWidth(strokeWidth: number | undefined) {\n        this.strokeWidth = strokeWidth || defaultStyles.strokeWidth;\n        this.item?.set(\"strokeWidth\", strokeWidth);\n        this.canvas.freeDrawingBrush.width = this.strokeWidth;\n        this.canvas.renderAll();\n    }\n\n    private setFreeDrawingBrush() {\n        this.canvas.freeDrawingBrush = this.brushType.getBrush(this.canvas);\n        this.canvas.freeDrawingBrush.color = this.stroke;\n        this.canvas.freeDrawingBrush.width = this.strokeWidth;\n    }\n\n    private updateObject(object: fabric.Object | undefined) {\n        if (this.isBrush(object)) {\n            this.item = object as fabric.Path;\n            this.updatePathStyles();\n        } else {\n            this.item = undefined;\n        }\n    }\n\n    private setPathStyles(styles: PathStyles) {\n        this.setStroke(styles.stroke);\n        this.setStrokeWidth(styles.strokeWidth);\n    }\n\n    private updatePathStyles() {\n        if (!this.item) {\n            return;\n        }\n\n        const {\n            stroke,\n            strokeWidth,\n        } = this.item;\n\n        this.setPathStyles({\n            stroke: stroke,\n            strokeWidth: strokeWidth,\n        })\n    }\n\n    private isBrush(object: fabric.Object | undefined) {\n        return object?.isType(\"path\");\n    }\n\n    private addReactions() {\n        this.objectManager.subscribe(this.listeners.updateObject);\n    }\n\n    private removeReactions() {\n        this.objectManager.unsubscribe(this.listeners.updateObject);\n    }\n}","import {makeAutoObservable} from \"mobx\";\nimport {ToolTypes} from \"models/tools/ToolTypes\";\nimport {RootStore, Store} from \"./rootStore\";\nimport {fabric} from \"fabric\";\n\nconst defaultStyles = {\n    width: 500,\n    height: 500,\n    backgroundColor: \"#ffffff\",\n}\n\nexport interface CanvasModeManager {\n    onSessionStart: () => void;\n    onSessionEnd: () => void;\n}\n\nexport class CanvasStore implements Store {\n    private readonly canvasModeManagers: Map<ToolTypes, CanvasModeManager> = new Map();\n\n    width = defaultStyles.width;\n    height = defaultStyles.height;\n    backgroundColor = defaultStyles.backgroundColor;\n    canvasMode = ToolTypes.CANVAS;\n\n    constructor(\n        private readonly rootStore: RootStore,\n        readonly canvas: fabric.Canvas,\n    ) {\n        makeAutoObservable(this);\n    }\n\n    onInit() {\n        this.canvas.setWidth(this.width);\n        this.canvas.setHeight(this.height);\n        this.canvas.setBackgroundColor(this.backgroundColor, () => {});\n        this.setCanvasMode(this.canvasMode);\n    }\n\n    onDestroy() {\n        this.canvas.dispose();\n    }\n\n    registerCanvasModeManager(mode: ToolTypes, manager: CanvasModeManager) {\n        this.canvasModeManagers.set(mode, manager);\n    }\n\n    setCanvasMode(mode: ToolTypes) {\n        const previousMode = this.canvasMode;\n        this.canvasMode = mode;\n\n        this.canvas.discardActiveObject().renderAll();\n        this.setAllCursor(\"default\");\n        this.setSelectable(false)\n\n        this.canvasModeManagers.get(previousMode)?.onSessionEnd();\n        this.canvasModeManagers.get(mode)?.onSessionStart();\n    }\n\n    setSelectable(selectable: boolean) {\n        this.canvas.selection = selectable;\n        this.canvas.getObjects().forEach(obj => {\n            obj.selectable = selectable;\n        });\n    }\n\n    setDefaultCursor(cursor: string) {\n        this.canvas.defaultCursor = cursor;\n    }\n\n    setHoverCursor(cursor: string) {\n        this.canvas.getObjects().forEach(obj => {\n            obj.hoverCursor = cursor;\n        });\n    }\n\n    setAllCursor(cursor: string) {\n        this.setDefaultCursor(cursor);\n        this.setHoverCursor(cursor);\n    }\n\n    setWidth(width: number) {\n        this.width = width;\n        this.canvas.setWidth(width);\n    }\n\n    setHeight(height: number) {\n        this.height = height;\n        this.canvas.setHeight(height);\n    }\n\n    setBackgroundColor(color: string) {\n        this.backgroundColor = color;\n        this.canvas.setBackgroundColor(color, () => {});\n    }\n}","const deleteIcon = \"data:image/svg+xml,%3C%3Fxml version='1.0' encoding='utf-8'%3F%3E%3C!DOCTYPE svg PUBLIC '-//W3C//DTD SVG 1.1//EN' 'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd'%3E%3Csvg version='1.1' id='Ebene_1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' width='595.275px' height='595.275px' viewBox='200 215 230 470' xml:space='preserve'%3E%3Ccircle style='fill:%23F44336;' cx='299.76' cy='439.067' r='218.516'/%3E%3Cg%3E%3Crect x='267.162' y='307.978' transform='matrix(0.7071 -0.7071 0.7071 0.7071 -222.6202 340.6915)' style='fill:white;' width='65.545' height='262.18'/%3E%3Crect x='266.988' y='308.153' transform='matrix(0.7071 0.7071 -0.7071 0.7071 398.3889 -83.3116)' style='fill:white;' width='65.544' height='262.179'/%3E%3C/g%3E%3C/svg%3E\";\n\nexport const DeleteImageElement = document.createElement('img');\nDeleteImageElement.src = deleteIcon;","import {fabric} from \"fabric\";\nimport {DeleteImageElement} from \"../../components/element/DeleteImageElement\";\n\ntype DeleteAction = (eventData: MouseEvent, transformData: fabric.Transform, x: number, y: number) => boolean;\n\nexport class DeleteControl {\n    public static init(deleteAction: DeleteAction) {\n        fabric.Object.prototype.controls.deleteControl = new fabric.Control({\n            x: 0.5,\n            y: -0.5,\n            offsetY: -16,\n            offsetX: 16,\n            cursorStyle: 'pointer',\n            mouseUpHandler: deleteAction,\n            render: this.renderIcon(DeleteImageElement),\n        })\n    }\n\n    private static renderIcon(icon: CanvasImageSource) {\n        return (ctx: CanvasRenderingContext2D, left: number, top: number, styleOverride: any, fabricObject: fabric.Object) => {\n            const size = fabricObject.cornerSize;\n            if (size) {\n                ctx.save();\n                ctx.translate(left, top);\n                ctx.rotate(fabric.util.degreesToRadians(fabricObject.angle || 0));\n                ctx.drawImage(icon, -size / 2, -size / 2, size, size);\n                ctx.restore();\n            }\n        };\n    }\n}","import {IEvent, Transform} from \"fabric/fabric-impl\";\nimport { makeAutoObservable, reaction } from \"mobx\";\nimport { ShapeType } from \"models/tools/Shape\";\nimport { CanvasStore } from \"./canvasStore\";\nimport { RootStore } from \"./rootStore\";\nimport {fabric} from \"fabric\";\nimport {DeleteControl} from \"../models/object/DeleteControl\";\n\nexport enum SelectionEventType {\n    SELECTION_CLEARED = \"selection:cleared\",\n    SELECTION_CREATED = \"selection:created\",\n    SELECTION_UPDATED = \"selection:updated\",\n}\n\nexport class ObjectManagerStore {\n    private readonly canvasStore: CanvasStore;\n    private readonly listeners: { [eventName: string]: (e: IEvent) => void }\n    private readonly observer: Set<(object: fabric.Object | undefined) => void> = new Set();\n\n    activeObject: fabric.Object | undefined;\n\n    constructor(\n        private readonly rootStore: RootStore,\n    ) {\n        makeAutoObservable(this);\n        this.canvasStore = rootStore.canvasStore;\n        this.listeners = {\n            onSelected: this.onSelected.bind(this),\n            onCleared: this.onCleared.bind(this),\n        }\n        this.addEventListeners();\n        this.initControl();\n    }\n\n    private onSelected(e: IEvent) {\n        const { target } = e;\n        if (!target) {\n            return;\n        }\n\n        this.activeObject = target;\n    }\n\n    private onCleared() {\n        this.activeObject = undefined;\n    }\n\n    private addEventListeners() {\n        this.canvasStore.canvas.on(SelectionEventType.SELECTION_CREATED, this.listeners.onSelected);\n        this.canvasStore.canvas.on(SelectionEventType.SELECTION_UPDATED, this.listeners.onSelected);\n        this.canvasStore.canvas.on(SelectionEventType.SELECTION_CLEARED, this.listeners.onCleared);\n        reaction(\n            () => this.activeObject,\n            () => this.observer.forEach(callback => callback(this.activeObject)),\n        );\n    }\n\n    private initControl() {\n        DeleteControl.init(this.removeActiveObjects);\n    }\n\n    private removeActiveObjects(_eventData: MouseEvent, transform: Transform): boolean {\n        const canvas = transform.target.canvas;\n        if (!canvas) {\n            return false;\n        }\n\n        const activeObjects = canvas.getActiveObjects();\n        if (activeObjects.length === 0) {\n            return false;\n        }\n\n        canvas.getActiveObjects().forEach(object => canvas.remove(object));\n        canvas.discardActiveObject();\n        canvas.requestRenderAll();\n        return true;\n    }\n\n    subscribe(listener: (object: fabric.Object | undefined) => void) {\n        this.observer.add(listener);\n    }\n\n    unsubscribe(listener: (object: fabric.Object | undefined) => void) {\n        this.observer.delete(listener);\n    }\n\n    isRect() {\n        return this.activeObject?.isType(ShapeType.RECT.value);\n    }\n\n    isEllipse() {\n        return this.activeObject?.isType(ShapeType.ELLIPSE.value);\n    }\n\n    isTriangle() {\n        return this.activeObject?.isType(ShapeType.TRIANGLE.value);\n    }\n\n    isShape() {\n        return this.isRect() || this.isEllipse() || this.isTriangle();\n    }\n\n    isPath() {\n        return this.activeObject?.isType(\"path\");\n    }\n\n    isText() {\n        return this.activeObject?.isType(\"i-text\");\n    }\n\n    isActiveSelection() {\n        return this.activeObject?.isType(\"activeSelection\");\n    }\n\n    isGroup() {\n        return this.activeObject?.isType(\"group\");\n    }\n\n    isCommonObject() {\n        return !this.isShape() && !this.isPath() && !this.isText();\n    }\n\n    getObjectTypeName(): string {\n        if (this.isRect()) {\n            return ShapeType.RECT.display;\n        } else if (this.isEllipse()) {\n            return ShapeType.ELLIPSE.display;\n        } else if (this.isTriangle()) {\n            return ShapeType.TRIANGLE.display;\n        } else if (this.isPath()) {\n            return \"패스\";\n        } else if (this.isText()) {\n            return \"텍스트\";\n        } else if (this.isGroup()) {\n            return \"그룹\"\n        } else {\n            return \"오브젝트\";\n        }\n    }\n}","import { IEvent } from \"fabric/fabric-impl\";\nimport { RootStore, Store } from \"./rootStore\";\n\nexport enum ObjectEventType {\n    OBJECT_SCALING = \"object:scaling\",\n    OBJECT_MODIFIED = \"object:modified\",\n}\n\nexport class ObjectEventStore implements Store {\n    private readonly listeners: any;\n    private readonly observer: Map<ObjectEventType, Set<(e: IEvent) => void>> = new Map();\n\n    constructor(private readonly rootStore: RootStore) {\n        this.listeners = {\n            onScaling: this.onScaling.bind(this),\n            onModified: this.onModified.bind(this),\n        }\n    }\n\n    onInit() {\n        this.addEventListener();\n    }\n\n    onDestroy() {\n        this.removeEventListener();\n    }\n\n    private addEventListener() {\n        const {canvas} = this.rootStore.canvasStore;\n        canvas.on(ObjectEventType.OBJECT_SCALING, this.listeners.onScaling);\n        canvas.on(ObjectEventType.OBJECT_MODIFIED, this.listeners.onModified);\n    }\n\n    private removeEventListener() {\n        const {canvas} = this.rootStore.canvasStore;\n        canvas.off(ObjectEventType.OBJECT_SCALING, this.listeners.onScaling);\n        canvas.off(ObjectEventType.OBJECT_MODIFIED, this.listeners.onModified);\n    }\n\n    private onScaling(e: IEvent) {\n        this.observer.get(ObjectEventType.OBJECT_SCALING)?.forEach(callbackFn => callbackFn(e));\n    }\n\n    private onModified(e: IEvent) {\n        this.observer.get(ObjectEventType.OBJECT_MODIFIED)?.forEach(callbackFn => callbackFn(e));\n    }\n\n    subscribe(eventType: ObjectEventType, listener: (e: IEvent) => void) {\n        if (!this.observer.has(eventType)) {\n            this.observer.set(eventType, new Set());\n        }\n\n        this.observer.get(eventType)?.add(listener);\n    }\n\n    unsubscribe(eventType: ObjectEventType, listener: (e: IEvent) => void) {\n        this.observer.get(eventType)?.delete(listener);\n    }\n}\n\nexport default ObjectEventStore;","import { makeAutoObservable } from \"mobx\";\nimport { ShapeType } from \"models/tools/Shape\";\nimport { ToolTypes } from \"models/tools/ToolTypes\";\nimport { CanvasModeManager } from \"./canvasStore\";\nimport { MouseEventObject, MouseEventStore, MouseEventType } from \"./mouseEventStore\";\nimport { ObjectManagerStore } from \"./objectManagerStore\";\nimport { RootStore, Store } from \"./rootStore\";\nimport {fabric} from \"fabric\";\n\nconst defaultStyles = {\n    shapeType: ShapeType.ELLIPSE,\n    fill: undefined,\n    strokeWidth: 3,\n    stroke: \"#000000\",\n}\n\ninterface ShapeStyles {\n    fill: string | undefined;\n    strokeWidth: number;\n    stroke: string | undefined;\n}\n\nexport class ShapeStore implements Store, CanvasModeManager {\n    private static readonly MIN_OBJECT_SIZE = 30;\n    private readonly canvas: fabric.Canvas;\n    private readonly mouseEventStore: MouseEventStore;\n    private readonly objectManager: ObjectManagerStore;\n    private readonly listeners: any;\n    private isDragMode = false;\n\n    item: fabric.Rect | fabric.Triangle | fabric.Ellipse | undefined;\n    shapeType = defaultStyles.shapeType;\n    fill: string | undefined = defaultStyles.fill;\n    strokeWidth = defaultStyles.strokeWidth;\n    stroke: string | undefined = defaultStyles.stroke;\n\n    constructor(private readonly rootStore: RootStore) {\n        makeAutoObservable(this);\n        rootStore.canvasStore.registerCanvasModeManager(ToolTypes.SHAPE, this);\n        this.canvas = rootStore.canvasStore.canvas;\n        this.mouseEventStore = rootStore.mouseEventStore;\n        this.objectManager = rootStore.objectManagerStore;\n        this.listeners = {\n            onMouseUp: this.onMouseUp.bind(this),\n            onMouseDown: this.onMouseDown.bind(this),\n            onMouseMove: this.onMouseMove.bind(this),\n            updateObject: this.updateObject.bind(this),\n        }\n    }\n\n    onInit() {\n        this.addEventListeners();\n        this.addReactions();\n    }\n\n    onDestroy() {\n        this.removeEventListener();\n        this.removeReactions();\n    }\n\n    onSessionStart() {\n        this.rootStore.canvasStore.setAllCursor(\"crosshair\");\n    }\n\n    onSessionEnd() {\n        //\n    }\n\n    setShapeType(shapeType: ShapeType) {\n        this.shapeType = shapeType;\n    }\n\n    setFill(fill: string | undefined) {\n        this.fill = fill;\n        if (this.item) {\n            this.item.set({ fill: fill });\n            this.canvas.renderAll();\n        }\n    }\n\n    setStroke(stroke: string | undefined) {\n        this.stroke = stroke;\n        if (this.item) {\n            this.item.set({ stroke: stroke });\n            this.canvas.renderAll();\n        }\n    }\n\n    setStrokeWidth(strokeWidth: number) {\n        this.strokeWidth = strokeWidth;\n        if (this.item) {\n            this.item.set({ strokeWidth: strokeWidth });\n            this.canvas.renderAll();\n        }\n    }\n\n    private addReactions() {\n        this.objectManager.subscribe(this.listeners.updateObject);\n    }\n\n    private removeReactions() {\n        this.objectManager.unsubscribe(this.listeners.updateObject);\n    }\n\n    private updateObject(object: fabric.Object | undefined) {\n        if (this.isShape(object)) {\n            this.item = object;\n            this.updateShapeStyles();\n        } else {\n            this.item = undefined;\n        }\n    }\n\n    private setShapeStyles(styles: ShapeStyles) {\n        this.setFill(styles.fill);\n        this.setStroke(styles.stroke);\n        this.setStrokeWidth(styles.strokeWidth);\n    }\n\n    private updateShapeStyles() {\n        if (!this.item) {\n            return;\n        }\n\n        const {\n            stroke,\n            strokeWidth,\n            fill,\n        } = this.item;\n\n        this.setShapeStyles({\n            fill: fill === undefined ? fill : fill as string,\n            stroke: stroke,\n            strokeWidth: strokeWidth || defaultStyles.strokeWidth,\n        })\n    }\n\n    private addEventListeners() {\n        this.mouseEventStore.subscribe(MouseEventType.MOUSE_UP, this.listeners.onMouseUp);\n        this.mouseEventStore.subscribe(MouseEventType.MOUSE_DOWN, this.listeners.onMouseDown);\n        this.mouseEventStore.subscribe(MouseEventType.MOUSE_MOVE, this.listeners.onMouseMove);\n    }\n\n    private removeEventListener() {\n        this.mouseEventStore.unsubscribe(MouseEventType.MOUSE_UP, this.listeners.onMouseUp);\n        this.mouseEventStore.unsubscribe(MouseEventType.MOUSE_DOWN, this.listeners.onMouseDown);\n        this.mouseEventStore.unsubscribe(MouseEventType.MOUSE_MOVE, this.listeners.onMouseMove);\n    }\n\n    private isShapeTool() {\n        return this.rootStore.canvasStore.canvasMode === ToolTypes.SHAPE;\n    }\n\n    private isShape(object: fabric.Object | undefined) {\n        return object?.isType(ShapeType.ELLIPSE.value) || object?.isType(ShapeType.RECT.value) || object?.isType(ShapeType.TRIANGLE.value);\n    }\n\n    private onMouseDown(e: MouseEventObject) {\n        if (!this.isShapeTool()) {\n            return;\n        }\n\n        this.isDragMode = true;\n        this.item = this.shapeType.getShape({\n            left: e.startCursorPosition.x,\n            top: e.startCursorPosition.y,\n            stroke: this.stroke,\n            strokeWidth: this.strokeWidth,\n            fill: this.fill,\n            selectable: false,\n            hoverCursor: \"default\",\n            strokeUniform: true,\n        });\n\n        if (this.item.isType(ShapeType.RECT.value) || this.item.isType(ShapeType.TRIANGLE.value)) {\n            this.item.set({\n                width: 0,\n                height: 0,\n            })\n        } else if (this.item.isType(ShapeType.ELLIPSE.value)) {\n            (this.item as fabric.Ellipse).set({\n                rx: 0,\n                ry: 0,\n            })\n        }\n\n        this.rootStore.canvasStore.canvas.add(this.item);\n    }\n\n    private onMouseMove(e: MouseEventObject) {\n        if (!this.isShapeTool() || !this.isDragMode || !this.item) {\n            return;\n        }\n\n        if (e.currentCursorPosition.x < e.startCursorPosition.x) {\n            this.item.set({ left: Math.abs(e.currentCursorPosition.x) });\n        }\n\n        if (e.currentCursorPosition.y < e.startCursorPosition.y) {\n            this.item.set({ top: Math.abs(e.currentCursorPosition.y) });\n        }\n\n        this.item.set({ flipX: e.currentCursorPosition.x < e.startCursorPosition.x });\n        this.item.set({ flipY: e.currentCursorPosition.y < e.startCursorPosition.y });\n\n        if (this.item.isType(ShapeType.RECT.value) || this.item.isType(ShapeType.TRIANGLE.value)) {\n            this.item.set({\n                width: Math.abs(e.startCursorPosition.x - e.currentCursorPosition.x),\n                height: Math.abs(e.startCursorPosition.y - e.currentCursorPosition.y),\n            });\n        } else if (this.item.isType(ShapeType.ELLIPSE.value)) {\n            (this.item as fabric.Ellipse).set({\n                rx: Math.abs(e.startCursorPosition.x - e.currentCursorPosition.x) / 2,\n                ry: Math.abs(e.startCursorPosition.y - e.currentCursorPosition.y) / 2,\n            })\n        }\n\n        this.rootStore.canvasStore.canvas.renderAll();\n    }\n\n    private onMouseUp(e: MouseEventObject) {\n        if (!this.isShapeTool() || !this.item) {\n            return;\n        }\n\n        this.isDragMode = false;\n        if (this.item.isType(ShapeType.RECT.value) || this.item.isType(ShapeType.TRIANGLE.value)) {\n            this.item.set({\n                width: Math.max(ShapeStore.MIN_OBJECT_SIZE, this.item.width || ShapeStore.MIN_OBJECT_SIZE),\n                height: Math.max(ShapeStore.MIN_OBJECT_SIZE, this.item.height || ShapeStore.MIN_OBJECT_SIZE),\n            }).setCoords();\n        } else if (this.item.isType(ShapeType.ELLIPSE.value)) {\n            const circle = this.item as fabric.Ellipse;\n            circle.set({\n                rx: Math.max(ShapeStore.MIN_OBJECT_SIZE / 2, circle.rx || ShapeStore.MIN_OBJECT_SIZE / 2),\n                ry: Math.max(ShapeStore.MIN_OBJECT_SIZE / 2, circle.ry || ShapeStore.MIN_OBJECT_SIZE / 2),\n            }).setCoords();\n        }\n\n        const canvasStore = this.rootStore.canvasStore;\n        canvasStore.setCanvasMode(ToolTypes.SELECT);\n        canvasStore.canvas.setActiveObject(this.item);\n        canvasStore.canvas.renderAll();\n\n        this.item = undefined;\n    }\n}","import { makeAutoObservable } from \"mobx\";\nimport { RootStore } from \"./rootStore\";\n\nexport class UIStore {\n    constructor(private readonly rootStore: RootStore) {\n        makeAutoObservable(this);;\n    }\n}","import { MouseEventObject, MouseEventStore, MouseEventType } from \"./mouseEventStore\";\nimport { RootStore, Store } from \"./rootStore\";\nimport { fabric } from \"fabric\";\nimport { ToolTypes } from \"models/tools/ToolTypes\";\nimport { ObjectEventStore, ObjectEventType } from \"./objectEventStore\";\nimport { IEvent } from \"fabric/fabric-impl\";\nimport { ObjectManagerStore } from \"./objectManagerStore\";\nimport { makeAutoObservable } from \"mobx\";\nimport { FontFaces, fontSizes, FontStyle, FontWeight, TextAlign } from \"models/tools/Text\";\nimport WebFont from \"webfontloader\";\nimport { CanvasModeManager } from \"./canvasStore\";\n\nconst defaultStyles = {\n    FONT_SIZE: fontSizes[fontSizes.length / 2],\n    FILL: \"#000000\",\n    FONT_FAMILY: FontFaces.TIMES_NEW_ROMAN.value,\n    TEXT_ALIGN: TextAlign.LEFT,\n    FONT_STYLE: FontStyle.NORMAL,\n    FONT_WEIGHT: FontWeight.NORMAL,\n    UNDERLINE: false,\n}\n\ninterface TextStyles {\n    fontSize: number,\n    fill: string,\n    fontFamily: string,\n    textAlign: string,\n    fontStyle: string,\n    fontWeight: string | number,\n    underline: boolean,\n}\n\nexport class TextStore implements Store, CanvasModeManager {\n    private readonly objectManager: ObjectManagerStore;\n    private readonly mouseEventStore: MouseEventStore;\n    private readonly objectEventStore: ObjectEventStore;\n    private readonly canvas: fabric.Canvas;\n    private readonly listeners: any;\n    private fontStyle = defaultStyles.FONT_STYLE;\n    private fontWeight = defaultStyles.FONT_WEIGHT;\n    private autoRenderId: NodeJS.Timeout | undefined;\n\n    fontSize = defaultStyles.FONT_SIZE;\n    fill = defaultStyles.FILL;\n    fontFamily = defaultStyles.FONT_FAMILY;\n    textAlign = defaultStyles.TEXT_ALIGN;\n    underline = defaultStyles.UNDERLINE;\n    item: fabric.IText | undefined;\n\n    constructor(private readonly rootStore: RootStore) {\n        makeAutoObservable(this);\n        rootStore.canvasStore.registerCanvasModeManager(ToolTypes.TEXT, this);\n        this.loadFont();\n        this.objectManager = rootStore.objectManagerStore;\n        this.mouseEventStore = rootStore.mouseEventStore;\n        this.objectEventStore = rootStore.objectEventStore;\n        this.canvas = rootStore.canvasStore.canvas;\n        this.listeners = {\n            onMouseUp: this.onMouseUp.bind(this),\n            onModified: this.onModified.bind(this),\n            updateObject: this.updateObject.bind(this),\n        }\n    }\n\n    onInit() {\n        this.addEventListener();\n        this.addFontAutoRender();\n    }\n\n    onDestroy() {\n        this.removeEventListener();\n        this.removeFontAutoRender();\n    }\n\n    onSessionStart() {\n        this.rootStore.canvasStore.setAllCursor(\"text\");\n    }\n\n    onSessionEnd() {\n        //\n    }\n\n    setFontSize(fontSize: number) {\n        this.fontSize = fontSize;\n        if (this.item) {\n            this.item.set({ fontSize: fontSize });\n            this.canvas.renderAll();\n        }\n    }\n\n    setFill(fill: string) {\n        this.fill = fill;\n        if (this.item) {\n            this.item.set({ fill: fill });\n            this.canvas.renderAll();\n        }\n    }\n\n    setFontFamily(fontFamily: string) {\n        this.fontFamily = fontFamily;\n        if (this.item) {\n            this.item.set({ fontFamily: fontFamily });\n            this.canvas.renderAll();\n        }\n    }\n\n    setTextAlign(textAlign: string) {\n        this.textAlign = textAlign;\n        if (this.item) {\n            this.item.set({ textAlign: textAlign });\n            this.canvas.renderAll();\n        }\n    }\n\n    setUnderline(underline: boolean) {\n        this.underline = underline;\n        if (this.item) {\n            this.item.set({ underline: underline });\n            this.canvas.renderAll();\n        }\n    }\n\n    setBold(bold: boolean) {\n        const changedValue = bold ? FontWeight.BOLD : FontWeight.NORMAL;\n        this.fontWeight = changedValue;\n        if (this.item) {\n            this.item.set({ fontWeight: changedValue });\n            this.canvas.renderAll();\n        }\n    }\n\n    isBold() {\n        return this.fontWeight === FontWeight.BOLD;\n    }\n\n    setItalic(italic: boolean) {\n        const changedValue = italic ? FontStyle.ITALIC : FontStyle.NORMAL;\n        this.fontStyle = changedValue;\n        if (this.item) {\n            this.item.set({ fontStyle: changedValue as any });\n            this.canvas.renderAll();\n        }\n    }\n\n    isItalic() {\n        return this.fontStyle === FontStyle.ITALIC;\n    }\n\n    private addEventListener() {\n        this.mouseEventStore.subscribe(MouseEventType.MOUSE_UP, this.listeners.onMouseUp);\n        this.objectEventStore.subscribe(ObjectEventType.OBJECT_MODIFIED, this.listeners.onModified);\n        this.objectManager.subscribe(this.listeners.updateObject);\n    }\n\n    private removeEventListener() {\n        this.mouseEventStore.unsubscribe(MouseEventType.MOUSE_UP, this.listeners.onMouseUp);\n        this.objectEventStore.unsubscribe(ObjectEventType.OBJECT_MODIFIED, this.listeners.onModified);\n        this.objectManager.unsubscribe(this.listeners.updateObject);\n    }\n\n    private updateObject(object: fabric.Object | undefined) {\n        if (object && this.isText(object)) {\n            this.item = object as fabric.IText;\n            this.updateTextStyles();\n        } else {\n            this.item = undefined;\n        }\n    }\n\n    private updateTextStyles() {\n        if (!this.item) {\n            return;\n        }\n\n        const {\n            fontSize,\n            fill,\n            fontFamily,\n            textAlign,\n            fontStyle,\n            fontWeight,\n            underline,\n        } = this.item;\n\n        this.setTextStyles({\n            fontSize: fontSize || defaultStyles.FONT_SIZE,\n            fill: !fill ? defaultStyles.FILL : fill as string,\n            fontFamily: fontFamily || defaultStyles.FONT_FAMILY,\n            textAlign: textAlign || defaultStyles.TEXT_ALIGN,\n            fontStyle: fontStyle || defaultStyles.FONT_STYLE,\n            fontWeight: fontWeight || defaultStyles.FONT_WEIGHT,\n            underline: !!underline,\n        })\n    }\n\n    private setTextStyles(styles: TextStyles) {\n        this.setFontSize(styles.fontSize);\n        this.setFill(styles.fill);\n        this.setFontFamily(styles.fontFamily);\n        this.setTextAlign(styles.textAlign);\n    }\n\n    private onMouseUp(e: MouseEventObject) {\n        if (!this.isTextTool()) {\n            return;\n        }\n\n        this.item = new fabric.IText(\"텍스트를 입력해주세요\", {\n            top: e.currentCursorPosition.y,\n            left: e.currentCursorPosition.x,\n            fontFamily: this.fontFamily,\n            fontSize: this.fontSize,\n            textAlign: this.textAlign,\n            lockUniScaling: true,\n            fill: this.fill,\n        });\n\n        this.item.setControlVisible(\"mt\", false);\n        this.item.setControlVisible(\"mb\", false);\n        this.item.setControlVisible(\"ml\", false);\n        this.item.setControlVisible(\"mr\", false);\n\n        const canvasStore = this.rootStore.canvasStore;\n        canvasStore.canvas.add(this.item);\n        canvasStore.setCanvasMode(ToolTypes.SELECT);\n        canvasStore.canvas.setActiveObject(this.item);\n\n        this.item.selectAll();\n        this.item.enterEditing();\n    }\n\n    private onModified(e: IEvent) {\n        const { target } = e;\n        if (!target || !this.isText(target)) {\n            return;\n        }\n\n        const text = target as fabric.IText;\n        const fontSize = parseInt(((text.fontSize || defaultStyles.FONT_SIZE) * (text.scaleX || 1)).toFixed(0), 10);\n        text.set({\n            scaleX: 1,\n            scaleY: 1,\n        });\n        this.setFontSize(fontSize);\n    }\n\n    private isTextTool() {\n        return this.rootStore.canvasStore.canvasMode === ToolTypes.TEXT;\n    }\n\n    private isText(object: fabric.Object) {\n        return object.isType(\"i-text\");\n    }\n\n    private loadFont() {\n        WebFont.load({\n            google: {\n                families: FontFaces.getGoogleFonts().map(font => font.value),\n            },\n        })\n    }\n\n    private addFontAutoRender() {\n        this.autoRenderId = setInterval(() => {\n            this.canvas.getActiveObjects()\n                .filter(object => this.isText(object))\n                .forEach((object) => {\n                    const textObject = object as fabric.IText;\n                    textObject.initDimensions();\n                    textObject.dirty = true;\n                });\n            fabric.util.clearFabricFontCache();\n            this.canvas.renderAll();\n        }, 1000);\n    }\n\n    private removeFontAutoRender() {\n        if (this.autoRenderId) {\n            clearInterval(this.autoRenderId);\n        }\n    }\n}","import { ToolTypes } from \"models/tools/ToolTypes\";\nimport { CanvasModeManager } from \"./canvasStore\";\nimport { RootStore } from \"./rootStore\";\n\nexport class SelectStore implements CanvasModeManager {\n    constructor(private readonly rootStore: RootStore) {\n        rootStore.canvasStore.registerCanvasModeManager(ToolTypes.SELECT, this);\n    }\n\n    onSessionStart() {\n        this.rootStore.canvasStore.setSelectable(true);\n        this.rootStore.canvasStore.setHoverCursor(\"move\");\n    }\n\n    onSessionEnd() {\n        //\n    }\n}","import { fabric } from \"fabric\";\nimport { BrushStore } from \"./brushStore\";\nimport { CanvasStore } from \"./canvasStore\";\nimport { MouseEventStore } from \"./mouseEventStore\";\nimport { ObjectManagerStore } from \"./objectManagerStore\";\nimport { ObjectEventStore } from \"./objectEventStore\";\nimport { ShapeStore } from \"./shapeStore\";\nimport { UIStore } from \"./UIStore\";\nimport { TextStore } from \"./textStore\";\nimport { SelectStore } from \"./selectStore\";\n\nexport interface Store {\n    onInit: () => void;\n    onDestroy: () => void;\n}\n\nexport class RootStore implements Store {\n    private readonly canvasElement: HTMLCanvasElement;\n    canvasStore: CanvasStore;\n    objectManagerStore: ObjectManagerStore;\n    objectEventStore: ObjectEventStore;\n    mouseEventStore: MouseEventStore;\n\n    brushStore: BrushStore;\n    shapeStore: ShapeStore;\n    textStore: TextStore;\n    selectStore: SelectStore;\n    UIStore: UIStore;\n\n    constructor() {\n        this.canvasElement = document.createElement(\"canvas\");\n        document.body.append(this.canvasElement);\n\n        this.canvasStore = new CanvasStore(this, new fabric.Canvas(this.canvasElement));\n        this.objectManagerStore = new ObjectManagerStore(this);\n        this.objectEventStore = new ObjectEventStore(this);\n        this.mouseEventStore = new MouseEventStore(this);\n\n        this.brushStore = new BrushStore(this);\n        this.shapeStore = new ShapeStore(this);\n        this.textStore = new TextStore(this);\n        this.selectStore = new SelectStore(this);\n        this.UIStore = new UIStore(this);\n    }\n\n    onInit() {\n        Object.values(this).forEach(obj => {\n            if (obj.onInit) {\n                obj.onInit();\n            }\n        });\n    }\n\n    onDestroy() {\n        Object.values(this).forEach(obj => {\n            if (obj.onDestory) {\n                obj.onDestory();\n            }\n        });\n    }\n\n    init(container: HTMLElement): void {\n        container.append(this.canvasElement.parentElement!);\n    }\n}\n\nexport default new RootStore();","import {Canvas} from 'templates/canvas';\nimport React from 'react';\nimport {StoreProvider} from \"./contexts/storeContext\";\nimport rootStore from \"./stores/rootStore\";\nimport {CssBaseline} from \"@material-ui/core\";\n\nconst App = () => {\n    React.useEffect(() => {\n        document.title = \"캔버스\";\n    }, []);\n\n    return (\n        <React.Fragment>\n            <CssBaseline />\n            <StoreProvider value={rootStore}>\n                <Canvas/>\n            </StoreProvider>\n        </React.Fragment>\n    );\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './App';\n\nReactDOM.render(\n    <App/>,\n    document.getElementById('root')\n);"],"sourceRoot":""}