(this.webpackJsonpcanvas=this.webpackJsonpcanvas||[]).push([[0],{153:function(e,t){},154:function(e,t){},155:function(e,t){},158:function(e,t,n){"use strict";n.r(t);var a,c=n(2),s=n(0),r=n.n(s),i=n(12),o=n.n(i),u=n(188),l=n(189),h=n(21),j=n.n(h),b=j()((function(){return{progressWrapper:{display:"flex",justifyContent:"center",alignItems:"center"}}})),v=function(e){var t=e.loading,n=e.children,a=b();return Object(c.jsxs)(r.a.Fragment,{children:[Object(c.jsx)(u.a,{}),Object(c.jsx)("div",{children:t?Object(c.jsx)("div",{className:a.progressWrapper,children:Object(c.jsx)(l.a,{})}):n})]})},d=n(77),f=n(5),O=j()((function(e){return{button:{display:"inline-block",cursor:"pointer",color:"#fff",paddingTop:e.spacing(.5),paddingBottom:e.spacing(.5),paddingRight:e.spacing(3),paddingLeft:e.spacing(3),textAlign:"center"},caption:{fontSize:"0.70rem"},selected:{background:"linear-gradient(90deg, rgba(172,118,255,1) 0%, rgba(91,91,255,1) 100%)"}}})),p=function(e){var t=e.icon,n=e.text,a=e.onClick,s=e.selected,r=O();return Object(c.jsxs)("div",{className:Object(f.a)(r.button,Object(d.a)({},r.selected,s)),onClick:a,children:[t,Object(c.jsx)("div",{className:r.caption,children:n})]})},x=n(192),y=n(193),C=n(24),g=n(9),S=n(10),T=n(13),E=n(19);!function(e){e[e.SELECT=0]="SELECT",e[e.BRUSH=1]="BRUSH",e[e.SHAPE=2]="SHAPE",e[e.TEXT=3]="TEXT",e[e.CANVAS=4]="CANVAS"}(a||(a={}));var k=n(38),w=n(37),m=function(){function e(t){Object(g.a)(this,e),this.canvasStore=t}return Object(S.a)(e,[{key:"resetCanvas",value:function(){this.canvasStore.canvas.isDrawingMode=!1,this.canvasStore.selectable=!1,this.canvasStore.canvas.defaultCursor="default",this.canvasStore.canvas.discardActiveObject().renderAll()}},{key:"select",value:function(){this.resetCanvas(),this.setTool()}}]),e}(),P=function(){function e(){Object(g.a)(this,e)}return Object(S.a)(e,null,[{key:"getInstance",value:function(e){switch(e.selectedTool){case a.SELECT:return new _(e);case a.BRUSH:return new L(e);case a.SHAPE:return new I(e);case a.TEXT:return new A(e);case a.CANVAS:return new N(e);default:return new R(e)}}}]),e}(),_=function(e){Object(k.a)(n,e);var t=Object(w.a)(n);function n(){return Object(g.a)(this,n),t.apply(this,arguments)}return Object(S.a)(n,[{key:"setTool",value:function(){this.canvasStore.selectable=!0}}]),n}(m),L=function(e){Object(k.a)(n,e);var t=Object(w.a)(n);function n(){return Object(g.a)(this,n),t.apply(this,arguments)}return Object(S.a)(n,[{key:"setTool",value:function(){this.canvasStore.canvas.isDrawingMode=!0}}]),n}(m),I=function(e){Object(k.a)(n,e);var t=Object(w.a)(n);function n(){return Object(g.a)(this,n),t.apply(this,arguments)}return Object(S.a)(n,[{key:"setTool",value:function(){this.canvasStore.canvas.defaultCursor="crosshair"}}]),n}(m),A=function(e){Object(k.a)(n,e);var t=Object(w.a)(n);function n(){return Object(g.a)(this,n),t.apply(this,arguments)}return Object(S.a)(n,[{key:"setTool",value:function(){this.canvasStore.canvas.defaultCursor="text"}}]),n}(m),N=function(e){Object(k.a)(n,e);var t=Object(w.a)(n);function n(){return Object(g.a)(this,n),t.apply(this,arguments)}return Object(S.a)(n,[{key:"setTool",value:function(){this.canvasStore.canvas.add(new E.fabric.ActiveSelection([],{width:this.canvasStore.canvas.width,height:this.canvasStore.canvas.height,type:"canvas-resize",backgroundColor:"rgba(0,0,0,0.7)",hasBorders:!1,cornerColor:"grey"}))}}]),n}(m),R=function(e){Object(k.a)(n,e);var t=Object(w.a)(n);function n(){return Object(g.a)(this,n),t.apply(this,arguments)}return Object(S.a)(n,[{key:"setTool",value:function(){}}]),n}(m),M=n(48),B=function(){function e(t,n){Object(g.a)(this,e),this.value=t,this.display=n,e._values.push(this)}return Object(S.a)(e,[{key:"getShape",value:function(t){switch(this){case e.RECT:return new E.fabric.Rect(t);case e.ELLIPSE:return new E.fabric.Ellipse(t);case e.TRIANGLE:return new E.fabric.Triangle(t);default:return new E.fabric.Rect(t)}}}],[{key:"values",value:function(){return this._values}},{key:"valueOf",value:function(e){return this.values().find((function(t){return t.value===e}))}}]),e}();B._values=[],B.RECT=new B("rect","\uc0ac\uac01\ud615"),B.ELLIPSE=new B("ellipse","\uc6d0"),B.TRIANGLE=new B("triangle","\uc0bc\uac01\ud615");var D=10,U=function(){function e(){Object(g.a)(this,e)}return Object(S.a)(e,[{key:"handle",value:function(e){if(e.object.isType(B.RECT.value)||e.object.isType(B.TRIANGLE.value))e.object.set({width:Math.max(D,e.object.width||D),height:Math.max(D,e.object.height||D)}).setCoords();else if(e.object.isType(B.ELLIPSE.value)){var t=e.object;t.set({rx:Math.max(5,t.rx||5),ry:Math.max(5,t.ry||5)}).setCoords()}e.canvasStore.selectedTool=a.SELECT,e.canvasStore.canvas.setActiveObject(e.object),e.canvasStore.canvas.renderAll()}}]),e}(),H=function(){function e(){Object(g.a)(this,e)}return Object(S.a)(e,[{key:"handle",value:function(e){e.object=e.canvasStore.shapeType.getShape({left:e.startCursorPosition.x,top:e.startCursorPosition.y,hasBorder:!0,stroke:"#000",strokeWidth:3,fill:"transparent",selectable:!1,hoverCursor:"default"}),e.object.isType(B.RECT.value)||e.object.isType(B.TRIANGLE.value)?e.object.set({width:0,height:0}):e.object.isType(B.ELLIPSE.value)&&e.object.set({rx:0,ry:0}),e.canvasStore.canvas.add(e.object)}}]),e}(),X=function(){function e(){Object(g.a)(this,e)}return Object(S.a)(e,[{key:"handle",value:function(e){e.currentCursorPosition.x<e.startCursorPosition.x&&e.object.set("left",Math.abs(e.currentCursorPosition.x)),e.currentCursorPosition.y<e.startCursorPosition.y&&e.object.set("top",Math.abs(e.currentCursorPosition.y)),e.object.set("flipX",e.currentCursorPosition.x<e.startCursorPosition.x),e.object.set("flipY",e.currentCursorPosition.y<e.startCursorPosition.y),e.object.isType(B.RECT.value)||e.object.isType(B.TRIANGLE.value)?e.object.set({width:Math.abs(e.startCursorPosition.x-e.currentCursorPosition.x),height:Math.abs(e.startCursorPosition.y-e.currentCursorPosition.y)}):e.object.isType(B.ELLIPSE.value)&&e.object.set({rx:Math.abs(e.startCursorPosition.x-e.currentCursorPosition.x)/2,ry:Math.abs(e.startCursorPosition.y-e.currentCursorPosition.y)/2}),e.canvasStore.canvas.renderAll()}}]),e}(),W=function(){function e(){Object(g.a)(this,e)}return Object(S.a)(e,[{key:"handle",value:function(e){e.object=new E.fabric.IText("\ud14d\uc2a4\ud2b8\ub97c \uc785\ub825\ud574\uc8fc\uc138\uc694",{top:e.currentCursorPosition.y,left:e.currentCursorPosition.x,fontSize:24}),e.canvasStore.canvas.add(e.object),e.canvasStore.selectedTool=a.SELECT,e.canvasStore.canvas.setActiveObject(e.object),e.object.selectAll(),e.object.enterEditing()}}]),e}(),z=function(){function e(){Object(g.a)(this,e)}return Object(S.a)(e,[{key:"handle",value:function(e){}}]),e}(),G=function(){function e(){Object(g.a)(this,e)}return Object(S.a)(e,[{key:"handle",value:function(e){}}]),e}(),J=function(){function e(t){Object(g.a)(this,e),this.canvasStore=t,this.shareObject={e:{},canvasStore:this.canvasStore,startCursorPosition:{x:0,y:0},currentCursorPosition:{x:0,y:0},isDown:!1}}return Object(S.a)(e,[{key:"init",value:function(){var t=this.canvasStore.canvas;t.on(e.MOUSE_UP,this.handleMouseUp.bind(this)),t.on(e.MOUSE_MOVE,this.handleMouseMove.bind(this)),t.on(e.MOUSE_DOWN,this.handleMouseDown.bind(this)),t.on(e.SELECTION_CREATED,this.handleSelectObject.bind(this)),t.on(e.SELECTION_UPDATED,this.handleSelectObject.bind(this)),t.on(e.SELECTION_CLEARED,this.handleDeSelectObject.bind(this))}},{key:"handleSelectObject",value:function(){var e=this.canvasStore.canvas;this.canvasStore.activeObject=e.getActiveObject(),this.canvasStore.activeObjects=e.getActiveObjects()}},{key:"handleDeSelectObject",value:function(){this.canvasStore.activeObject=void 0,this.canvasStore.activeObjects=[]}},{key:"handleMouseUp",value:function(e){var t;this.shareObject.e=e,this.shareObject.isDown=!1,null===(t=V.getInstance(this.canvasStore))||void 0===t||t.handle(this.shareObject)}},{key:"handleMouseDown",value:function(e){var t;this.shareObject.e=e,this.shareObject.isDown=!0,this.shareObject.startCursorPosition=Object(M.a)({},this.getCursorPosition(e)),this.shareObject.currentCursorPosition=Object(M.a)({},this.getCursorPosition(e)),null===(t=F.getInstance(this.canvasStore))||void 0===t||t.handle(this.shareObject)}},{key:"handleMouseMove",value:function(e){var t;(this.shareObject.e=e,this.shareObject.currentCursorPosition=Object(M.a)({},this.getCursorPosition(e)),this.shareObject.isDown)&&(null===(t=Y.getInstance(this.canvasStore))||void 0===t||t.handle(this.shareObject))}},{key:"getCursorPosition",value:function(e){return this.canvasStore.canvas.getPointer(e.e)}}]),e}();J.MOUSE_UP="mouse:up",J.MOUSE_DOWN="mouse:down",J.MOUSE_MOVE="mouse:move",J.SELECTION_CLEARED="selection:cleared",J.SELECTION_CREATED="selection:created",J.SELECTION_UPDATED="selection:updated";var V=function(){function e(){Object(g.a)(this,e)}return Object(S.a)(e,null,[{key:"getInstance",value:function(e){switch(e.selectedTool){case a.SHAPE:return new U;case a.TEXT:return new W;default:return null}}}]),e}(),F=function(){function e(){Object(g.a)(this,e)}return Object(S.a)(e,null,[{key:"getInstance",value:function(e){switch(e.selectedTool){case a.SHAPE:return new H;case a.TEXT:return new z;default:return null}}}]),e}(),Y=function(){function e(){Object(g.a)(this,e)}return Object(S.a)(e,null,[{key:"getInstance",value:function(e){switch(e.selectedTool){case a.SHAPE:return new X;case a.TEXT:return new G;default:return null}}}]),e}(),q=function(){function e(t,n){Object(g.a)(this,e),this.value=t,this.display=n,e._values.push(this)}return Object(S.a)(e,[{key:"getBrush",value:function(t){switch(this){case e.PENCIL:return new E.fabric.PencilBrush(t);case e.CIRCLE:return new E.fabric.CircleBrush(t);case e.SPRAY:return new E.fabric.SprayBrush(t);default:return new E.fabric.PencilBrush(t)}}}],[{key:"values",value:function(){return this._values}},{key:"valueOf",value:function(e){return this.values().find((function(t){return t.value===e}))}}]),e}();q._values=[],q.PENCIL=new q("pencil","\uc5f0\ud544"),q.CIRCLE=new q("circle","\uc6d0\ud615"),q.SPRAY=new q("spray","\uc2a4\ud504\ub808\uc774");var K,Q=function(){function e(){Object(g.a)(this,e),this.canvasId="canvas",this._canvas={},this._width=500,this._height=500,this._backgroundColor="white",this._selectedTool=a.SELECT,this._selectable=!1,this._brushType=q.PENCIL,this._shapeType=B.RECT,this._activeObject=void 0,this._activeObjects=[],Object(T.k)(this)}return Object(S.a)(e,[{key:"initCanvas",value:function(e,t){this._canvas=new E.fabric.Canvas(e,t),this.selectedTool=this._selectedTool,new J(this).init()}},{key:"canvas",get:function(){return this._canvas}},{key:"width",get:function(){return this._width},set:function(e){this._width=e}},{key:"height",get:function(){return this._height},set:function(e){this._height=e}},{key:"backgroundColor",get:function(){return this._backgroundColor},set:function(e){this._backgroundColor=e}},{key:"selectedTool",get:function(){return this._selectedTool},set:function(e){this._selectedTool=e,P.getInstance(this).select()}},{key:"selectable",get:function(){return this._selectable},set:function(e){this.canvas.selection=e,this.canvas.getObjects().forEach((function(t){t.selectable=e,t.hoverCursor=e?"move":"default"}))}},{key:"brushType",get:function(){return this._brushType},set:function(e){this._brushType=e,this.canvas.freeDrawingBrush=e.getBrush(this.canvas)}},{key:"shapeType",get:function(){return this._shapeType},set:function(e){this._shapeType=e}},{key:"activeObject",get:function(){return this._activeObject},set:function(e){this._activeObject=e}},{key:"activeObjects",get:function(){return this._activeObjects},set:function(e){this._activeObjects=e}}]),e}(),Z=new function e(){Object(g.a)(this,e),this.canvasStore=void 0,this.canvasStore=new Q},$=r.a.createContext(Z),ee=function(e){var t=e.children;return Object(c.jsx)($.Provider,{value:Z,children:t})},te=function(){return r.a.useContext($)},ne=n(107),ae=n.n(ne),ce=n(109),se=n.n(ce),re=n(108),ie=n.n(re),oe=n(112),ue=n(7),le=n(111),he=n(195),je=n(190),be=n(191),ve=n(103),de=n.n(ve),fe=n(104),Oe=n.n(fe),pe=n(105),xe=n.n(pe),ye=n(106),Ce=n.n(ye),ge=n(87),Se=n.n(ge),Te=n(102);!function(e){e.TEXT="text/plain"}(K||(K={}));var Ee=function(){function e(){Object(g.a)(this,e)}return Object(S.a)(e,null,[{key:"writeText",value:function(e,t){var n=new Blob([t],{type:K.TEXT}),a=window.URL.createObjectURL(n);this.write(e,a)}},{key:"write",value:function(e,t){var n=document.createElement("a");n.download=e,n.href=t,n.click()}},{key:"read",value:function(){var e=Object(Te.a)(Se.a.mark((function e(t){return Se.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){var a=new FileReader;a.onload=function(){return e(a.result)},a.onerror=function(){return n()},a.readAsText(t)})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),ke=Object(ue.a)({paper:{border:"1px solid #d3d4d5"}})((function(e){return Object(c.jsx)(le.a,Object(M.a)({elevation:0,getContentAnchorEl:null,anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"}},e))})),we=Object(ue.a)((function(e){return{root:{"&:focus":{backgroundColor:e.palette.primary.main,"& .MuiListItemIcon-root, & .MuiListItemText-primary":{color:e.palette.common.white}}}}}))(he.a);function me(){var e=r.a.useState(null),t=Object(oe.a)(e,2),n=t[0],a=t[1],s=te().canvasStore,i=r.a.useRef(null),o=function(){a(null)};return Object(c.jsxs)("div",{children:[Object(c.jsx)("input",{type:"file",onChange:function(e){var t,n=null===(t=e.target.files)||void 0===t?void 0:t.item(0);e.target.value="",n&&Ee.read(n).then((function(e){s.canvas.loadFromJSON(e,(function(){}))})).catch((function(e){return console.error(e)}))},ref:i,style:{display:"none"},accept:"application/json"}),Object(c.jsx)(p,{icon:Object(c.jsx)(de.a,{}),text:"\uba54\ub274",onClick:function(e){a(e.currentTarget)}}),Object(c.jsxs)(ke,{anchorEl:n,keepMounted:!0,open:Boolean(n),onClose:o,children:[Object(c.jsxs)(we,{onClick:function(){var e;null===(e=i.current)||void 0===e||e.click(),o()},children:[Object(c.jsx)(je.a,{children:Object(c.jsx)(Oe.a,{fontSize:"small"})}),Object(c.jsx)(be.a,{primary:"\uc5f4\uae30"})]}),Object(c.jsxs)(we,{onClick:function(){Ee.writeText("canvas.json",JSON.stringify(s.canvas.toJSON())),o()},children:[Object(c.jsx)(je.a,{children:Object(c.jsx)(xe.a,{fontSize:"small"})}),Object(c.jsx)(be.a,{primary:"\uc800\uc7a5"})]}),Object(c.jsxs)(we,{onClick:function(){var e=s.canvas.toDataURL();Ee.write("canvas.png",e),o()},children:[Object(c.jsx)(je.a,{children:Object(c.jsx)(Ce.a,{fontSize:"small"})}),Object(c.jsx)(be.a,{primary:"\uc774\ubbf8\uc9c0\ub85c \uc800\uc7a5"})]})]})]})}var Pe=n(110),_e=n.n(Pe),Le=j()((function(){return{appBarColor:{backgroundColor:"rgba(30,30,30,0.95)"},left:{justifyContent:"flex-start"},center:{display:"flex",flex:1,justifyContent:"center"},right:{justifyContent:"flex-end"}}})),Ie=Object(C.a)((function(){var e=Le(),t=te().canvasStore;return Object(c.jsx)(x.a,{classes:{colorDefault:e.appBarColor},color:"default",elevation:0,children:Object(c.jsxs)(y.a,{variant:"dense",children:[Object(c.jsx)("div",{className:e.left,children:Object(c.jsx)(me,{})}),Object(c.jsxs)("div",{className:e.center,children:[Object(c.jsx)(p,{icon:Object(c.jsx)(ae.a,{}),text:"\uc120\ud0dd",onClick:function(){return t.selectedTool=a.SELECT},selected:t.selectedTool===a.SELECT}),Object(c.jsx)(p,{icon:Object(c.jsx)(ie.a,{}),text:"\ube0c\ub7ec\uc2dc",onClick:function(){return t.selectedTool=a.BRUSH},selected:t.selectedTool===a.BRUSH}),Object(c.jsx)(p,{icon:Object(c.jsx)(se.a,{}),text:"\uc170\uc774\ud504",onClick:function(){return t.selectedTool=a.SHAPE},selected:t.selectedTool===a.SHAPE}),Object(c.jsx)(p,{icon:Object(c.jsx)(_e.a,{}),text:"\ud14d\uc2a4\ud2b8",onClick:function(){return t.selectedTool=a.TEXT},selected:t.selectedTool===a.TEXT})]}),Object(c.jsx)("div",{className:e.right})]})})})),Ae=n(78),Ne=n(196),Re=n(194),Me=j()((function(e){return{title:{marginBottom:e.spacing(3)},input:{padding:e.spacing(1),borderRadius:4,backgroundColor:"#fff"}}})),Be=Object(C.a)((function(){var e=Me(),t=te().canvasStore;return Object(c.jsxs)("div",{children:[Object(c.jsx)("div",{className:e.title,children:Object(c.jsx)(Ae.a,{variant:"h6",color:"primary",children:"\ube0c\ub7ec\uc2dc"})}),Object(c.jsxs)("div",{children:[Object(c.jsx)(Ne.a,{mb:1,children:Object(c.jsx)(Ae.a,{variant:"caption",children:"\ubaa8\uc591"})}),Object(c.jsx)(Re.a,{className:e.input,native:!0,onChange:function(e){t.brushType=q.valueOf(e.target.value)||q.PENCIL},value:t.brushType.value,label:"\ube0c\ub7ec\uc2dc \ubaa8\uc591",fullWidth:!0,children:q.values().map((function(e){return Object(c.jsx)("option",{value:e.value,children:e.display},e.value)}))})]})]})})),De=j()((function(e){return{title:{marginBottom:e.spacing(3)},input:{padding:e.spacing(1),borderRadius:4,backgroundColor:"#fff"}}})),Ue=Object(C.a)((function(){var e=De(),t=te().canvasStore;return Object(c.jsxs)("div",{children:[Object(c.jsx)("div",{className:e.title,children:Object(c.jsx)(Ae.a,{variant:"h6",color:"primary",children:"\uc170\uc774\ud504"})}),Object(c.jsxs)("div",{children:[Object(c.jsx)(Ne.a,{mb:1,children:Object(c.jsx)(Ae.a,{variant:"caption",children:"\ubaa8\uc591"})}),Object(c.jsx)(Re.a,{className:e.input,native:!0,onChange:function(e){t.shapeType=B.valueOf(e.target.value)||B.ELLIPSE},value:t.shapeType.value,label:"\uc170\uc774\ud504 \ubaa8\uc591",fullWidth:!0,children:B.values().map((function(e){return Object(c.jsx)("option",{value:e.value,children:e.display},e.value)}))})]})]})})),He=j()((function(e){return{root:{padding:e.spacing(3)}}})),Xe=Object(C.a)((function(){var e=He(),t=te().canvasStore.selectedTool;return Object(c.jsxs)("div",{className:e.root,children:[t===a.BRUSH&&Object(c.jsx)(Be,{}),t===a.SHAPE&&Object(c.jsx)(Ue,{})]})})),We=j()((function(e){return{root:{display:"flex",flexDirection:"column",width:"100vw",height:"100vh"},flexBox:{display:"flex",flex:1},contents:{display:"flex"},left:{flexBasis:"".concat(240,"px"),backgroundColor:"#f0f0f0"},canvasWrapper:{display:"flex",justifyContent:"center",alignItems:"center",flex:1,backgroundColor:"#c0c0c0",padding:e.spacing(3)}}})),ze=Object(C.a)((function(){var e=We(),t=te().canvasStore;return r.a.useEffect((function(){var e=document.getElementById(t.canvasId);t.initCanvas(e,{width:t.width,height:t.height,backgroundColor:t.backgroundColor})}),[]),Object(c.jsxs)(v,{children:[Object(c.jsx)(Ie,{}),Object(c.jsxs)("div",{className:e.root,children:[Object(c.jsx)(y.a,{variant:"dense"}),Object(c.jsxs)("div",{className:e.flexBox,children:[Object(c.jsx)("div",{className:e.left,children:Object(c.jsx)(Xe,{})}),Object(c.jsx)("div",{className:e.canvasWrapper,children:Object(c.jsx)("canvas",{id:t.canvasId})})]})]})]})}));var Ge=function(){return Object(c.jsx)(ze,{})};o.a.render(Object(c.jsx)(r.a.StrictMode,{children:Object(c.jsx)(ee,{children:Object(c.jsx)(Ge,{})})}),document.getElementById("root"))}},[[158,1,2]]]);
//# sourceMappingURL=main.51838419.chunk.js.map