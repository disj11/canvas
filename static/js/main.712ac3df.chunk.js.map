{"version":3,"sources":["templates/layout/Layout.tsx","models/color/CommonColor.tsx","components/tools/ToolButton.tsx","contexts/storeContext.ts","hooks/useStores.tsx","models/tools/ToolTypes.ts","utils/FileUtils.ts","components/tools/MenuToolButton.tsx","components/tools/ToolBox.tsx","models/tools/Brush.ts","models/tools/Text.ts","components/input/Range.tsx","components/input/ColorPicker.tsx","components/input/ColorPalette.tsx","hooks/usePrevious.tsx","components/input/ColorSelect.tsx","components/input/AlignButton.tsx","components/input/BoldButton.tsx","components/input/ItalicButton.tsx","components/input/UnderlineButton.tsx","components/input/TextStyleButton.tsx","components/tools/PropBoxLayout.tsx","components/tools/BrushPropBox.tsx","models/tools/Shape.ts","components/tools/ShapePropBox.tsx","components/tools/TextPropBox.tsx","components/tools/PropBox.tsx","templates/canvas/Canvas.tsx","App.tsx","stores/mouseEventStore.ts","stores/brushStore.ts","stores/canvasStore.ts","stores/objectManagerStore.ts","stores/objectEventStore.ts","stores/shapeStore.ts","stores/UIStore.ts","stores/textStore.ts","stores/selectStore.ts","stores/rootStore.ts","index.tsx"],"names":["useStyles","makeStyles","progressWrapper","display","justifyContent","alignItems","Layout","loading","children","classes","Fragment","CssBaseline","className","CircularProgress","CommonColor","theme","button","cursor","color","paddingTop","spacing","paddingBottom","paddingRight","paddingLeft","textAlign","caption","fontSize","selected","background","ToolButton","icon","text","onClick","clsx","StoreContext","React","createContext","StoreProvider","Provider","useStores","useContext","ToolTypes","value","_values","push","this","values","find","v","SELECT","BRUSH","SHAPE","TEXT","CANVAS","MimeType","FileUtils","fileName","blob","Blob","type","objectURL","window","URL","createObjectURL","write","dataURL","a","document","createElement","download","href","click","file","Promise","resolve","reject","reader","FileReader","onload","result","onerror","readAsText","StyledMenu","withStyles","paper","border","props","Menu","elevation","getContentAnchorEl","anchorOrigin","vertical","horizontal","transformOrigin","StyledMenuItem","root","backgroundColor","palette","primary","main","common","white","MenuItem","MenuToolButton","useState","anchorEl","setAnchorEl","canvasStore","inputRef","useRef","handleClose","onChange","e","target","files","item","read","then","jsonString","canvas","loadFromJSON","catch","console","error","ref","style","accept","event","currentTarget","keepMounted","open","Boolean","onClose","current","ListItemIcon","ListItemText","writeText","JSON","stringify","toJSON","fullQuality","toDataURL","appBarColor","left","center","flex","right","ToolBox","observer","AppBar","colorDefault","Toolbar","variant","setCanvasMode","canvasMode","BrushType","PENCIL","fabric","PencilBrush","CIRCLE","CircleBrush","SPRAY","SprayBrush","FontFaceType","label","Range","prefix","min","max","Typography","Input","margin","inputProps","endAdornment","InputAdornment","position","Slider","newValue","colorBox","width","height","borderStyle","borderColor","disabled","ColorPicker","Popover","disableAlpha","onChangeComplete","ColorPalette","Box","mb","usePrevious","useEffect","ColorSelect","previousColor","selectedValue","setSelectedValue","mr","flexBasis","rgb","r","g","b","hex","FormControl","fullWidth","Select","undefined","fontSizes","TextAlign","FontWeight","FontStyle","FontFaces","filter","font","GOOGLE","TIMES_NEW_ROMAN","DEFAULT","NOTO_SANS_KR","EAST_SEA_DOKDO","alignBox","alignButton","borderRadius","AlignButton","Button","BoldButton","bold","toggle","faBold","size","ItalicButton","italic","faItalic","UnderlineButton","underline","faUnderline","marginRight","TextStyleButton","toggleBold","toggleItalic","toggleUnderline","flexDirection","title","marginBottom","propBoxWrapper","PropBoxLayout","objectManagerStore","activeObject","getObjectTypeName","padding","propBox","BrushPropBox","brushStore","brushType","setBrushType","faPencilAlt","faSprayCan","faCircle","strokeWidth","setStrokeWidth","Divider","stroke","setStroke","ShapeType","options","RECT","Rect","ELLIPSE","Ellipse","TRIANGLE","Triangle","ShapePropBox","shapeStore","shapeType","setShapeType","cx","cy","fill","points","setFill","TextPropBox","textStore","fontFamily","setFontFamily","map","parseInt","setFontSize","isBold","isItalic","setBold","setItalic","setUnderline","setTextAlign","PropBox","selectedTool","isPath","isShape","isText","flexBox","contents","canvasWrapper","Canvas","rootStore","canvasRef","init","onDestroy","App","MouseEventType","defaultStyles","BrushStore","listeners","objectManager","makeAutoObservable","registerCanvasModeManager","updateObject","bind","addReactions","removeReactions","isDrawingMode","setFreeDrawingBrush","set","freeDrawingBrush","renderAll","getBrush","object","isBrush","updatePathStyles","styles","setPathStyles","isType","subscribe","unsubscribe","CanvasStore","canvasModeManagers","Map","setWidth","setHeight","setBackgroundColor","dispose","mode","manager","previousMode","discardActiveObject","setAllCursor","setSelectable","get","onSessionEnd","onSessionStart","selectable","selection","getObjects","forEach","obj","defaultCursor","hoverCursor","setDefaultCursor","setHoverCursor","SelectionEventType","MouseEventStore","startCursorPosition","x","y","currentCursorPosition","onMouseDown","onMouseUp","onMouseMove","addEventListeners","removeEventListeners","eventType","listener","has","fn","getCursorPosition","MOUSE_DOWN","callback","MOUSE_MOVE","MOUSE_UP","on","off","getPointer","ObjectEventType","ObjectManagerStore","Set","onSelected","onCleared","SELECTION_CREATED","SELECTION_UPDATED","SELECTION_CLEARED","reaction","add","trace","delete","isRect","isEllipse","isTriangle","ObjectEventStore","onScaling","onModified","addEventListener","removeEventListener","OBJECT_SCALING","OBJECT_MODIFIED","callbackFn","ShapeStore","mouseEventStore","isDragMode","updateShapeStyles","setShapeStyles","isShapeTool","getShape","top","strokeUniform","rx","ry","Math","abs","flipX","flipY","MIN_OBJECT_SIZE","setCoords","circle","setActiveObject","UIStore","FONT_SIZE","length","FILL","FONT_FAMILY","TEXT_ALIGN","FONT_STYLE","FONT_WEIGHT","UNDERLINE","TextStore","objectEventStore","fontStyle","fontWeight","autoRenderId","loadFont","addFontAutoRender","removeFontAutoRender","changedValue","updateTextStyles","setTextStyles","isTextTool","IText","lockUniScaling","setControlVisible","selectAll","enterEditing","scaleX","toFixed","scaleY","WebFont","load","google","families","getGoogleFonts","setInterval","getActiveObjects","textObject","initDimensions","dirty","util","clearFabricFontCache","clearInterval","SelectStore","canvasElement","selectStore","body","append","Object","onDestory","container","parentElement","onInit","ReactDOM","render","StrictMode","getElementById"],"mappings":"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","file":"static/js/main.712ac3df.chunk.js","sourcesContent":["import React from \"react\";\r\nimport CssBaseline from \"@material-ui/core/CssBaseline\";\r\nimport {CircularProgress} from \"@material-ui/core\";\r\nimport makeStyles from \"@material-ui/core/styles/makeStyles\";\r\n\r\nconst useStyles = makeStyles(() => ({\r\n    progressWrapper: {\r\n        display: \"flex\",\r\n        justifyContent: \"center\",\r\n        alignItems: \"center\",\r\n    }\r\n}))\r\n\r\nconst Layout = ({ loading, children }: Props) => {\r\n    const classes = useStyles();\r\n\r\n    return (\r\n        <React.Fragment>\r\n            <CssBaseline />\r\n            <div>\r\n                {loading ? (\r\n                    <div className={classes.progressWrapper}><CircularProgress /></div>\r\n                ) : children}\r\n            </div>\r\n        </React.Fragment>\r\n    )\r\n}\r\n\r\ninterface Props {\r\n    loading?: boolean;\r\n    children: React.ReactElement | React.ReactElement[];\r\n}\r\n\r\nexport default Layout;","export const CommonColor = {\r\n    PRIMARY: \"#ac76ff\",\r\n    BACKGROUND_GRADIENT: \"linear-gradient(90deg, rgba(172,118,255,1) 0%, rgba(91,91,255,1) 100%)\",\r\n    BACKGROUND_GRADIENT_HOVER: \"linear-gradient(90deg, rgba(172,118,255,.4) 0%, rgba(91,91,255,.4) 100%)\",\r\n}","import React from \"react\";\r\nimport makeStyles from \"@material-ui/core/styles/makeStyles\";\r\nimport clsx from \"clsx\";\r\nimport {CommonColor} from \"../../models/color/CommonColor\";\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n    button: {\r\n        display: \"inline-block\",\r\n        cursor: \"pointer\",\r\n        color: \"#fff\",\r\n        paddingTop: theme.spacing(0.5),\r\n        paddingBottom: theme.spacing(0.5),\r\n        paddingRight: theme.spacing(3),\r\n        paddingLeft: theme.spacing(3),\r\n        textAlign: \"center\",\r\n    },\r\n    caption: {\r\n        fontSize: \"0.70rem\",\r\n    },\r\n    selected: {\r\n        background: CommonColor.BACKGROUND_GRADIENT,\r\n    }\r\n}));\r\n\r\nconst ToolButton = ({icon, text, onClick, selected}: Props) => {\r\n    const classes = useStyles();\r\n    return (\r\n        <div className={clsx(classes.button, {\r\n            [classes.selected]: selected,\r\n        })} onClick={onClick}>\r\n            {icon}\r\n            <div className={classes.caption}>{text}</div>\r\n        </div>\r\n    )\r\n}\r\n\r\ninterface Props {\r\n    icon: any;\r\n    text: string;\r\n    onClick: (event: React.MouseEvent<HTMLElement>) => void;\r\n    selected?: boolean;\r\n}\r\n\r\nexport default ToolButton;","import React from \"react\";\r\nimport { RootStore } from \"stores/rootStore\";\r\n\r\nexport const StoreContext = React.createContext<RootStore>({} as RootStore);\r\nexport const StoreProvider = StoreContext.Provider;","import React from \"react\";\r\nimport {RootStore} from \"../stores/rootStore\";\r\nimport {StoreContext} from \"../contexts/storeContext\";\r\n\r\nexport const useStores = (): RootStore => React.useContext(StoreContext);","export class ToolTypes {\r\n    private static readonly _values: ToolTypes[] = [];\r\n    public static readonly SELECT = new ToolTypes(\"select\", \"선택\");\r\n    public static readonly BRUSH = new ToolTypes(\"brush\", \"브러쉬\");\r\n    public static readonly SHAPE = new ToolTypes(\"shape\", \"셰이프\");\r\n    public static readonly TEXT = new ToolTypes(\"text\", \"텍스트\");\r\n    public static readonly CANVAS = new ToolTypes(\"canvas\", \"캔버스\");\r\n\r\n    constructor(\r\n        public readonly value: string,\r\n        public readonly display: string,\r\n    ) {\r\n        ToolTypes._values.push(this);\r\n    }\r\n\r\n    public static values() {\r\n        return this._values;\r\n    }\r\n\r\n    public static valueOf(value: string) {\r\n        return this.values().find(v => v.value === value);\r\n    }\r\n}","enum MimeType {\r\n    TEXT = \"text/plain\",\r\n}\r\n\r\nexport class FileUtils {\r\n    public static writeText(fileName: string, text: string) {\r\n        const blob = new Blob([text], { type: MimeType.TEXT });\r\n        const objectURL = window.URL.createObjectURL(blob);\r\n        this.write(fileName, objectURL);\r\n    }\r\n\r\n    public static write(fileName: string, dataURL: string) {\r\n        const a = document.createElement('a');\r\n        a.download = fileName;\r\n        a.href = dataURL;\r\n        a.click();\r\n    }\r\n\r\n    public static async read(file: File): Promise<string> {\r\n        return new Promise((resolve, reject) => {\r\n            const reader = new FileReader();\r\n            reader.onload = () => resolve(reader.result as string);\r\n            reader.onerror = () => reject();\r\n            reader.readAsText(file);\r\n        });\r\n    }\r\n}","import React from \"react\";\r\nimport {withStyles} from \"@material-ui/core/styles\";\r\nimport Menu, {MenuProps} from \"@material-ui/core/Menu\";\r\nimport MenuItem from \"@material-ui/core/MenuItem\";\r\nimport ListItemIcon from \"@material-ui/core/ListItemIcon\";\r\nimport ListItemText from \"@material-ui/core/ListItemText\";\r\nimport ToolButton from \"./ToolButton\";\r\nimport MenuIcon from \"@material-ui/icons/Menu\";\r\nimport DescriptionIcon from \"@material-ui/icons/Description\";\r\nimport SaveIcon from \"@material-ui/icons/Save\";\r\nimport SaveAltIcon from \"@material-ui/icons/SaveAlt\";\r\nimport {useStores} from \"../../hooks/useStores\";\r\nimport {FileUtils} from \"../../utils/FileUtils\";\r\n\r\nconst StyledMenu = withStyles({\r\n    paper: {\r\n        border: \"1px solid #d3d4d5\",\r\n    },\r\n})((props: MenuProps) => (\r\n    <Menu\r\n        elevation={0}\r\n        getContentAnchorEl={null}\r\n        anchorOrigin={{\r\n            vertical: \"bottom\",\r\n            horizontal: \"center\",\r\n        }}\r\n        transformOrigin={{\r\n            vertical: \"top\",\r\n            horizontal: \"center\",\r\n        }}\r\n        {...props}\r\n    />\r\n));\r\n\r\nconst StyledMenuItem = withStyles((theme) => ({\r\n    root: {\r\n        \"&:focus\": {\r\n            backgroundColor: theme.palette.primary.main,\r\n            \"& .MuiListItemIcon-root, & .MuiListItemText-primary\": {\r\n                color: theme.palette.common.white,\r\n            },\r\n        },\r\n    },\r\n}))(MenuItem);\r\n\r\nexport default function MenuToolButton() {\r\n    const [anchorEl, setAnchorEl] = React.useState<null | HTMLElement>(null);\r\n    const {canvasStore} = useStores();\r\n    const inputRef = React.useRef<HTMLInputElement>(null);\r\n\r\n    const handleClick = (event: React.MouseEvent<HTMLElement>) => {\r\n        setAnchorEl(event.currentTarget);\r\n    };\r\n\r\n    const handleClose = () => {\r\n        setAnchorEl(null);\r\n    };\r\n\r\n    const handleFileOpen = () => {\r\n        inputRef.current?.click();\r\n        handleClose();\r\n    }\r\n\r\n    const handleFileChange = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n        const file = e.target.files?.item(0);\r\n        e.target.value = \"\";\r\n\r\n        if (!!file) {\r\n            FileUtils.read(file).then(jsonString => {\r\n                canvasStore.canvas.loadFromJSON(jsonString, () => {\r\n                    //\r\n                })\r\n            }).catch(e => console.error(e));\r\n        }\r\n    }\r\n\r\n    const handleSave = () => {\r\n        FileUtils.writeText(\"canvas.json\", JSON.stringify(canvasStore.canvas.toJSON()));\r\n        handleClose();\r\n    }\r\n\r\n    const handleImageSave = () => {\r\n        const fullQuality = canvasStore.canvas.toDataURL();\r\n        FileUtils.write(\"canvas.png\", fullQuality);\r\n        handleClose();\r\n    }\r\n\r\n    return (\r\n        <div>\r\n            <input\r\n                type={\"file\"}\r\n                onChange={handleFileChange}\r\n                ref={inputRef}\r\n                style={{display: \"none\"}}\r\n                accept=\"application/json\"\r\n            />\r\n            <ToolButton icon={<MenuIcon/>} text={\"메뉴\"} onClick={handleClick}/>\r\n            <StyledMenu\r\n                anchorEl={anchorEl}\r\n                keepMounted\r\n                open={Boolean(anchorEl)}\r\n                onClose={handleClose}\r\n            >\r\n                <StyledMenuItem onClick={handleFileOpen}>\r\n                    <ListItemIcon>\r\n                        <DescriptionIcon fontSize=\"small\"/>\r\n                    </ListItemIcon>\r\n                    <ListItemText primary=\"열기\"/>\r\n                </StyledMenuItem>\r\n                <StyledMenuItem onClick={handleSave}>\r\n                    <ListItemIcon>\r\n                        <SaveIcon fontSize=\"small\"/>\r\n                    </ListItemIcon>\r\n                    <ListItemText primary=\"저장\"/>\r\n                </StyledMenuItem>\r\n                <StyledMenuItem onClick={handleImageSave}>\r\n                    <ListItemIcon>\r\n                        <SaveAltIcon fontSize=\"small\"/>\r\n                    </ListItemIcon>\r\n                    <ListItemText primary=\"이미지로 저장\"/>\r\n                </StyledMenuItem>\r\n            </StyledMenu>\r\n        </div>\r\n    );\r\n}","import React from \"react\";\r\nimport {AppBar, Toolbar} from \"@material-ui/core\";\r\nimport makeStyles from \"@material-ui/core/styles/makeStyles\";\r\nimport {observer} from \"mobx-react\";\r\nimport {useStores} from \"../../hooks/useStores\";\r\nimport ToolButton from \"./ToolButton\";\r\nimport MouseIcon from '@material-ui/icons/Mouse';\r\nimport DashboardIcon from '@material-ui/icons/Dashboard';\r\nimport BrushIcon from \"@material-ui/icons/Brush\";\r\nimport {ToolTypes} from \"../../models/tools/ToolTypes\";\r\nimport MenuToolButton from \"./MenuToolButton\";\r\nimport TextFieldsIcon from \"@material-ui/icons/TextFields\";\r\nimport PhotoSizeSelectSmallIcon from \"@material-ui/icons/PhotoSizeSelectSmall\";\r\n\r\nconst useStyles = makeStyles(() => ({\r\n    appBarColor: {\r\n        backgroundColor: \"rgba(30,30,30,0.95)\",\r\n    },\r\n    left: {\r\n        justifyContent: \"flex-start\",\r\n    },\r\n    center: {\r\n        display: \"flex\",\r\n        flex: 1,\r\n        justifyContent: \"center\",\r\n    },\r\n    right: {\r\n        justifyContent: \"flex-end\",\r\n    }\r\n}));\r\n\r\nconst ToolBox = observer(() => {\r\n    const classes = useStyles();\r\n    const {canvasStore} = useStores();\r\n\r\n    return (\r\n        <AppBar\r\n            classes={{\r\n                colorDefault: classes.appBarColor,\r\n            }}\r\n            color={\"default\"}\r\n            elevation={0}\r\n        >\r\n            <Toolbar variant={\"dense\"}>\r\n                <div className={classes.left}>\r\n                    <MenuToolButton/>\r\n                </div>\r\n                <div className={classes.center}>\r\n                    <ToolButton\r\n                        icon={<MouseIcon/>}\r\n                        text={ToolTypes.SELECT.display}\r\n                        onClick={() => canvasStore.setCanvasMode(ToolTypes.SELECT)}\r\n                        selected={canvasStore.canvasMode === ToolTypes.SELECT}\r\n                    />\r\n                    <ToolButton\r\n                        icon={<BrushIcon/>}\r\n                        text={ToolTypes.BRUSH.display}\r\n                        onClick={() => canvasStore.setCanvasMode(ToolTypes.BRUSH)}\r\n                        selected={canvasStore.canvasMode === ToolTypes.BRUSH}\r\n                    />\r\n                    <ToolButton\r\n                        icon={<DashboardIcon/>}\r\n                        text={ToolTypes.SHAPE.display}\r\n                        onClick={() => canvasStore.setCanvasMode(ToolTypes.SHAPE)}\r\n                        selected={canvasStore.canvasMode === ToolTypes.SHAPE}\r\n                    />\r\n                    <ToolButton\r\n                        icon={<TextFieldsIcon/>}\r\n                        text={ToolTypes.TEXT.display}\r\n                        onClick={() => canvasStore.setCanvasMode(ToolTypes.TEXT)}\r\n                        selected={canvasStore.canvasMode === ToolTypes.TEXT}\r\n                    />\r\n                    <ToolButton\r\n                        icon={<PhotoSizeSelectSmallIcon/>}\r\n                        text={ToolTypes.CANVAS.display}\r\n                        onClick={() => canvasStore.setCanvasMode(ToolTypes.CANVAS)}\r\n                        selected={canvasStore.canvasMode === ToolTypes.CANVAS}\r\n                    />\r\n                </div>\r\n                <div className={classes.right}>\r\n                </div>\r\n            </Toolbar>\r\n        </AppBar>\r\n    )\r\n})\r\n\r\nexport default ToolBox;","import {fabric} from \"fabric\";\r\n\r\nexport class BrushType {\r\n    private static readonly _values: BrushType[] = [];\r\n    public static readonly PENCIL = new BrushType(\"pencil\", \"연필\");\r\n    public static readonly CIRCLE = new BrushType(\"circle\", \"원형\");\r\n    public static readonly SPRAY = new BrushType(\"spray\", \"스프레이\");\r\n\r\n    constructor(\r\n        public readonly value: string,\r\n        public readonly display: string,\r\n    ) {\r\n        BrushType._values.push(this);\r\n    }\r\n\r\n    public static values() {\r\n        return this._values;\r\n    }\r\n\r\n    public static valueOf(value: string) {\r\n        return this.values().find(v => v.value === value);\r\n    }\r\n\r\n    public getBrush(canvas: fabric.Canvas) {\r\n        switch (this) {\r\n            case BrushType.PENCIL:\r\n                return new (fabric.PencilBrush as any)(canvas);\r\n            case BrushType.CIRCLE:\r\n                return new (fabric.CircleBrush as any)(canvas);\r\n            case BrushType.SPRAY:\r\n                return new (fabric.SprayBrush as any)(canvas);\r\n            default:\r\n                return new (fabric.PencilBrush as any)(canvas);\r\n        }\r\n    }\r\n}","export const fontSizes = [8, 9, 10, 11, 12, 14, 16, 18, 20, 22, 24, 26, 28, 36, 48, 72, 94, 130];\r\n\r\nexport enum FontFaceType {\r\n    DEFAULT,\r\n    GOOGLE,\r\n}\r\n\r\nexport const TextAlign = {\r\n    LEFT: \"left\",\r\n    CENTER: \"center\",\r\n    RIGHT: \"right\",\r\n}\r\n\r\nexport const FontWeight = {\r\n    NORMAL: \"normal\",\r\n    BOLD: \"bold\",\r\n}\r\n\r\nexport const FontStyle = {\r\n    NORMAL: \"normal\",\r\n    ITALIC: \"italic\",\r\n}\r\n\r\nexport class FontFaces {\r\n    private static readonly _values: FontFaces[] = [];\r\n    public static readonly TIMES_NEW_ROMAN = new FontFaces(\"Times New Roman\", \"Times New Roman\", FontFaceType.DEFAULT);\r\n    public static readonly NOTO_SANS_KR = new FontFaces(\"Noto Sans KR\", \"Noto Sans KR\", FontFaceType.GOOGLE);\r\n    public static readonly EAST_SEA_DOKDO = new FontFaces(\"East Sea Dokdo\", \"East Sea Dokdo\", FontFaceType.GOOGLE);\r\n\r\n    constructor(\r\n        public readonly value: string,\r\n        public readonly display: string,\r\n        public readonly type: FontFaceType,\r\n    ) {\r\n        FontFaces._values.push(this);\r\n    }\r\n\r\n    public static values() {\r\n        return this._values;\r\n    }\r\n\r\n    public static valueOf(value: string) {\r\n        return this.values().find(v => v.value === value);\r\n    }\r\n\r\n    public static getGoogleFonts() {\r\n        return this.values().filter(font => font.type === FontFaceType.GOOGLE);\r\n    }\r\n}","import React from \"react\";\r\nimport makeStyles from \"@material-ui/core/styles/makeStyles\";\r\nimport { Slider } from \"@material-ui/core\";\r\nimport { Input } from \"@material-ui/core\";\r\nimport { Typography } from \"@material-ui/core\";\r\nimport { InputAdornment } from \"@material-ui/core\";\r\n\r\ninterface Props {\r\n    label: string;\r\n    value: number;\r\n    onChange: (value: number) => void;\r\n    prefix?: string;\r\n    min?: number;\r\n    max?: number;\r\n}\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n    label: {\r\n        display: \"flex\",\r\n        justifyContent: \"space-between\",\r\n    }\r\n}));\r\n\r\nconst Range = ({ label, value, onChange, prefix, min, max }: Props) => {\r\n    const classes = useStyles();\r\n\r\n    const handleSliderChange = (event: any, newValue: number | number[]) => {\r\n        if (typeof newValue === \"number\") {\r\n            onChange(newValue);\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div>\r\n            <div className={classes.label}>\r\n                <Typography variant={\"caption\"}>{label}</Typography>\r\n                <Input\r\n                    value={value}\r\n                    margin=\"dense\"\r\n                    inputProps={{\r\n                        min: 1,\r\n                        max: 100,\r\n                        type: 'number',\r\n                    }}\r\n                    endAdornment={<InputAdornment position=\"end\">{prefix}</InputAdornment>}\r\n                />\r\n            </div>\r\n            <div>\r\n                <Slider\r\n                    min={min}\r\n                    max={max}\r\n                    value={value}\r\n                    onChange={handleSliderChange}\r\n                />\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default Range;","import { Popover, Typography } from \"@material-ui/core\";\r\nimport React from \"react\";\r\nimport { ChromePicker, ColorResult } from \"react-color\"\r\nimport makeStyles from \"@material-ui/core/styles/makeStyles\";\r\n\r\ninterface Props {\r\n    label?: string,\r\n    color: string | undefined,\r\n    disableAlpha?: boolean,\r\n    disabled?: boolean,\r\n    onChange: (color: ColorResult) => void;\r\n}\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n    colorBox: {\r\n        width: \"100%\",\r\n        height: 35,\r\n        border: 1,\r\n        borderStyle: \"solid\",\r\n        borderColor: \"#c0c0c0\",\r\n        backgroundColor: (props: Props) => props.color,\r\n        cursor: (props: Props) => !props.disabled ? \"pointer\" : \"default\",\r\n    }\r\n}));\r\n\r\nconst ColorPicker = (props: Props) => {\r\n    const classes = useStyles(props);\r\n    const [anchorEl, setAnchorEl] = React.useState<HTMLButtonElement | null>(null);\r\n    const open = !!anchorEl;\r\n\r\n    const handleClick = (e: any) => {\r\n        setAnchorEl(e.currentTarget);\r\n    };\r\n\r\n    const handleClose = () => {\r\n        setAnchorEl(null);\r\n    };\r\n\r\n    return (\r\n        <div>\r\n            {props.label && <Typography variant={\"caption\"}>{props.label}</Typography>}\r\n            <div>\r\n                <div className={classes.colorBox} onClick={handleClick} />\r\n                <Popover\r\n                    open={open && !props.disabled}\r\n                    anchorEl={anchorEl}\r\n                    onClose={handleClose}\r\n                >\r\n                    <ChromePicker color={props.color} disableAlpha={props.disableAlpha} onChangeComplete={props.onChange} />\r\n                </Popover>\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default ColorPicker;","import { Box } from \"@material-ui/core\";\r\nimport React from \"react\";\r\nimport { ColorResult, TwitterPicker } from \"react-color\"\r\nimport ColorPicker from \"./ColorPicker\";\r\n\r\ninterface Props {\r\n    color: string,\r\n    disableAlpha?: boolean,\r\n    onChange: (color: ColorResult) => void;\r\n}\r\n\r\nconst ColorPalette = (props: Props) => {\r\n    return (\r\n        <div>\r\n            <Box mb={2}>\r\n                <ColorPicker {...props} />\r\n            </Box>\r\n            <TwitterPicker width={\"100%\"} color={props.color} onChangeComplete={props.onChange} />\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default ColorPalette;","import React from \"react\";\r\n\r\nconst usePrevious = (value: any) => {\r\n    const ref = React.useRef();\r\n    React.useEffect(() => {\r\n        ref.current = value;\r\n    });\r\n\r\n    return ref.current;\r\n}\r\n\r\nexport default usePrevious;","import { Select } from \"@material-ui/core\";\r\nimport { MenuItem } from \"@material-ui/core\";\r\nimport { FormControl } from \"@material-ui/core\";\r\nimport { Box } from \"@material-ui/core\";\r\nimport usePrevious from \"hooks/usePrevious\";\r\nimport { CommonColor } from \"models/color/CommonColor\";\r\nimport React from \"react\"\r\nimport { ColorResult } from \"react-color\"\r\nimport ColorPicker from \"./ColorPicker\"\r\n\r\ninterface Props {\r\n    color: string | undefined;\r\n    onChange: (color: string | undefined) => void;\r\n}\r\n\r\nconst ColorSelect = ({ color, onChange }: Props) => {\r\n    const previousColor = usePrevious(color);\r\n    const [selectedValue, setSelectedValue] = React.useState<string>(!color ? \"none\" : \"solid\");\r\n\r\n    const handleColorChange = (color: ColorResult) => {\r\n        const rgb = !color.rgb.a && color.rgb.a !== 0 ? color.hex : `rgba(${color.rgb.r}, ${color.rgb.g}, ${color.rgb.b}, ${color.rgb.a})`;\r\n        onChange(rgb);\r\n    }\r\n\r\n    const handleSelectedValueChange = (event: React.ChangeEvent<{ value: unknown }>) => {\r\n        const value = event.target.value as string;\r\n        setSelectedValue(value);\r\n\r\n        if (value === \"none\") {\r\n            onChange(undefined);\r\n        } else {\r\n            onChange(previousColor || CommonColor.PRIMARY);\r\n        }\r\n    };\r\n\r\n    return (\r\n        <Box display={\"flex\"}>\r\n            <Box mr={1.5} flexBasis={35}>\r\n                <ColorPicker color={color} onChange={handleColorChange} disabled={selectedValue === \"none\"} />\r\n            </Box>\r\n            <Box flex={1}>\r\n                <FormControl fullWidth>\r\n                    <Select\r\n                        value={selectedValue}\r\n                        onChange={handleSelectedValueChange}\r\n                    >\r\n                        <MenuItem value=\"none\">\r\n                            <em>없음</em>\r\n                        </MenuItem>\r\n                        <MenuItem value={\"solid\"}>단색</MenuItem>\r\n                    </Select>\r\n                </FormControl>\r\n            </Box>\r\n        </Box>\r\n    )\r\n}\r\n\r\nexport default ColorSelect","import FormatAlignLeftIcon from '@material-ui/icons/FormatAlignLeft';\r\nimport FormatAlignCenterIcon from '@material-ui/icons/FormatAlignCenter';\r\nimport FormatAlignRightIcon from '@material-ui/icons/FormatAlignRight';\r\nimport React from 'react';\r\nimport makeStyles from '@material-ui/core/styles/makeStyles';\r\nimport { Button } from '@material-ui/core';\r\nimport clsx from 'clsx';\r\nimport { TextAlign } from 'models/tools/Text';\r\nimport { CommonColor } from 'models/color/CommonColor';\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n    alignBox: {\r\n        display: \"flex\",\r\n        border: 2,\r\n        borderStyle: \"solid\",\r\n        borderColor: \"#ddd\",\r\n    },\r\n    alignButton: {\r\n        flex: 1,\r\n        borderRadius: 0,\r\n    },\r\n    selected: {\r\n        background: CommonColor.BACKGROUND_GRADIENT,\r\n        color: \"#ffffff\",\r\n    }\r\n}));\r\n\r\ninterface Props {\r\n    textAlign: string,\r\n    onChange: (textAlign: string) => void,\r\n}\r\n\r\nconst AlignButton = ({textAlign, onChange}: Props) => {\r\n    const classes = useStyles();\r\n    \r\n    return (\r\n        <div className={classes.alignBox}>\r\n            <Button className={clsx(classes.alignButton, textAlign === TextAlign.LEFT && classes.selected)} onClick={() => onChange(TextAlign.LEFT)}>\r\n                <FormatAlignLeftIcon/>\r\n            </Button>\r\n            <Button className={clsx(classes.alignButton, textAlign === TextAlign.CENTER && classes.selected)} onClick={() => onChange(TextAlign.CENTER)}>\r\n                <FormatAlignCenterIcon/>\r\n            </Button>\r\n            <Button className={clsx(classes.alignButton, textAlign === TextAlign.RIGHT && classes.selected)} onClick={() => onChange(TextAlign.RIGHT)}>\r\n                <FormatAlignRightIcon/>\r\n            </Button>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default AlignButton;","import { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\r\nimport { faBold } from \"@fortawesome/free-solid-svg-icons\";\r\nimport React from \"react\";\r\nimport { Button } from \"@material-ui/core\";\r\nimport makeStyles from \"@material-ui/core/styles/makeStyles\";\r\nimport { CommonColor } from \"models/color/CommonColor\";\r\nimport clsx from \"clsx\";\r\n\r\nconst useStyles = makeStyles(() => ({\r\n    button: {\r\n        borderRadius: 0,\r\n        border: 2,\r\n        borderStyle: \"solid\",\r\n        borderColor: \"#ddd\",\r\n    },\r\n    selected: {\r\n        background: CommonColor.BACKGROUND_GRADIENT,\r\n        color: \"#ffffff\",\r\n    }\r\n}));\r\n\r\n\r\ninterface Props {\r\n    bold: boolean,\r\n    toggle: (bold: boolean) => void,\r\n}\r\n\r\nconst BoldButton = ({bold, toggle}: Props) => {\r\n    const classes = useStyles();\r\n    return (\r\n        <Button className={clsx(classes.button, bold && classes.selected)} onClick={() => toggle(!bold)}>\r\n            <FontAwesomeIcon icon={faBold} size=\"lg\" />\r\n        </Button>\r\n    )\r\n}\r\n\r\nexport default BoldButton;","import { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\r\nimport { faItalic } from \"@fortawesome/free-solid-svg-icons\";\r\nimport React from \"react\";\r\nimport { Button } from \"@material-ui/core\";\r\nimport makeStyles from \"@material-ui/core/styles/makeStyles\";\r\nimport { CommonColor } from \"models/color/CommonColor\";\r\nimport clsx from \"clsx\";\r\n\r\nconst useStyles = makeStyles(() => ({\r\n    button: {\r\n        borderRadius: 0,\r\n        border: 2,\r\n        borderStyle: \"solid\",\r\n        borderColor: \"#ddd\",\r\n    },\r\n    selected: {\r\n        background: CommonColor.BACKGROUND_GRADIENT,\r\n        color: \"#ffffff\",\r\n    }\r\n}));\r\n\r\n\r\ninterface Props {\r\n    italic: boolean,\r\n    toggle: (bold: boolean) => void,\r\n}\r\n\r\nconst ItalicButton = ({italic, toggle}: Props) => {\r\n    const classes = useStyles();\r\n    return (\r\n        <Button className={clsx(classes.button, italic && classes.selected)} onClick={() => toggle(!italic)}>\r\n            <FontAwesomeIcon icon={faItalic} size=\"lg\" />\r\n        </Button>\r\n    )\r\n}\r\n\r\nexport default ItalicButton;","import { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\r\nimport { faUnderline } from \"@fortawesome/free-solid-svg-icons\";\r\nimport React from \"react\";\r\nimport { Button } from \"@material-ui/core\";\r\nimport makeStyles from \"@material-ui/core/styles/makeStyles\";\r\nimport { CommonColor } from \"models/color/CommonColor\";\r\nimport clsx from \"clsx\";\r\n\r\nconst useStyles = makeStyles(() => ({\r\n    button: {\r\n        borderRadius: 0,\r\n        border: 2,\r\n        borderStyle: \"solid\",\r\n        borderColor: \"#ddd\",\r\n    },\r\n    selected: {\r\n        background: CommonColor.BACKGROUND_GRADIENT,\r\n        color: \"#ffffff\",\r\n    }\r\n}));\r\n\r\n\r\ninterface Props {\r\n    underline: boolean,\r\n    toggle: (bold: boolean) => void,\r\n}\r\n\r\nconst UnderlineButton = ({underline, toggle}: Props) => {\r\n    const classes = useStyles();\r\n    return (\r\n        <Button className={clsx(classes.button, underline && classes.selected)} onClick={() => toggle(!underline)}>\r\n            <FontAwesomeIcon icon={faUnderline} size=\"lg\" />\r\n        </Button>\r\n    )\r\n}\r\n\r\nexport default UnderlineButton;","import React from 'react';\r\nimport makeStyles from '@material-ui/core/styles/makeStyles';\r\nimport BoldButton from './BoldButton';\r\nimport ItalicButton from './ItalicButton';\r\nimport UnderlineButton from './UnderlineButton';\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n    alignBox: {\r\n        display: \"flex\",\r\n        \"& > *\": {\r\n            flex: 1,\r\n            marginRight: theme.spacing(1),\r\n            paddingTop: theme.spacing(1),\r\n            paddingBottom: theme.spacing(1),\r\n            \"&:last-child\": {\r\n                marginRight: 0,\r\n            }\r\n        }\r\n    },\r\n}));\r\n\r\ninterface Props {\r\n    bold: boolean;\r\n    italic: boolean;\r\n    underline: boolean;\r\n    toggleBold: (bold: boolean) => void;\r\n    toggleItalic: (italic: boolean) => void;\r\n    toggleUnderline: (underline: boolean) => void;\r\n}\r\n\r\nconst TextStyleButton = ({bold, italic, underline, toggleBold, toggleItalic, toggleUnderline}: Props) => {\r\n    const classes = useStyles();\r\n    \r\n    return (\r\n        <div className={classes.alignBox}>\r\n            <BoldButton bold={bold} toggle={toggleBold}/>\r\n            <ItalicButton italic={italic} toggle={toggleItalic}/>\r\n            <UnderlineButton underline={underline} toggle={toggleUnderline}/>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default TextStyleButton;","import { Typography } from \"@material-ui/core\";\r\nimport makeStyles from \"@material-ui/core/styles/makeStyles\";\r\nimport { useStores } from \"hooks/useStores\";\r\nimport { observer } from \"mobx-react\";\r\nimport React from \"react\";\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n    root: {\r\n        display: \"flex\",\r\n        flexDirection: \"column\",\r\n        height: \"100%\",\r\n    },\r\n    title: {\r\n        marginBottom: theme.spacing(3),\r\n    },\r\n    propBoxWrapper: {\r\n        flex: 1,\r\n        display: \"flex\",\r\n        flexDirection: \"column\",\r\n    },\r\n}))\r\n\r\nconst PropBoxLayout: React.FC = observer(({ children }) => {\r\n    const classes = useStyles();\r\n    const { canvasStore, objectManagerStore } = useStores();\r\n\r\n    return (\r\n        <div className={classes.root}>\r\n            <div className={classes.title}>\r\n                <Typography variant={\"h6\"} color={\"primary\"}>{objectManagerStore.activeObject ? objectManagerStore.getObjectTypeName() : canvasStore.canvasMode.display}</Typography>\r\n            </div>\r\n            <div className={classes.propBoxWrapper}>\r\n                {children}\r\n            </div>\r\n        </div>\r\n    )\r\n})\r\n\r\nexport default PropBoxLayout;","import { Box, Divider, Typography } from \"@material-ui/core\";\r\nimport { BrushType } from \"../../models/tools/Brush\";\r\nimport React from \"react\";\r\nimport makeStyles from \"@material-ui/core/styles/makeStyles\";\r\nimport { observer } from \"mobx-react\";\r\nimport { useStores } from \"../../hooks/useStores\";\r\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\r\nimport { faPencilAlt, faSprayCan, faCircle } from \"@fortawesome/free-solid-svg-icons\";\r\nimport clsx from \"clsx\";\r\nimport { CommonColor } from \"../../models/color/CommonColor\";\r\nimport { ColorPalette, Range } from \"components/input\";\r\nimport PropBoxLayout from \"./PropBoxLayout\";\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n    button: {\r\n        borderRadius: \"4px\",\r\n        cursor: \"pointer\",\r\n        padding: theme.spacing(1),\r\n        marginRight: theme.spacing(0.5),\r\n        \"&:hover\": {\r\n            background: CommonColor.BACKGROUND_GRADIENT_HOVER,\r\n            \"& *\": {\r\n                color: \"white\",\r\n            }\r\n        },\r\n    },\r\n    selected: {\r\n        background: CommonColor.BACKGROUND_GRADIENT,\r\n        \"& *\": {\r\n            color: \"white\",\r\n        }\r\n    },\r\n    propBox: {\r\n        flex: 1,\r\n        \"& > div\": {\r\n            marginBottom: theme.spacing(3),\r\n        }\r\n    }\r\n}))\r\n\r\nconst BrushPropBox = observer(() => {\r\n    const classes = useStyles();\r\n    const { brushStore } = useStores();\r\n\r\n    return (\r\n        <PropBoxLayout>\r\n            <div className={classes.propBox}>\r\n                {!brushStore.item && <div>\r\n                    <Box mb={1}>\r\n                        <Typography variant={\"caption\"}>모양</Typography>\r\n                    </Box>\r\n                    <Box display=\"flex\">\r\n                        <div\r\n                            className={clsx(classes.button, brushStore.brushType === BrushType.PENCIL && classes.selected)}\r\n                            onClick={() => brushStore.setBrushType(BrushType.PENCIL)}\r\n                        >\r\n                            <FontAwesomeIcon icon={faPencilAlt} size=\"lg\" />\r\n                        </div>\r\n                        <div\r\n                            className={clsx(classes.button, brushStore.brushType === BrushType.SPRAY && classes.selected)}\r\n                            onClick={() => brushStore.setBrushType(BrushType.SPRAY)}\r\n                        >\r\n                            <FontAwesomeIcon icon={faSprayCan} size=\"lg\" />\r\n                        </div>\r\n                        <div\r\n                            className={clsx(classes.button, brushStore.brushType === BrushType.CIRCLE && classes.selected)}\r\n                            onClick={() => brushStore.setBrushType(BrushType.CIRCLE)}\r\n                        >\r\n                            <FontAwesomeIcon icon={faCircle} size=\"lg\" />\r\n                        </div>\r\n                    </Box>\r\n                </div>}\r\n                <div>\r\n                    <Range\r\n                        label=\"두께\"\r\n                        value={brushStore.strokeWidth}\r\n                        onChange={(strokeWidth) => brushStore.setStrokeWidth(strokeWidth)}\r\n                        prefix={\"px\"}\r\n                        min={1}\r\n                    />\r\n                </div>\r\n            </div>\r\n            <div>\r\n                <Box paddingTop={3} paddingBottom={3}><Divider /></Box>\r\n                <ColorPalette color={brushStore.stroke} onChange={(color) => brushStore.setStroke(color.hex)} disableAlpha={true} />\r\n            </div>\r\n        </PropBoxLayout>\r\n    )\r\n})\r\n\r\nexport default BrushPropBox;","import {fabric} from \"fabric\";\r\n\r\nexport class ShapeType {\r\n    private static readonly _values: ShapeType[] = [];\r\n    public static readonly RECT = new ShapeType(\"rect\", \"사각형\");\r\n    public static readonly ELLIPSE = new ShapeType(\"ellipse\", \"원\");\r\n    public static readonly TRIANGLE = new ShapeType(\"triangle\", \"삼각형\");\r\n\r\n    constructor(\r\n        public readonly value: string,\r\n        public readonly display: string,\r\n    ) {\r\n        ShapeType._values.push(this);\r\n    }\r\n\r\n    public static values() {\r\n        return this._values;\r\n    }\r\n\r\n    public static valueOf(value: string) {\r\n        return this.values().find(v => v.value === value);\r\n    }\r\n\r\n    public getShape<T extends fabric.IObjectOptions>(options?: T) {\r\n        switch (this) {\r\n            case ShapeType.RECT:\r\n                return new fabric.Rect(options);\r\n            case ShapeType.ELLIPSE:\r\n                return new fabric.Ellipse(options);\r\n            case ShapeType.TRIANGLE:\r\n                return new fabric.Triangle(options);\r\n            default:\r\n                return new fabric.Rect(options);\r\n        }\r\n    }\r\n}","import { Box, Typography } from \"@material-ui/core\";\r\nimport React from \"react\";\r\nimport makeStyles from \"@material-ui/core/styles/makeStyles\";\r\nimport { observer } from \"mobx-react\";\r\nimport { ShapeType } from \"../../models/tools/Shape\";\r\nimport clsx from \"clsx\";\r\nimport { CommonColor } from \"../../models/color/CommonColor\";\r\nimport PropBoxLayout from \"./PropBoxLayout\";\r\nimport { useStores } from \"hooks/useStores\";\r\nimport { ColorSelect, Range } from \"components/input\";\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n    button: {\r\n        borderRadius: \"4px\",\r\n        cursor: \"pointer\",\r\n        padding: theme.spacing(1),\r\n        marginRight: theme.spacing(0.5),\r\n        height: 40,\r\n        \"&:hover\": {\r\n            background: CommonColor.BACKGROUND_GRADIENT_HOVER,\r\n            \"& svg > *\": {\r\n                stroke: \"white\",\r\n            }\r\n        },\r\n    },\r\n    selected: {\r\n        background: CommonColor.BACKGROUND_GRADIENT,\r\n        \"& svg > *\": {\r\n            stroke: \"white\",\r\n        }\r\n    },\r\n    propBox: {\r\n        \"& > div\": {\r\n            marginBottom: theme.spacing(3),\r\n        }\r\n    }\r\n}))\r\n\r\nconst ShapePropBox = observer(() => {\r\n    const classes = useStyles();\r\n    const { shapeStore } = useStores();\r\n\r\n    return (\r\n        <PropBoxLayout>\r\n            <div className={classes.propBox}>\r\n                {!shapeStore.item && <div>\r\n                    <Box mb={1}>\r\n                        <Typography variant={\"caption\"}>모양</Typography>\r\n                    </Box>\r\n                    <Box display={\"flex\"}>\r\n                        <div\r\n                            className={clsx(classes.button, shapeStore.shapeType === ShapeType.ELLIPSE && classes.selected)}\r\n                            onClick={() => shapeStore.setShapeType(ShapeType.ELLIPSE)}\r\n                        >\r\n                            <svg height=\"24\" width=\"24\">\r\n                                <circle cx=\"12\" cy=\"12\" r=\"10\" stroke=\"black\" fill=\"transparent\" strokeWidth={2} />\r\n                            </svg>\r\n                        </div>\r\n                        <div\r\n                            className={clsx(classes.button, shapeStore.shapeType === ShapeType.RECT && classes.selected)}\r\n                            onClick={() => shapeStore.setShapeType(ShapeType.RECT)}\r\n                        >\r\n                            <svg width=\"24\" height=\"24\">\r\n                                <rect width=\"24\" height=\"24\" stroke=\"black\" fill=\"transparent\" strokeWidth={4} />\r\n                            </svg>\r\n                        </div>\r\n                        <div\r\n                            className={clsx(classes.button, shapeStore.shapeType === ShapeType.TRIANGLE && classes.selected)}\r\n                            onClick={() => shapeStore.setShapeType(ShapeType.TRIANGLE)}\r\n                        >\r\n                            <svg width=\"24\" height=\"24\">\r\n                                <polygon points=\"12,2 22,22 2,22\" stroke=\"black\" fill=\"transparent\" strokeWidth={2} />\r\n                            </svg>\r\n                        </div>\r\n                    </Box>\r\n                </div>}\r\n                <div>\r\n                    <Box mb={1}>\r\n                        <Typography variant={\"caption\"}>채우기</Typography>\r\n                        <div>\r\n                            <ColorSelect color={shapeStore.fill} onChange={(color: string | undefined) => shapeStore.setFill(color)} />\r\n                        </div>\r\n                    </Box>\r\n                </div>\r\n                <div>\r\n                    <Box mb={1}>\r\n                        <Typography variant={\"caption\"}>선 색상</Typography>\r\n                        <div>\r\n                            <ColorSelect color={shapeStore.stroke} onChange={(color: string | undefined) => shapeStore.setStroke(color)} />\r\n                        </div>\r\n                    </Box>\r\n                </div>\r\n                <div>\r\n                    <Range label=\"선 두께\" value={shapeStore.strokeWidth} onChange={(strokeWidth) => shapeStore.setStrokeWidth(strokeWidth)} prefix={\"px\"} />\r\n                </div>\r\n            </div>\r\n        </PropBoxLayout>\r\n    )\r\n})\r\n\r\nexport default ShapePropBox;","import makeStyles from \"@material-ui/core/styles/makeStyles\";\r\nimport React from \"react\";\r\nimport PropBoxLayout from \"./PropBoxLayout\";\r\nimport { AlignButton, ColorPicker, TextStyleButton } from \"../input\";\r\nimport { useStores } from \"hooks/useStores\";\r\nimport { observer } from \"mobx-react\";\r\nimport { Box, FormControl, Select } from \"@material-ui/core\";\r\nimport { MenuItem } from \"@material-ui/core\";\r\nimport { FontFaces, fontSizes } from \"models/tools/Text\";\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n    propBox: {\r\n        \"& > *\": {\r\n            marginBottom: theme.spacing(3),\r\n        }\r\n    }\r\n}));\r\n\r\nconst TextPropBox = observer(() => {\r\n    const classes = useStyles();\r\n    const { textStore } = useStores();\r\n\r\n    const handleFontSizeChange = (event: React.ChangeEvent<{ value: unknown }>) => {\r\n        const fontSize = parseInt(event.target.value as string, 10);\r\n        textStore.setFontSize(fontSize);\r\n    };\r\n\r\n    const handleFontFmailyChange = (event: React.ChangeEvent<{ value: unknown }>) => {\r\n        const fontFamily = event.target.value as string;\r\n        textStore.setFontFamily(fontFamily);\r\n    };\r\n\r\n    return (\r\n        <PropBoxLayout>\r\n            <div className={classes.propBox}>\r\n                <div>\r\n                    <FormControl fullWidth>\r\n                        <Select\r\n                            value={textStore.fontFamily}\r\n                            onChange={handleFontFmailyChange}\r\n                        >\r\n                            {FontFaces.values().map(font => (\r\n                                <MenuItem key={font.value} value={font.value}>{font.display}</MenuItem>\r\n                            ))}\r\n                        </Select>\r\n                    </FormControl>\r\n                </div>\r\n                <div>\r\n                    <Box display={\"flex\"}>\r\n                        <Box flex={1} mr={1.5}>\r\n                            <FormControl fullWidth>\r\n                                <Select\r\n                                    value={textStore.fontSize}\r\n                                    onChange={handleFontSizeChange}\r\n                                >\r\n                                    <MenuItem value={textStore.fontSize}>{textStore.fontSize}</MenuItem>\r\n                                    {fontSizes.map(fontSize => (\r\n                                        textStore.fontSize !== fontSize && <MenuItem key={fontSize} value={fontSize}>{fontSize}</MenuItem>\r\n                                    ))}\r\n                                </Select>\r\n                            </FormControl>\r\n                        </Box>\r\n                        <Box flexBasis={35}>\r\n                            <ColorPicker color={textStore.fill} onChange={(color) => textStore.setFill(color.hex)} />\r\n                        </Box>\r\n                    </Box>\r\n                </div>\r\n                <div>\r\n                    <TextStyleButton\r\n                        bold={textStore.isBold()}\r\n                        italic={textStore.isItalic()}\r\n                        underline={textStore.underline}\r\n                        toggleBold={(bold) => textStore.setBold(bold)}\r\n                        toggleItalic={(italic) => textStore.setItalic(italic)}\r\n                        toggleUnderline={(underline) => textStore.setUnderline(underline)}\r\n                    />\r\n                </div>\r\n                <div>\r\n                    <AlignButton textAlign={textStore.textAlign} onChange={(textAlign) => textStore.setTextAlign(textAlign)} />\r\n                </div>\r\n            </div>\r\n        </PropBoxLayout>\r\n    )\r\n})\r\n\r\nexport default TextPropBox;","import React from \"react\";\r\nimport { observer } from \"mobx-react\";\r\nimport makeStyles from \"@material-ui/core/styles/makeStyles\";\r\nimport { useStores } from \"../../hooks/useStores\";\r\nimport { ToolTypes } from \"../../models/tools/ToolTypes\";\r\nimport BrushPropBox from \"./BrushPropBox\";\r\nimport ShapePropBox from \"./ShapePropBox\";\r\nimport TextPropBox from \"./TextPropBox\";\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n    root: {\r\n        padding: theme.spacing(3),\r\n        height: \"100%\",\r\n    }\r\n}));\r\n\r\nconst PropBox = observer(() => {\r\n    const classes = useStyles();\r\n    const { canvasStore, objectManagerStore } = useStores();\r\n    const selectedTool = canvasStore.canvasMode;\r\n    const activeObject = objectManagerStore.activeObject;\r\n\r\n    return (\r\n        <React.Fragment>\r\n            <div className={classes.root}>\r\n                {!activeObject && <React.Fragment>\r\n                    {selectedTool === ToolTypes.BRUSH && (<BrushPropBox />)}\r\n                    {selectedTool === ToolTypes.SHAPE && (<ShapePropBox />)}\r\n                    {selectedTool === ToolTypes.TEXT && (<TextPropBox />)}\r\n                </React.Fragment>}\r\n                {activeObject && <React.Fragment>\r\n                    {objectManagerStore.isPath() && <BrushPropBox />}\r\n                    {objectManagerStore.isShape() && <ShapePropBox />}\r\n                    {objectManagerStore.isText() && <TextPropBox />}\r\n                </React.Fragment>}\r\n            </div>\r\n        </React.Fragment>\r\n    )\r\n})\r\n\r\nexport default PropBox;","import React from \"react\";\r\nimport {Layout} from \"../layout\";\r\nimport makeStyles from \"@material-ui/core/styles/makeStyles\";\r\nimport {PropBox, ToolBox} from \"../../components/tools\";\r\nimport {observer} from \"mobx-react\";\r\nimport {Toolbar} from \"@material-ui/core\";\r\nimport {useStores} from \"../../hooks/useStores\";\r\n\r\nconst leftMenuWidth = 260;\r\nconst useStyles = makeStyles((theme) => ({\r\n    root: {\r\n        display: \"flex\",\r\n        flexDirection: \"column\",\r\n        width: \"100vw\",\r\n        height: \"100vh\",\r\n    },\r\n    flexBox: {\r\n        display: \"flex\",\r\n        flex: 1,\r\n    },\r\n    contents: {\r\n        display: \"flex\",\r\n    },\r\n    left: {\r\n        flexBasis: `${leftMenuWidth}px`,\r\n        backgroundColor: \"#f0f0f0\",\r\n    },\r\n    canvasWrapper: {\r\n        display: \"flex\",\r\n        justifyContent: \"center\",\r\n        alignItems: \"center\",\r\n        flex: 1,\r\n        backgroundColor: \"#c0c0c0\",\r\n        padding: theme.spacing(3),\r\n    },\r\n}))\r\n\r\nconst Canvas = observer(() => {\r\n    const classes = useStyles();\r\n    const rootStore = useStores();\r\n    const canvasRef = React.useRef<HTMLDivElement>(null);\r\n\r\n    React.useEffect(() => {\r\n        if (!canvasRef.current) {\r\n            return;\r\n        }\r\n\r\n        rootStore.init(canvasRef.current);\r\n        return () => rootStore.onDestroy();\r\n    }, [rootStore, canvasRef]);\r\n\r\n    return (\r\n        <Layout>\r\n            <ToolBox/>\r\n            <div className={classes.root}>\r\n                <Toolbar variant={\"dense\"}/>\r\n                <div className={classes.flexBox}>\r\n                    <div className={classes.left}>\r\n                        <PropBox/>\r\n                    </div>\r\n                    <div className={classes.canvasWrapper} ref={canvasRef}/>\r\n                </div>\r\n            </div>\r\n        </Layout>\r\n    )\r\n})\r\n\r\nexport default Canvas;","import {Canvas} from 'templates/canvas';\r\nimport React from 'react';\r\n\r\nfunction App() {\r\n    return (\r\n        <Canvas/>\r\n    );\r\n}\r\n\r\nexport default App;\r\n","import { IEvent } from \"fabric/fabric-impl\";\r\nimport { RootStore, Store } from \"./rootStore\";\r\n\r\nexport enum MouseEventType {\r\n    MOUSE_UP = \"mouse:up\",\r\n    MOUSE_DOWN = \"mouse:down\",\r\n    MOUSE_MOVE = \"mouse:move\",\r\n}\r\n\r\nexport interface MouseEventObject {\r\n    startCursorPosition: {x: number, y: number},\r\n    currentCursorPosition: {x: number, y: number},\r\n}\r\n\r\nexport class MouseEventStore implements Store {\r\n    private readonly listeners: any;\r\n    private startCursorPosition = { x: 0, y: 0 };\r\n    private currentCursorPosition = { x: 0, y: 0 };\r\n    private observer: Map<MouseEventType, Array<(e: MouseEventObject) => void>> = new Map();\r\n\r\n    constructor(private readonly rootStore: RootStore) {\r\n        // this.addEventListeners();\r\n        this.listeners = {\r\n            onMouseDown: this.onMouseDown.bind(this),\r\n            onMouseUp: this.onMouseUp.bind(this),\r\n            onMouseMove: this.onMouseMove.bind(this),\r\n        }\r\n    }\r\n\r\n    onInit() {\r\n        this.addEventListeners();\r\n    }\r\n\r\n    onDestroy() {\r\n        this.removeEventListeners();\r\n    }\r\n\r\n    subscribe(eventType: MouseEventType, listener: (e: MouseEventObject) => void) {\r\n        if (!this.observer.has(eventType)) {\r\n            this.observer.set(eventType, []);\r\n        }\r\n        \r\n        this.observer.get(eventType)?.push(listener);\r\n    }\r\n\r\n    unsubscribe(eventType: MouseEventType, listener: (e: MouseEventObject) => void) {\r\n        this.observer.set(eventType, this.observer.get(eventType)?.filter(fn => fn !== listener) || []);\r\n    }\r\n\r\n    private onMouseDown(e: IEvent) {\r\n        this.startCursorPosition = { ...this.getCursorPosition(e) };\r\n        this.currentCursorPosition = { ...this.getCursorPosition(e) };\r\n\r\n        this.observer.get(MouseEventType.MOUSE_DOWN)?.forEach(callback => callback({\r\n            startCursorPosition: this.startCursorPosition,\r\n            currentCursorPosition: this.currentCursorPosition,    \r\n        }));\r\n    }\r\n\r\n    private onMouseMove(e: IEvent) {\r\n        this.currentCursorPosition = { ...this.getCursorPosition(e) };\r\n\r\n        this.observer.get(MouseEventType.MOUSE_MOVE)?.forEach(callback => callback({\r\n            startCursorPosition: this.startCursorPosition,\r\n            currentCursorPosition: this.currentCursorPosition,    \r\n        }));\r\n    }\r\n\r\n    private onMouseUp(e: IEvent) {\r\n        this.currentCursorPosition = { ...this.getCursorPosition(e) };\r\n\r\n        this.observer.get(MouseEventType.MOUSE_UP)?.forEach(callback => callback({\r\n            startCursorPosition: this.startCursorPosition,\r\n            currentCursorPosition: this.currentCursorPosition,    \r\n        }));\r\n    }\r\n\r\n    private addEventListeners() {\r\n        const { canvas } = this.rootStore.canvasStore;\r\n        canvas.on(MouseEventType.MOUSE_DOWN, this.listeners.onMouseDown);\r\n        canvas.on(MouseEventType.MOUSE_MOVE, this.listeners.onMouseMove);\r\n        canvas.on(MouseEventType.MOUSE_UP, this.listeners.onMouseUp);\r\n    }\r\n\r\n    private removeEventListeners() {\r\n        const { canvas } = this.rootStore.canvasStore;\r\n        canvas.off(MouseEventType.MOUSE_DOWN, this.listeners.onMouseDown);\r\n        canvas.off(MouseEventType.MOUSE_MOVE, this.listeners.onMouseMove);\r\n        canvas.off(MouseEventType.MOUSE_UP, this.listeners.onMouseUp);\r\n    }\r\n\r\n    private getCursorPosition(e: IEvent) {\r\n        return this.rootStore.canvasStore.canvas.getPointer(e.e);\r\n    }\r\n}","import { makeAutoObservable } from \"mobx\";\r\nimport { BrushType } from \"models/tools/Brush\";\r\nimport { RootStore, Store } from \"./rootStore\";\r\nimport { fabric } from \"fabric\";\r\nimport { ObjectManagerStore } from \"./objectManagerStore\";\r\nimport { CanvasModeManager } from \"./canvasStore\";\r\nimport { ToolTypes } from \"models/tools/ToolTypes\";\r\n\r\nconst defaultStyles = {\r\n    brushType: BrushType.PENCIL,\r\n    stroke: \"#000000\",\r\n    strokeWidth: 1,\r\n}\r\n\r\ninterface PathStyles {\r\n    stroke: string | undefined,\r\n    strokeWidth: number | undefined,\r\n}\r\n\r\nexport class BrushStore implements Store, CanvasModeManager {\r\n    brushType = defaultStyles.brushType;\r\n    stroke = defaultStyles.stroke;\r\n    strokeWidth = defaultStyles.strokeWidth;\r\n    item: fabric.Path | undefined;\r\n\r\n    private readonly listeners: any;\r\n    private readonly canvas: fabric.Canvas;\r\n    private readonly objectManager: ObjectManagerStore;\r\n\r\n    constructor(\r\n        private readonly rootStore: RootStore,\r\n    ) {\r\n        makeAutoObservable(this);\r\n        rootStore.canvasStore.registerCanvasModeManager(ToolTypes.BRUSH, this);\r\n        this.canvas = rootStore.canvasStore.canvas;\r\n        this.objectManager = rootStore.objectManagerStore;\r\n        this.listeners = {\r\n            updateObject: this.updateObject.bind(this),\r\n        }\r\n    }\r\n\r\n    onInit() {\r\n        this.addReactions();\r\n    }\r\n\r\n    onDestroy() {\r\n        this.removeReactions();\r\n    }\r\n\r\n    onSessionStart() {\r\n        this.canvas.isDrawingMode = true;\r\n        this.setBrushType(this.brushType);\r\n    }\r\n\r\n    onSessionEnd() {\r\n        this.canvas.isDrawingMode = false;\r\n    }\r\n\r\n    setBrushType(brushType: BrushType) {\r\n        this.brushType = brushType;\r\n        this.setFreeDrawingBrush();\r\n    }\r\n\r\n    setStroke(stroke: string | undefined) {\r\n        this.stroke = stroke || defaultStyles.stroke;\r\n        this.item?.set(\"stroke\", stroke);\r\n        this.canvas.freeDrawingBrush.color = this.stroke;\r\n        this.canvas.renderAll();\r\n    }\r\n\r\n    setStrokeWidth(strokeWidth: number | undefined) {\r\n        this.strokeWidth = strokeWidth || defaultStyles.strokeWidth;\r\n        this.item?.set(\"strokeWidth\", strokeWidth);\r\n        this.canvas.freeDrawingBrush.width = this.strokeWidth;\r\n        this.canvas.renderAll();\r\n    }\r\n\r\n    private setFreeDrawingBrush() {\r\n        this.canvas.freeDrawingBrush = this.rootStore.brushStore.brushType.getBrush(this.canvas);\r\n        this.canvas.freeDrawingBrush.color = this.stroke;\r\n        this.canvas.freeDrawingBrush.width = this.strokeWidth;\r\n    }\r\n\r\n    private updateObject(object: fabric.Object | undefined) {\r\n        if (this.isBrush(object)) {\r\n            this.item = object as fabric.Path;\r\n            this.updatePathStyles();\r\n        } else {\r\n            this.item = undefined;\r\n        }\r\n    }\r\n\r\n    private setPathStyles(styles: PathStyles) {\r\n        this.setStroke(styles.stroke);\r\n        this.setStrokeWidth(styles.strokeWidth);\r\n    }\r\n\r\n    private updatePathStyles() {\r\n        if (!this.item) {\r\n            return;\r\n        }\r\n\r\n        const {\r\n            stroke,\r\n            strokeWidth,\r\n        } = this.item;\r\n\r\n        this.setPathStyles({\r\n            stroke: stroke,\r\n            strokeWidth: strokeWidth,\r\n        })\r\n    }\r\n\r\n    private isBrush(object: fabric.Object | undefined) {\r\n        return object?.isType(\"path\");\r\n    }\r\n\r\n    private addReactions() {\r\n        this.objectManager.subscribe(this.listeners.updateObject);\r\n    }\r\n\r\n    private removeReactions() {\r\n        this.objectManager.unsubscribe(this.listeners.updateObject);\r\n    }\r\n}","import { makeAutoObservable } from \"mobx\";\r\nimport { ToolTypes } from \"models/tools/ToolTypes\";\r\nimport { RootStore, Store } from \"./rootStore\";\r\nimport {fabric} from \"fabric\";\r\n\r\nconst defaultStyles = {\r\n    width: 500,\r\n    height: 500,\r\n    backgroundColor: \"#ffffff\",\r\n}\r\n\r\nexport interface CanvasModeManager {\r\n    onSessionStart: () => void;\r\n    onSessionEnd: () => void;\r\n}\r\n\r\nexport class CanvasStore implements Store {\r\n    private readonly canvasModeManagers: Map<ToolTypes, CanvasModeManager> = new Map();\r\n\r\n    width = defaultStyles.width;\r\n    height = defaultStyles.height;\r\n    backgroundColor = defaultStyles.backgroundColor;\r\n    canvasMode = ToolTypes.BRUSH;\r\n\r\n    constructor(\r\n        private readonly rootStore: RootStore,\r\n        readonly canvas: fabric.Canvas,\r\n    ) {\r\n        makeAutoObservable(this);\r\n    }\r\n\r\n    onInit() {\r\n        this.canvas.setWidth(this.width);\r\n        this.canvas.setHeight(this.height);\r\n        this.canvas.setBackgroundColor(this.backgroundColor, () => {});\r\n        this.setCanvasMode(this.canvasMode);\r\n    }\r\n\r\n    onDestroy() {\r\n        this.canvas.dispose();\r\n    }\r\n\r\n    registerCanvasModeManager(mode: ToolTypes, manager: CanvasModeManager) {\r\n        this.canvasModeManagers.set(mode, manager);\r\n    }\r\n\r\n    setCanvasMode(mode: ToolTypes) {\r\n        const previousMode = this.canvasMode;\r\n        this.canvasMode = mode;\r\n\r\n        this.canvas.discardActiveObject().renderAll();\r\n        this.setAllCursor(\"default\");\r\n        this.setSelectable(false)\r\n\r\n        this.canvasModeManagers.get(previousMode)?.onSessionEnd();\r\n        this.canvasModeManagers.get(mode)?.onSessionStart();\r\n    }\r\n\r\n    setSelectable(selectable: boolean) {\r\n        this.canvas.selection = selectable;\r\n        this.canvas.getObjects().forEach(obj => {\r\n            obj.selectable = selectable;\r\n        });\r\n    }\r\n\r\n    setDefaultCursor(cursor: string) {\r\n        this.canvas.defaultCursor = cursor;\r\n    }\r\n\r\n    setHoverCursor(cursor: string) {\r\n        this.canvas.getObjects().forEach(obj => {\r\n            obj.hoverCursor = cursor;\r\n        });\r\n    }\r\n\r\n    setAllCursor(cursor: string) {\r\n        this.setDefaultCursor(cursor);\r\n        this.setHoverCursor(cursor);\r\n    }\r\n}","import { IEvent } from \"fabric/fabric-impl\";\r\nimport { makeAutoObservable, reaction } from \"mobx\";\r\nimport { ShapeType } from \"models/tools/Shape\";\r\nimport { CanvasStore } from \"./canvasStore\";\r\nimport { RootStore } from \"./rootStore\";\r\nimport {fabric} from \"fabric\";\r\n\r\nexport enum SelectionEventType {\r\n    SELECTION_CLEARED = \"selection:cleared\",\r\n    SELECTION_CREATED = \"selection:created\",\r\n    SELECTION_UPDATED = \"selection:updated\",\r\n}\r\n\r\nexport class ObjectManagerStore {\r\n    private readonly canvasStore: CanvasStore;\r\n    private readonly listeners: { [eventName: string]: (e: IEvent) => void }\r\n    private readonly observer: Set<(object: fabric.Object | undefined) => void> = new Set();\r\n\r\n    activeObject: fabric.Object | undefined;\r\n\r\n    constructor(\r\n        private readonly rootStore: RootStore,\r\n    ) {\r\n        makeAutoObservable(this);\r\n        this.canvasStore = rootStore.canvasStore;\r\n        this.listeners = {\r\n            onSelected: this.onSelected.bind(this),\r\n            onCleared: this.onCleared.bind(this),\r\n        }\r\n        this.addEventListeners();\r\n    }\r\n\r\n    private onSelected(e: IEvent) {\r\n        const { target } = e;\r\n        if (!target) {\r\n            return;\r\n        }\r\n\r\n        this.activeObject = target;\r\n    }\r\n\r\n    private onCleared() {\r\n        this.activeObject = undefined;\r\n    }\r\n\r\n    private addEventListeners() {\r\n        this.canvasStore.canvas.on(SelectionEventType.SELECTION_CREATED, this.listeners.onSelected);\r\n        this.canvasStore.canvas.on(SelectionEventType.SELECTION_UPDATED, this.listeners.onSelected);\r\n        this.canvasStore.canvas.on(SelectionEventType.SELECTION_CLEARED, this.listeners.onCleared);\r\n        reaction(\r\n            () => this.activeObject,\r\n            () => this.observer.forEach(callback => callback(this.activeObject)),\r\n        );\r\n    }\r\n\r\n    subscribe(listener: (object: fabric.Object | undefined) => void) {\r\n        this.observer.add(listener);\r\n    }\r\n\r\n    unsubscribe(listener: (object: fabric.Object | undefined) => void) {\r\n        console.trace('unsubscribe');\r\n        this.observer.delete(listener);\r\n    }\r\n\r\n    isRect() {\r\n        return this.activeObject?.isType(ShapeType.RECT.value);\r\n    }\r\n\r\n    isEllipse() {\r\n        return this.activeObject?.isType(ShapeType.ELLIPSE.value);\r\n    }\r\n\r\n    isTriangle() {\r\n        return this.activeObject?.isType(ShapeType.TRIANGLE.value);\r\n    }\r\n\r\n    isShape() {\r\n        return this.isRect() || this.isEllipse() || this.isTriangle();\r\n    }\r\n\r\n    isPath() {\r\n        return this.activeObject?.isType(\"path\");\r\n    }\r\n\r\n    isText() {\r\n        return this.activeObject?.isType(\"i-text\");\r\n    }\r\n\r\n    getObjectTypeName(): string {\r\n        if (this.isRect()) {\r\n            return ShapeType.RECT.display;\r\n        } else if (this.isEllipse()) {\r\n            return ShapeType.ELLIPSE.display;\r\n        } else if (this.isTriangle()) {\r\n            return ShapeType.TRIANGLE.display;\r\n        } else if (this.isPath()) {\r\n            return \"패스\";\r\n        } else if (this.isText()) {\r\n            return \"텍스트\";\r\n        } else {\r\n            return \"오브젝트\";\r\n        }\r\n    }\r\n}","import { IEvent } from \"fabric/fabric-impl\";\r\nimport { RootStore, Store } from \"./rootStore\";\r\n\r\nexport enum ObjectEventType {\r\n    OBJECT_SCALING = \"object:scaling\",\r\n    OBJECT_MODIFIED = \"object:modified\",\r\n}\r\n\r\nexport class ObjectEventStore implements Store {\r\n    private readonly listeners: any;\r\n    private readonly observer: Map<ObjectEventType, Set<(e: IEvent) => void>> = new Map();\r\n\r\n    constructor(private readonly rootStore: RootStore) {\r\n        this.listeners = {\r\n            onScaling: this.onScaling.bind(this),\r\n            onModified: this.onModified.bind(this),\r\n        }\r\n    }\r\n\r\n    onInit() {\r\n        this.addEventListener();\r\n    }\r\n\r\n    onDestroy() {\r\n        this.removeEventListener();\r\n    }\r\n\r\n    private addEventListener() {\r\n        const {canvas} = this.rootStore.canvasStore;\r\n        canvas.on(ObjectEventType.OBJECT_SCALING, this.listeners.onScaling);\r\n        canvas.on(ObjectEventType.OBJECT_MODIFIED, this.listeners.onModified);\r\n    }\r\n\r\n    private removeEventListener() {\r\n        const {canvas} = this.rootStore.canvasStore;\r\n        canvas.off(ObjectEventType.OBJECT_SCALING, this.listeners.onScaling);\r\n        canvas.off(ObjectEventType.OBJECT_MODIFIED, this.listeners.onModified);\r\n    }\r\n\r\n    private onScaling(e: IEvent) {\r\n        this.observer.get(ObjectEventType.OBJECT_SCALING)?.forEach(callbackFn => callbackFn(e));\r\n    }\r\n\r\n    private onModified(e: IEvent) {\r\n        this.observer.get(ObjectEventType.OBJECT_MODIFIED)?.forEach(callbackFn => callbackFn(e));\r\n    }\r\n\r\n    subscribe(eventType: ObjectEventType, listener: (e: IEvent) => void) {\r\n        if (!this.observer.has(eventType)) {\r\n            this.observer.set(eventType, new Set());\r\n        }\r\n\r\n        this.observer.get(eventType)?.add(listener);\r\n    }\r\n\r\n    unsubscribe(eventType: ObjectEventType, listener: (e: IEvent) => void) {\r\n        this.observer.get(eventType)?.delete(listener);\r\n    }\r\n}\r\n\r\nexport default ObjectEventStore;","import { makeAutoObservable } from \"mobx\";\r\nimport { ShapeType } from \"models/tools/Shape\";\r\nimport { ToolTypes } from \"models/tools/ToolTypes\";\r\nimport { CanvasModeManager } from \"./canvasStore\";\r\nimport { MouseEventObject, MouseEventStore, MouseEventType } from \"./mouseEventStore\";\r\nimport { ObjectManagerStore } from \"./objectManagerStore\";\r\nimport { RootStore, Store } from \"./rootStore\";\r\n\r\nconst defaultStyles = {\r\n    shapeType: ShapeType.ELLIPSE,\r\n    fill: undefined,\r\n    strokeWidth: 3,\r\n    stroke: \"#000000\",\r\n}\r\n\r\ninterface ShapeStyles {\r\n    fill: string | undefined;\r\n    strokeWidth: number;\r\n    stroke: string | undefined;\r\n}\r\n\r\nexport class ShapeStore implements Store, CanvasModeManager {\r\n    private static readonly MIN_OBJECT_SIZE = 30;\r\n    private readonly canvas: fabric.Canvas;\r\n    private readonly mouseEventStore: MouseEventStore;\r\n    private readonly objectManager: ObjectManagerStore;\r\n    private readonly listeners: any;\r\n    private isDragMode = false;\r\n\r\n    item: fabric.Rect | fabric.Triangle | fabric.Ellipse | undefined;\r\n    shapeType = defaultStyles.shapeType;\r\n    fill: string | undefined = defaultStyles.fill;\r\n    strokeWidth = defaultStyles.strokeWidth;\r\n    stroke: string | undefined = defaultStyles.stroke;\r\n\r\n    constructor(private readonly rootStore: RootStore) {\r\n        makeAutoObservable(this);\r\n        rootStore.canvasStore.registerCanvasModeManager(ToolTypes.SHAPE, this);\r\n        this.canvas = rootStore.canvasStore.canvas;\r\n        this.mouseEventStore = rootStore.mouseEventStore;\r\n        this.objectManager = rootStore.objectManagerStore;\r\n        this.listeners = {\r\n            onMouseUp: this.onMouseUp.bind(this),\r\n            onMouseDown: this.onMouseDown.bind(this),\r\n            onMouseMove: this.onMouseMove.bind(this),\r\n            updateObject: this.updateObject.bind(this),\r\n        }\r\n    }\r\n\r\n    onInit() {\r\n        this.addEventListeners();\r\n        this.addReactions();\r\n    }\r\n\r\n    onDestroy() {\r\n        this.removeEventListener();\r\n        this.removeReactions();\r\n    }\r\n\r\n    onSessionStart() {\r\n        this.rootStore.canvasStore.setAllCursor(\"crosshair\");\r\n    }\r\n\r\n    onSessionEnd() {\r\n        //\r\n    }\r\n\r\n    setShapeType(shapeType: ShapeType) {\r\n        this.shapeType = shapeType;\r\n    }\r\n\r\n    setFill(fill: string | undefined) {\r\n        this.fill = fill;\r\n        if (this.item) {\r\n            this.item.set({ fill: fill });\r\n            this.canvas.renderAll();\r\n        }\r\n    }\r\n\r\n    setStroke(stroke: string | undefined) {\r\n        this.stroke = stroke;\r\n        if (this.item) {\r\n            this.item.set({ stroke: stroke });\r\n            this.canvas.renderAll();\r\n        }\r\n    }\r\n\r\n    setStrokeWidth(strokeWidth: number) {\r\n        this.strokeWidth = strokeWidth;\r\n        if (this.item) {\r\n            this.item.set({ strokeWidth: strokeWidth });\r\n            this.canvas.renderAll();\r\n        }\r\n    }\r\n\r\n    private addReactions() {\r\n        this.objectManager.subscribe(this.listeners.updateObject);\r\n    }\r\n\r\n    private removeReactions() {\r\n        this.objectManager.unsubscribe(this.listeners.updateObject);\r\n    }\r\n\r\n    private updateObject(object: fabric.Object | undefined) {\r\n        if (this.isShape(object)) {\r\n            this.item = object;\r\n            this.updateShapeStyles();\r\n        } else {\r\n            this.item = undefined;\r\n        }\r\n    }\r\n\r\n    private setShapeStyles(styles: ShapeStyles) {\r\n        this.setFill(styles.fill);\r\n        this.setStroke(styles.stroke);\r\n        this.setStrokeWidth(styles.strokeWidth);\r\n    }\r\n\r\n    private updateShapeStyles() {\r\n        if (!this.item) {\r\n            return;\r\n        }\r\n\r\n        const {\r\n            stroke,\r\n            strokeWidth,\r\n            fill,\r\n        } = this.item;\r\n\r\n        this.setShapeStyles({\r\n            fill: fill === undefined ? fill : fill as string,\r\n            stroke: stroke,\r\n            strokeWidth: strokeWidth || defaultStyles.strokeWidth,\r\n        })\r\n    }\r\n\r\n    private addEventListeners() {\r\n        this.mouseEventStore.subscribe(MouseEventType.MOUSE_UP, this.listeners.onMouseUp);\r\n        this.mouseEventStore.subscribe(MouseEventType.MOUSE_DOWN, this.listeners.onMouseDown);\r\n        this.mouseEventStore.subscribe(MouseEventType.MOUSE_MOVE, this.listeners.onMouseMove);\r\n    }\r\n\r\n    private removeEventListener() {\r\n        this.mouseEventStore.unsubscribe(MouseEventType.MOUSE_UP, this.listeners.onMouseUp);\r\n        this.mouseEventStore.unsubscribe(MouseEventType.MOUSE_DOWN, this.listeners.onMouseDown);\r\n        this.mouseEventStore.unsubscribe(MouseEventType.MOUSE_MOVE, this.listeners.onMouseMove);\r\n    }\r\n\r\n    private isShapeTool() {\r\n        return this.rootStore.canvasStore.canvasMode === ToolTypes.SHAPE;\r\n    }\r\n\r\n    private isShape(object: fabric.Object | undefined) {\r\n        return object?.isType(ShapeType.ELLIPSE.value) || object?.isType(ShapeType.RECT.value) || object?.isType(ShapeType.TRIANGLE.value);\r\n    }\r\n\r\n    private onMouseDown(e: MouseEventObject) {\r\n        if (!this.isShapeTool()) {\r\n            return;\r\n        }\r\n\r\n        this.isDragMode = true;\r\n        this.item = this.shapeType.getShape({\r\n            left: e.startCursorPosition.x,\r\n            top: e.startCursorPosition.y,\r\n            stroke: this.stroke,\r\n            strokeWidth: this.strokeWidth,\r\n            fill: this.fill,\r\n            selectable: false,\r\n            hoverCursor: \"default\",\r\n            strokeUniform: true,\r\n        });\r\n\r\n        if (this.item.isType(ShapeType.RECT.value) || this.item.isType(ShapeType.TRIANGLE.value)) {\r\n            this.item.set({\r\n                width: 0,\r\n                height: 0,\r\n            })\r\n        } else if (this.item.isType(ShapeType.ELLIPSE.value)) {\r\n            (this.item as fabric.Ellipse).set({\r\n                rx: 0,\r\n                ry: 0,\r\n            })\r\n        }\r\n\r\n        this.rootStore.canvasStore.canvas.add(this.item);\r\n    }\r\n\r\n    private onMouseMove(e: MouseEventObject) {\r\n        if (!this.isShapeTool() || !this.isDragMode || !this.item) {\r\n            return;\r\n        }\r\n\r\n        if (e.currentCursorPosition.x < e.startCursorPosition.x) {\r\n            this.item.set({ left: Math.abs(e.currentCursorPosition.x) });\r\n        }\r\n\r\n        if (e.currentCursorPosition.y < e.startCursorPosition.y) {\r\n            this.item.set({ top: Math.abs(e.currentCursorPosition.y) });\r\n        }\r\n\r\n        this.item.set({ flipX: e.currentCursorPosition.x < e.startCursorPosition.x });\r\n        this.item.set({ flipY: e.currentCursorPosition.y < e.startCursorPosition.y });\r\n\r\n        if (this.item.isType(ShapeType.RECT.value) || this.item.isType(ShapeType.TRIANGLE.value)) {\r\n            this.item.set({\r\n                width: Math.abs(e.startCursorPosition.x - e.currentCursorPosition.x),\r\n                height: Math.abs(e.startCursorPosition.y - e.currentCursorPosition.y),\r\n            });\r\n        } else if (this.item.isType(ShapeType.ELLIPSE.value)) {\r\n            (this.item as fabric.Ellipse).set({\r\n                rx: Math.abs(e.startCursorPosition.x - e.currentCursorPosition.x) / 2,\r\n                ry: Math.abs(e.startCursorPosition.y - e.currentCursorPosition.y) / 2,\r\n            })\r\n        }\r\n\r\n        this.rootStore.canvasStore.canvas.renderAll();\r\n    }\r\n\r\n    private onMouseUp(e: MouseEventObject) {\r\n        if (!this.isShapeTool() || !this.item) {\r\n            return;\r\n        }\r\n\r\n        this.isDragMode = false;\r\n        if (this.item.isType(ShapeType.RECT.value) || this.item.isType(ShapeType.TRIANGLE.value)) {\r\n            this.item.set({\r\n                width: Math.max(ShapeStore.MIN_OBJECT_SIZE, this.item.width || ShapeStore.MIN_OBJECT_SIZE),\r\n                height: Math.max(ShapeStore.MIN_OBJECT_SIZE, this.item.height || ShapeStore.MIN_OBJECT_SIZE),\r\n            }).setCoords();\r\n        } else if (this.item.isType(ShapeType.ELLIPSE.value)) {\r\n            const circle = this.item as fabric.Ellipse;\r\n            circle.set({\r\n                rx: Math.max(ShapeStore.MIN_OBJECT_SIZE / 2, circle.rx || ShapeStore.MIN_OBJECT_SIZE / 2),\r\n                ry: Math.max(ShapeStore.MIN_OBJECT_SIZE / 2, circle.ry || ShapeStore.MIN_OBJECT_SIZE / 2),\r\n            }).setCoords();\r\n        }\r\n\r\n        const canvasStore = this.rootStore.canvasStore;\r\n        canvasStore.setCanvasMode(ToolTypes.SELECT);\r\n        canvasStore.canvas.setActiveObject(this.item);\r\n        canvasStore.canvas.renderAll();\r\n\r\n        this.item = undefined;\r\n    }\r\n}","import { makeAutoObservable } from \"mobx\";\r\nimport { RootStore } from \"./rootStore\";\r\n\r\nexport class UIStore {\r\n    constructor(private readonly rootStore: RootStore) {\r\n        makeAutoObservable(this);;\r\n    }\r\n}","import { MouseEventObject, MouseEventStore, MouseEventType } from \"./mouseEventStore\";\r\nimport { RootStore, Store } from \"./rootStore\";\r\nimport { fabric } from \"fabric\";\r\nimport { ToolTypes } from \"models/tools/ToolTypes\";\r\nimport { ObjectEventStore, ObjectEventType } from \"./objectEventStore\";\r\nimport { IEvent } from \"fabric/fabric-impl\";\r\nimport { ObjectManagerStore } from \"./objectManagerStore\";\r\nimport { makeAutoObservable } from \"mobx\";\r\nimport { FontFaces, fontSizes, FontStyle, FontWeight, TextAlign } from \"models/tools/Text\";\r\nimport WebFont from \"webfontloader\";\r\nimport { CanvasModeManager } from \"./canvasStore\";\r\n\r\nconst defaultStyles = {\r\n    FONT_SIZE: fontSizes[fontSizes.length / 2],\r\n    FILL: \"#000000\",\r\n    FONT_FAMILY: FontFaces.TIMES_NEW_ROMAN.value,\r\n    TEXT_ALIGN: TextAlign.LEFT,\r\n    FONT_STYLE: FontStyle.NORMAL,\r\n    FONT_WEIGHT: FontWeight.NORMAL,\r\n    UNDERLINE: false,\r\n}\r\n\r\ninterface TextStyles {\r\n    fontSize: number,\r\n    fill: string,\r\n    fontFamily: string,\r\n    textAlign: string,\r\n    fontStyle: string,\r\n    fontWeight: string | number,\r\n    underline: boolean,\r\n}\r\n\r\nexport class TextStore implements Store, CanvasModeManager {\r\n    private readonly objectManager: ObjectManagerStore;\r\n    private readonly mouseEventStore: MouseEventStore;\r\n    private readonly objectEventStore: ObjectEventStore;\r\n    private readonly canvas: fabric.Canvas;\r\n    private readonly listeners: any;\r\n    private fontStyle = defaultStyles.FONT_STYLE;\r\n    private fontWeight = defaultStyles.FONT_WEIGHT;\r\n    private autoRenderId: NodeJS.Timeout | undefined;\r\n\r\n    fontSize = defaultStyles.FONT_SIZE;\r\n    fill = defaultStyles.FILL;\r\n    fontFamily = defaultStyles.FONT_FAMILY;\r\n    textAlign = defaultStyles.TEXT_ALIGN;\r\n    underline = defaultStyles.UNDERLINE;\r\n    item: fabric.IText | undefined;\r\n\r\n    constructor(private readonly rootStore: RootStore) {\r\n        makeAutoObservable(this);\r\n        rootStore.canvasStore.registerCanvasModeManager(ToolTypes.TEXT, this);\r\n        this.loadFont();\r\n        this.objectManager = rootStore.objectManagerStore;\r\n        this.mouseEventStore = rootStore.mouseEventStore;\r\n        this.objectEventStore = rootStore.objectEventStore;\r\n        this.canvas = rootStore.canvasStore.canvas;\r\n        this.listeners = {\r\n            onMouseUp: this.onMouseUp.bind(this),\r\n            onModified: this.onModified.bind(this),\r\n            updateObject: this.updateObject.bind(this),\r\n        }\r\n    }\r\n\r\n    onInit() {\r\n        this.addEventListener();\r\n        this.addFontAutoRender();\r\n    }\r\n\r\n    onDestroy() {\r\n        this.removeEventListener();\r\n        this.removeFontAutoRender();\r\n    }\r\n\r\n    onSessionStart() {\r\n        this.rootStore.canvasStore.setAllCursor(\"text\");\r\n    }\r\n\r\n    onSessionEnd() {\r\n        //\r\n    }\r\n\r\n    setFontSize(fontSize: number) {\r\n        this.fontSize = fontSize;\r\n        if (this.item) {\r\n            this.item.set({ fontSize: fontSize });\r\n            this.canvas.renderAll();\r\n        }\r\n    }\r\n\r\n    setFill(fill: string) {\r\n        this.fill = fill;\r\n        if (this.item) {\r\n            this.item.set({ fill: fill });\r\n            this.canvas.renderAll();\r\n        }\r\n    }\r\n\r\n    setFontFamily(fontFamily: string) {\r\n        this.fontFamily = fontFamily;\r\n        if (this.item) {\r\n            this.item.set({ fontFamily: fontFamily });\r\n            this.canvas.renderAll();\r\n        }\r\n    }\r\n\r\n    setTextAlign(textAlign: string) {\r\n        this.textAlign = textAlign;\r\n        if (this.item) {\r\n            this.item.set({ textAlign: textAlign });\r\n            this.canvas.renderAll();\r\n        }\r\n    }\r\n\r\n    setUnderline(underline: boolean) {\r\n        this.underline = underline;\r\n        if (this.item) {\r\n            this.item.set({ underline: underline });\r\n            this.canvas.renderAll();\r\n        }\r\n    }\r\n\r\n    setBold(bold: boolean) {\r\n        const changedValue = bold ? FontWeight.BOLD : FontWeight.NORMAL;\r\n        this.fontWeight = changedValue;\r\n        if (this.item) {\r\n            this.item.set({ fontWeight: changedValue });\r\n            this.canvas.renderAll();\r\n        }\r\n    }\r\n\r\n    isBold() {\r\n        return this.fontWeight === FontWeight.BOLD;\r\n    }\r\n\r\n    setItalic(italic: boolean) {\r\n        const changedValue = italic ? FontStyle.ITALIC : FontStyle.NORMAL;\r\n        this.fontStyle = changedValue;\r\n        if (this.item) {\r\n            this.item.set({ fontStyle: changedValue as any });\r\n            this.canvas.renderAll();\r\n        }\r\n    }\r\n\r\n    isItalic() {\r\n        return this.fontStyle === FontStyle.ITALIC;\r\n    }\r\n\r\n    private addEventListener() {\r\n        this.mouseEventStore.subscribe(MouseEventType.MOUSE_UP, this.listeners.onMouseUp);\r\n        this.objectEventStore.subscribe(ObjectEventType.OBJECT_MODIFIED, this.listeners.onModified);\r\n        this.objectManager.subscribe(this.listeners.updateObject);\r\n    }\r\n\r\n    private removeEventListener() {\r\n        this.mouseEventStore.unsubscribe(MouseEventType.MOUSE_UP, this.listeners.onMouseUp);\r\n        this.objectEventStore.unsubscribe(ObjectEventType.OBJECT_MODIFIED, this.listeners.onModified);\r\n        this.objectManager.unsubscribe(this.listeners.updateObject);\r\n    }\r\n\r\n    private updateObject(object: fabric.Object | undefined) {\r\n        if (object && this.isText(object)) {\r\n            this.item = object as fabric.IText;\r\n            this.updateTextStyles();\r\n        } else {\r\n            this.item = undefined;\r\n        }\r\n    }\r\n\r\n    private updateTextStyles() {\r\n        if (!this.item) {\r\n            return;\r\n        }\r\n\r\n        const {\r\n            fontSize,\r\n            fill,\r\n            fontFamily,\r\n            textAlign,\r\n            fontStyle,\r\n            fontWeight,\r\n            underline,\r\n        } = this.item;\r\n\r\n        this.setTextStyles({\r\n            fontSize: fontSize || defaultStyles.FONT_SIZE,\r\n            fill: !fill ? defaultStyles.FILL : fill as string,\r\n            fontFamily: fontFamily || defaultStyles.FONT_FAMILY,\r\n            textAlign: textAlign || defaultStyles.TEXT_ALIGN,\r\n            fontStyle: fontStyle || defaultStyles.FONT_STYLE,\r\n            fontWeight: fontWeight || defaultStyles.FONT_WEIGHT,\r\n            underline: !!underline,\r\n        })\r\n    }\r\n\r\n    private setTextStyles(styles: TextStyles) {\r\n        this.setFontSize(styles.fontSize);\r\n        this.setFill(styles.fill);\r\n        this.setFontFamily(styles.fontFamily);\r\n        this.setTextAlign(styles.textAlign);\r\n    }\r\n\r\n    private onMouseUp(e: MouseEventObject) {\r\n        if (!this.isTextTool()) {\r\n            return;\r\n        }\r\n\r\n        this.item = new fabric.IText(\"텍스트를 입력해주세요\", {\r\n            top: e.currentCursorPosition.y,\r\n            left: e.currentCursorPosition.x,\r\n            fontFamily: this.fontFamily,\r\n            fontSize: this.fontSize,\r\n            textAlign: this.textAlign,\r\n            lockUniScaling: true,\r\n            fill: this.fill,\r\n        });\r\n\r\n        this.item.setControlVisible(\"mt\", false);\r\n        this.item.setControlVisible(\"mb\", false);\r\n        this.item.setControlVisible(\"ml\", false);\r\n        this.item.setControlVisible(\"mr\", false);\r\n\r\n        const canvasStore = this.rootStore.canvasStore;\r\n        canvasStore.canvas.add(this.item);\r\n        canvasStore.setCanvasMode(ToolTypes.SELECT);\r\n        canvasStore.canvas.setActiveObject(this.item);\r\n\r\n        this.item.selectAll();\r\n        this.item.enterEditing();\r\n    }\r\n\r\n    private onModified(e: IEvent) {\r\n        const { target } = e;\r\n        if (!target || !this.isText(target)) {\r\n            return;\r\n        }\r\n\r\n        const text = target as fabric.IText;\r\n        const fontSize = parseInt(((text.fontSize || defaultStyles.FONT_SIZE) * (text.scaleX || 1)).toFixed(0), 10);\r\n        text.set({\r\n            scaleX: 1,\r\n            scaleY: 1,\r\n        });\r\n        this.setFontSize(fontSize);\r\n    }\r\n\r\n    private isTextTool() {\r\n        return this.rootStore.canvasStore.canvasMode === ToolTypes.TEXT;\r\n    }\r\n\r\n    private isText(object: fabric.Object) {\r\n        return object.isType(\"i-text\");\r\n    }\r\n\r\n    private loadFont() {\r\n        WebFont.load({\r\n            google: {\r\n                families: FontFaces.getGoogleFonts().map(font => font.value),\r\n            },\r\n        })\r\n    }\r\n\r\n    private addFontAutoRender() {\r\n        this.autoRenderId = setInterval(() => {\r\n            this.canvas.getActiveObjects()\r\n                .filter(object => this.isText(object))\r\n                .forEach((object) => {\r\n                    const textObject = object as fabric.IText;\r\n                    textObject.initDimensions();\r\n                    textObject.dirty = true;\r\n                });\r\n            fabric.util.clearFabricFontCache();\r\n            this.canvas.renderAll();\r\n        }, 1000);\r\n    }\r\n\r\n    private removeFontAutoRender() {\r\n        if (this.autoRenderId) {\r\n            clearInterval(this.autoRenderId);\r\n        }\r\n    }\r\n}","import { ToolTypes } from \"models/tools/ToolTypes\";\r\nimport { CanvasModeManager } from \"./canvasStore\";\r\nimport { RootStore } from \"./rootStore\";\r\n\r\nexport class SelectStore implements CanvasModeManager {\r\n    constructor(private readonly rootStore: RootStore) {\r\n        rootStore.canvasStore.registerCanvasModeManager(ToolTypes.SELECT, this);\r\n    }\r\n\r\n    onSessionStart() {\r\n        this.rootStore.canvasStore.setSelectable(true);\r\n        this.rootStore.canvasStore.setHoverCursor(\"move\");\r\n    }\r\n\r\n    onSessionEnd() {\r\n        //\r\n    }\r\n}","import { fabric } from \"fabric\";\r\nimport { BrushStore } from \"./brushStore\";\r\nimport { CanvasStore } from \"./canvasStore\";\r\nimport { MouseEventStore } from \"./mouseEventStore\";\r\nimport { ObjectManagerStore } from \"./objectManagerStore\";\r\nimport { ObjectEventStore } from \"./objectEventStore\";\r\nimport { ShapeStore } from \"./shapeStore\";\r\nimport { UIStore } from \"./UIStore\";\r\nimport { TextStore } from \"./textStore\";\r\nimport { SelectStore } from \"./selectStore\";\r\n\r\nexport interface Store {\r\n    onInit: () => void;\r\n    onDestroy: () => void;\r\n}\r\n\r\nexport class RootStore implements Store {\r\n    private readonly canvasElement: HTMLCanvasElement;\r\n    canvasStore: CanvasStore;\r\n    objectManagerStore: ObjectManagerStore;\r\n    objectEventStore: ObjectEventStore;\r\n    mouseEventStore: MouseEventStore;\r\n    brushStore: BrushStore;\r\n    shapeStore: ShapeStore;\r\n    textStore: TextStore;\r\n    selectStore: SelectStore;\r\n    UIStore: UIStore;\r\n\r\n    constructor() {\r\n        this.canvasElement = document.createElement(\"canvas\");\r\n        document.body.append(this.canvasElement);\r\n\r\n        this.canvasStore = new CanvasStore(this, new fabric.Canvas(this.canvasElement));\r\n        this.objectManagerStore = new ObjectManagerStore(this);\r\n        this.objectEventStore = new ObjectEventStore(this);\r\n        this.mouseEventStore = new MouseEventStore(this);\r\n        this.brushStore = new BrushStore(this);\r\n        this.shapeStore = new ShapeStore(this);\r\n        this.textStore = new TextStore(this);\r\n        this.selectStore = new SelectStore(this);\r\n        this.UIStore = new UIStore(this);\r\n    }\r\n\r\n    onInit() {\r\n        //\r\n    }\r\n\r\n    onDestroy() {\r\n        Object.values(this).forEach(obj => {\r\n            if (obj.onDestory) {\r\n                obj.onDestory();\r\n            }\r\n        });\r\n    }\r\n\r\n    init(container: HTMLElement): void {\r\n        container.append(this.canvasElement.parentElement as Node);\r\n        Object.values(this).forEach(obj => {\r\n            if (obj.onInit) {\r\n                obj.onInit();\r\n            }\r\n        });\r\n    }\r\n}\r\n\r\nexport default new RootStore();","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport App from './App';\r\nimport {StoreProvider} from \"./contexts/storeContext\";\r\nimport rootStore from \"./stores/rootStore\";\r\n\r\nReactDOM.render(\r\n    <React.StrictMode>\r\n        <StoreProvider value={rootStore}>\r\n            <App/>\r\n        </StoreProvider>\r\n    </React.StrictMode>,\r\n    document.getElementById('root')\r\n);"],"sourceRoot":""}