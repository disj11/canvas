(this.webpackJsonpcanvas=this.webpackJsonpcanvas||[]).push([[0],{152:function(e,t){},153:function(e,t){},154:function(e,t){},157:function(e,t,n){"use strict";n.r(t);var c,a=n(2),i=n(0),s=n.n(i),r=n(10),o=n.n(r),u=n(187),l=n(188),h=n(20),j=n.n(h),d=j()((function(){return{progressWrapper:{display:"flex",justifyContent:"center",alignItems:"center"}}})),b=function(e){var t=e.loading,n=e.children,c=d();return Object(a.jsxs)(s.a.Fragment,{children:[Object(a.jsx)(u.a,{}),Object(a.jsx)("div",{children:t?Object(a.jsx)("div",{className:c.progressWrapper,children:Object(a.jsx)(l.a,{})}):n})]})},v=n(75),f=n(5),O=j()((function(e){return{button:{display:"inline-block",cursor:"pointer",color:"#fff",paddingTop:e.spacing(.5),paddingBottom:e.spacing(.5),paddingRight:e.spacing(3),paddingLeft:e.spacing(3),textAlign:"center"},caption:{fontSize:"0.70rem"},selected:{background:"linear-gradient(90deg, rgba(172,118,255,1) 0%, rgba(91,91,255,1) 100%)"}}})),p=function(e){var t=e.icon,n=e.text,c=e.onClick,i=e.selected,s=O();return Object(a.jsxs)("div",{className:Object(f.a)(s.button,Object(v.a)({},s.selected,i)),onClick:c,children:[t,Object(a.jsx)("div",{className:s.caption,children:n})]})},x=n(191),g=n(192),y=n(24),C=n(12),S=n(14),T=n(11),E=n(22);!function(e){e[e.SELECT=0]="SELECT",e[e.BRUSH=1]="BRUSH",e[e.SHAPE=2]="SHAPE"}(c||(c={}));var k=n(77),w=n(76),m=function(){function e(t){Object(C.a)(this,e),this.canvasStore=t}return Object(S.a)(e,[{key:"resetCanvas",value:function(){this.canvasStore.canvas.isDrawingMode=!1,this.canvasStore.selectable=!1,this.canvasStore.canvas.defaultCursor="default",this.canvasStore.canvas.discardActiveObject().renderAll()}},{key:"select",value:function(){this.resetCanvas(),this.setTool()}}]),e}(),_=function(){function e(){Object(C.a)(this,e)}return Object(S.a)(e,null,[{key:"getInstance",value:function(e){switch(e.selectedTool){case c.SELECT:return new P(e);case c.BRUSH:return new I(e);case c.SHAPE:return new N(e);default:return new I(e)}}}]),e}(),P=function(e){Object(k.a)(n,e);var t=Object(w.a)(n);function n(){return Object(C.a)(this,n),t.apply(this,arguments)}return Object(S.a)(n,[{key:"setTool",value:function(){this.canvasStore.selectable=!0}}]),n}(m),I=function(e){Object(k.a)(n,e);var t=Object(w.a)(n);function n(){return Object(C.a)(this,n),t.apply(this,arguments)}return Object(S.a)(n,[{key:"setTool",value:function(){this.canvasStore.canvas.isDrawingMode=!0}}]),n}(m),N=function(e){Object(k.a)(n,e);var t=Object(w.a)(n);function n(){return Object(C.a)(this,n),t.apply(this,arguments)}return Object(S.a)(n,[{key:"setTool",value:function(){this.canvasStore.canvas.defaultCursor="crosshair"}}]),n}(m),R=n(46),L=10,M=function(){function e(t){Object(C.a)(this,e),this.canvasStore=t,this.shareObject={e:{},canvasStore:this.canvasStore,startCursorPosition:{x:0,y:0},currentCursorPosition:{x:0,y:0},isDown:!1}}return Object(S.a)(e,[{key:"init",value:function(){var t=this.canvasStore.canvas;t.on(e.MOUSE_UP,this.handleMouseUp.bind(this)),t.on(e.MOUSE_MOVE,this.handleMouseMove.bind(this)),t.on(e.MOUSE_DOWN,this.handleMouseDown.bind(this)),t.on(e.SELECTION_CREATED,this.handleSelectObject.bind(this)),t.on(e.SELECTION_UPDATED,this.handleSelectObject.bind(this)),t.on(e.SELECTION_CLEARED,this.handleDeSelectObject.bind(this))}},{key:"handleSelectObject",value:function(){var e=this.canvasStore.canvas;this.canvasStore.activeObject=e.getActiveObject(),this.canvasStore.activeObjects=e.getActiveObjects()}},{key:"handleDeSelectObject",value:function(){this.canvasStore.activeObject=void 0,this.canvasStore.activeObjects=[]}},{key:"handleMouseUp",value:function(e){var t;this.shareObject.e=e,this.shareObject.isDown=!1,null===(t=A.getInstance(this.canvasStore))||void 0===t||t.handle(this.shareObject)}},{key:"handleMouseDown",value:function(e){var t;this.shareObject.e=e,this.shareObject.isDown=!0,this.shareObject.startCursorPosition=Object(R.a)({},this.getCursorPosition(e)),this.shareObject.currentCursorPosition=Object(R.a)({},this.getCursorPosition(e)),null===(t=B.getInstance(this.canvasStore))||void 0===t||t.handle(this.shareObject)}},{key:"handleMouseMove",value:function(e){var t;(this.shareObject.e=e,this.shareObject.currentCursorPosition=Object(R.a)({},this.getCursorPosition(e)),this.shareObject.isDown)&&(null===(t=D.getInstance(this.canvasStore))||void 0===t||t.handle(this.shareObject))}},{key:"getCursorPosition",value:function(e){return this.canvasStore.canvas.getPointer(e.e)}}]),e}();M.MOUSE_UP="mouse:up",M.MOUSE_DOWN="mouse:down",M.MOUSE_MOVE="mouse:move",M.SELECTION_CLEARED="selection:cleared",M.SELECTION_CREATED="selection:created",M.SELECTION_UPDATED="selection:updated";var A=function(){function e(){Object(C.a)(this,e)}return Object(S.a)(e,null,[{key:"getInstance",value:function(e){switch(e.selectedTool){case c.SHAPE:return new U;default:return null}}}]),e}(),B=function(){function e(){Object(C.a)(this,e)}return Object(S.a)(e,null,[{key:"getInstance",value:function(e){switch(e.selectedTool){case c.SHAPE:return new H;default:return null}}}]),e}(),D=function(){function e(){Object(C.a)(this,e)}return Object(S.a)(e,null,[{key:"getInstance",value:function(e){switch(e.selectedTool){case c.SHAPE:return new W;default:return null}}}]),e}(),U=function(){function e(){Object(C.a)(this,e)}return Object(S.a)(e,[{key:"handle",value:function(e){if(e.object.isType("rect")||e.object.isType("triangle"))e.object.set({width:Math.max(L,e.object.width||L),height:Math.max(L,e.object.height||L)}).setCoords();else if(e.object.isType("circle")){var t=e.object;t.set("radius",Math.max(L,t.radius||L)).setCoords()}e.canvasStore.canvas.renderAll()}}]),e}(),H=function(){function e(){Object(C.a)(this,e)}return Object(S.a)(e,[{key:"handle",value:function(e){e.object=e.canvasStore.shapeType.getShape({left:e.startCursorPosition.x,top:e.startCursorPosition.y,hasBorder:!0,stroke:"#000",strokeWidth:3,fill:"transparent",selectable:!1,hoverCursor:"default"}),e.object.isType("rect")||e.object.isType("triangle")?e.object.set({width:0,height:0}):e.object.isType("circle")&&e.object.set("radius",0),e.canvasStore.canvas.add(e.object)}}]),e}(),W=function(){function e(){Object(C.a)(this,e)}return Object(S.a)(e,[{key:"handle",value:function(e){e.currentCursorPosition.x<e.startCursorPosition.x&&e.object.set("left",Math.abs(e.currentCursorPosition.x)),e.currentCursorPosition.y<e.startCursorPosition.y&&e.object.set("top",Math.abs(e.currentCursorPosition.y)),e.object.isType("rect")||e.object.isType("triangle")?e.object.set({width:Math.abs(e.startCursorPosition.x-e.currentCursorPosition.x),height:Math.abs(e.startCursorPosition.y-e.currentCursorPosition.y)}):e.object.isType("circle")&&e.object.set("radius",Math.abs(e.startCursorPosition.x-e.currentCursorPosition.x)),e.canvasStore.canvas.renderAll()}}]),e}(),z=function(){function e(t,n){Object(C.a)(this,e),this.value=t,this.display=n,e._values.push(this)}return Object(S.a)(e,[{key:"getBrush",value:function(t){switch(this){case e.PENCIL:return new E.fabric.PencilBrush(t);case e.CIRCLE:return new E.fabric.CircleBrush(t);case e.SPRAY:return new E.fabric.SprayBrush(t);default:return new E.fabric.PencilBrush(t)}}}],[{key:"values",value:function(){return this._values}},{key:"valueOf",value:function(e){return this.values().find((function(t){return t.value===e}))}}]),e}();z._values=[],z.PENCIL=new z("pencil","\uc5f0\ud544"),z.CIRCLE=new z("circle","\uc6d0\ud615"),z.SPRAY=new z("spray","\uc2a4\ud504\ub808\uc774");var J=function(){function e(t,n){Object(C.a)(this,e),this.value=t,this.display=n,e._values.push(this)}return Object(S.a)(e,[{key:"getShape",value:function(t){switch(this){case e.RECT:return new E.fabric.Rect(t);case e.CIRCLE:return new E.fabric.Circle(t);case e.TRIANGLE:return new E.fabric.Triangle(t);default:return new E.fabric.Rect(t)}}}],[{key:"values",value:function(){return this._values}},{key:"valueOf",value:function(e){return this.values().find((function(t){return t.value===e}))}}]),e}();J._values=[],J.RECT=new J("rect","\uc0ac\uac01\ud615"),J.CIRCLE=new J("circle","\uc6d0"),J.TRIANGLE=new J("triangle","\uc0bc\uac01\ud615");var F,G=function(){function e(){Object(C.a)(this,e),this.canvasId="canvas",this._canvas={},this._width=500,this._height=500,this._backgroundColor="white",this._selectedTool=c.SELECT,this._selectable=!1,this._brushType=z.PENCIL,this._shapeType=J.RECT,this._activeObject=void 0,this._activeObjects=[],Object(T.k)(this)}return Object(S.a)(e,[{key:"initCanvas",value:function(e,t){this._canvas=new E.fabric.Canvas(e,t),this.selectedTool=this._selectedTool,new M(this).init()}},{key:"canvas",get:function(){return this._canvas}},{key:"width",get:function(){return this._width},set:function(e){this._width=e}},{key:"height",get:function(){return this._height},set:function(e){this._height=e}},{key:"backgroundColor",get:function(){return this._backgroundColor},set:function(e){this._backgroundColor=e}},{key:"selectedTool",get:function(){return this._selectedTool},set:function(e){this._selectedTool=e,_.getInstance(this).select()}},{key:"selectable",get:function(){return this._selectable},set:function(e){this.canvas.selection=e,this.canvas.getObjects().forEach((function(t){t.selectable=e,t.hoverCursor=e?"move":"default"}))}},{key:"brushType",get:function(){return this._brushType},set:function(e){this._brushType=e,this.canvas.freeDrawingBrush=e.getBrush(this.canvas)}},{key:"shapeType",get:function(){return this._shapeType},set:function(e){this._shapeType=e}},{key:"activeObject",get:function(){return this._activeObject},set:function(e){this._activeObject=e}},{key:"activeObjects",get:function(){return this._activeObjects},set:function(e){this._activeObjects=e}}]),e}(),V=new function e(){Object(C.a)(this,e),this.canvasStore=void 0,this.canvasStore=new G},X=s.a.createContext(V),Y=function(e){var t=e.children;return Object(a.jsx)(X.Provider,{value:V,children:t})},q=function(){return s.a.useContext(X)},K=n(107),Q=n.n(K),Z=n(109),$=n.n(Z),ee=n(108),te=n.n(ee),ne=n(111),ce=n(7),ae=n(110),ie=n(194),se=n(189),re=n(190),oe=n(103),ue=n.n(oe),le=n(104),he=n.n(le),je=n(105),de=n.n(je),be=n(106),ve=n.n(be),fe=n(87),Oe=n.n(fe),pe=n(102);!function(e){e.TEXT="text/plain"}(F||(F={}));var xe=function(){function e(){Object(C.a)(this,e)}return Object(S.a)(e,null,[{key:"writeText",value:function(e,t){var n=new Blob([t],{type:F.TEXT}),c=window.URL.createObjectURL(n);this.write(e,c)}},{key:"write",value:function(e,t){var n=document.createElement("a");n.download=e,n.href=t,n.click()}},{key:"read",value:function(){var e=Object(pe.a)(Oe.a.mark((function e(t){return Oe.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){var c=new FileReader;c.onload=function(){return e(c.result)},c.onerror=function(){return n()},c.readAsText(t)})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),ge=Object(ce.a)({paper:{border:"1px solid #d3d4d5"}})((function(e){return Object(a.jsx)(ae.a,Object(R.a)({elevation:0,getContentAnchorEl:null,anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"}},e))})),ye=Object(ce.a)((function(e){return{root:{"&:focus":{backgroundColor:e.palette.primary.main,"& .MuiListItemIcon-root, & .MuiListItemText-primary":{color:e.palette.common.white}}}}}))(ie.a);function Ce(){var e=s.a.useState(null),t=Object(ne.a)(e,2),n=t[0],c=t[1],i=q().canvasStore,r=s.a.useRef(null),o=function(){c(null)};return Object(a.jsxs)("div",{children:[Object(a.jsx)("input",{type:"file",onChange:function(e){var t,n=null===(t=e.target.files)||void 0===t?void 0:t.item(0);e.target.value="",n&&xe.read(n).then((function(e){i.canvas.loadFromJSON(e,(function(){}))})).catch((function(e){return console.error(e)}))},ref:r,style:{display:"none"},accept:"application/json"}),Object(a.jsx)(p,{icon:Object(a.jsx)(ue.a,{}),text:"\uba54\ub274",onClick:function(e){c(e.currentTarget)}}),Object(a.jsxs)(ge,{anchorEl:n,keepMounted:!0,open:Boolean(n),onClose:o,children:[Object(a.jsxs)(ye,{onClick:function(){var e;null===(e=r.current)||void 0===e||e.click(),o()},children:[Object(a.jsx)(se.a,{children:Object(a.jsx)(he.a,{fontSize:"small"})}),Object(a.jsx)(re.a,{primary:"\uc5f4\uae30"})]}),Object(a.jsxs)(ye,{onClick:function(){xe.writeText("canvas.json",JSON.stringify(i.canvas.toJSON())),o()},children:[Object(a.jsx)(se.a,{children:Object(a.jsx)(de.a,{fontSize:"small"})}),Object(a.jsx)(re.a,{primary:"\uc800\uc7a5"})]}),Object(a.jsxs)(ye,{onClick:function(){var e=i.canvas.toDataURL();xe.write("canvas.png",e),o()},children:[Object(a.jsx)(se.a,{children:Object(a.jsx)(ve.a,{fontSize:"small"})}),Object(a.jsx)(re.a,{primary:"\uc774\ubbf8\uc9c0\ub85c \uc800\uc7a5"})]})]})]})}var Se=j()((function(){return{appBarColor:{backgroundColor:"rgba(30,30,30,0.95)"},left:{justifyContent:"flex-start"},center:{display:"flex",flex:1,justifyContent:"center"},right:{justifyContent:"flex-end"}}})),Te=Object(y.a)((function(){var e=Se(),t=q().canvasStore;return Object(a.jsx)(x.a,{classes:{colorDefault:e.appBarColor},color:"default",elevation:0,children:Object(a.jsxs)(g.a,{variant:"dense",children:[Object(a.jsx)("div",{className:e.left,children:Object(a.jsx)(Ce,{})}),Object(a.jsxs)("div",{className:e.center,children:[Object(a.jsx)(p,{icon:Object(a.jsx)(Q.a,{}),text:"\uc120\ud0dd",onClick:function(){return t.selectedTool=c.SELECT},selected:t.selectedTool===c.SELECT}),Object(a.jsx)(p,{icon:Object(a.jsx)(te.a,{}),text:"\ube0c\ub7ec\uc2dc",onClick:function(){return t.selectedTool=c.BRUSH},selected:t.selectedTool===c.BRUSH}),Object(a.jsx)(p,{icon:Object(a.jsx)($.a,{}),text:"\uc170\uc774\ud504",onClick:function(){return t.selectedTool=c.SHAPE},selected:t.selectedTool===c.SHAPE})]}),Object(a.jsx)("div",{className:e.right})]})})})),Ee=n(78),ke=n(195),we=n(193),me=j()((function(e){return{title:{marginBottom:e.spacing(3)},input:{padding:e.spacing(1),borderRadius:4,backgroundColor:"#fff"}}})),_e=Object(y.a)((function(){var e=me(),t=q().canvasStore;return Object(a.jsxs)("div",{children:[Object(a.jsx)("div",{className:e.title,children:Object(a.jsx)(Ee.a,{variant:"h6",color:"primary",children:"\ube0c\ub7ec\uc2dc"})}),Object(a.jsxs)("div",{children:[Object(a.jsx)(ke.a,{mb:1,children:Object(a.jsx)(Ee.a,{variant:"caption",children:"\ubaa8\uc591"})}),Object(a.jsx)(we.a,{className:e.input,native:!0,onChange:function(e){t.brushType=z.valueOf(e.target.value)||z.PENCIL},value:t.brushType.value,label:"\ube0c\ub7ec\uc2dc \ubaa8\uc591",fullWidth:!0,children:z.values().map((function(e){return Object(a.jsx)("option",{value:e.value,children:e.display},e.value)}))})]})]})})),Pe=j()((function(e){return{title:{marginBottom:e.spacing(3)},input:{padding:e.spacing(1),borderRadius:4,backgroundColor:"#fff"}}})),Ie=Object(y.a)((function(){var e=Pe(),t=q().canvasStore;return Object(a.jsxs)("div",{children:[Object(a.jsx)("div",{className:e.title,children:Object(a.jsx)(Ee.a,{variant:"h6",color:"primary",children:"\uc170\uc774\ud504"})}),Object(a.jsxs)("div",{children:[Object(a.jsx)(ke.a,{mb:1,children:Object(a.jsx)(Ee.a,{variant:"caption",children:"\ubaa8\uc591"})}),Object(a.jsx)(we.a,{className:e.input,native:!0,onChange:function(e){t.shapeType=J.valueOf(e.target.value)||J.CIRCLE},value:t.shapeType.value,label:"\uc170\uc774\ud504 \ubaa8\uc591",fullWidth:!0,children:J.values().map((function(e){return Object(a.jsx)("option",{value:e.value,children:e.display},e.value)}))})]})]})})),Ne=j()((function(e){return{root:{padding:e.spacing(3)}}})),Re=Object(y.a)((function(){var e=Ne(),t=q().canvasStore.selectedTool;return Object(a.jsxs)("div",{className:e.root,children:[t===c.BRUSH&&Object(a.jsx)(_e,{}),t===c.SHAPE&&Object(a.jsx)(Ie,{})]})})),Le=j()((function(e){return{root:{display:"flex",flexDirection:"column",width:"100vw",height:"100vh"},flexBox:{display:"flex",flex:1},contents:{display:"flex"},left:{flexBasis:"".concat(240,"px"),backgroundColor:"#f0f0f0"},canvasWrapper:{display:"flex",justifyContent:"center",alignItems:"center",flex:1,backgroundColor:"#c0c0c0",padding:e.spacing(3)}}})),Me=Object(y.a)((function(){var e=Le(),t=q().canvasStore;return s.a.useEffect((function(){var e=document.getElementById(t.canvasId);t.initCanvas(e,{width:t.width,height:t.height,backgroundColor:t.backgroundColor})}),[]),Object(a.jsxs)(b,{children:[Object(a.jsx)(Te,{}),Object(a.jsxs)("div",{className:e.root,children:[Object(a.jsx)(g.a,{variant:"dense"}),Object(a.jsxs)("div",{className:e.flexBox,children:[Object(a.jsx)("div",{className:e.left,children:Object(a.jsx)(Re,{})}),Object(a.jsx)("div",{className:e.canvasWrapper,children:Object(a.jsx)("canvas",{id:t.canvasId})})]})]})]})}));var Ae=function(){return Object(a.jsx)(Me,{})};o.a.render(Object(a.jsx)(s.a.StrictMode,{children:Object(a.jsx)(Y,{children:Object(a.jsx)(Ae,{})})}),document.getElementById("root"))}},[[157,1,2]]]);
//# sourceMappingURL=main.ff6d8fb9.chunk.js.map