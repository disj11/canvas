(this.webpackJsonpcanvas=this.webpackJsonpcanvas||[]).push([[0],{224:function(e,t){},225:function(e,t){},226:function(e,t){},339:function(e,t,i){"use strict";i.r(t);var n=i(0),s=i.n(n),o=i(41),r=i.n(o),a=i(404),c=i(392),l=i(1),u=Object(c.a)((function(){return{progressWrapper:{display:"flex",justifyContent:"center",alignItems:"center"}}})),h=function(e){var t=e.loading,i=e.children,n=u();return Object(l.jsx)(s.a.Fragment,{children:Object(l.jsx)("div",{children:t?Object(l.jsx)("div",{className:n.progressWrapper,children:Object(l.jsx)(a.a,{})}):i})})},v=i(4),d=i(7),b=Object(c.a)((function(e){return{button:{minHeight:48,display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",cursor:"pointer",paddingTop:e.spacing(.5),paddingBottom:e.spacing(.5),paddingRight:e.spacing(3),paddingLeft:e.spacing(3),"&:hover":{backgroundColor:e.palette.secondary.main}},caption:{marginTop:e.spacing(.5),fontSize:"0.70rem"},selected:{backgroundColor:e.palette.secondary.main}}})),j=function(e){var t=e.icon,i=e.text,n=e.onClick,s=e.selected,o=b();return Object(l.jsxs)("div",{className:Object(d.a)(o.button,Object(v.a)({},o.selected,s)),onClick:n,children:[t,Object(l.jsx)("div",{className:o.caption,children:i})]})},f=i(406),O=i(407),S=i(25),p=s.a.createContext({}),x=p.Provider,y=function(){return s.a.useContext(p)},g=i(175),E=i.n(g),m=i(177),k=i.n(m),C=i(176),T=i.n(C),M=i(16),I=i(17),w=function(){function e(t,i){Object(M.a)(this,e),this.value=t,this.display=i,e._values.push(this)}return Object(I.a)(e,null,[{key:"values",value:function(){return this._values}},{key:"valueOf",value:function(e){return this.values().find((function(t){return t.value===e}))}}]),e}();w._values=[],w.SELECT=new w("select","\uc120\ud0dd"),w.BRUSH=new w("brush","\ube0c\ub7ec\uc26c"),w.SHAPE=new w("shape","\uc170\uc774\ud504"),w.TEXT=new w("text","\ud14d\uc2a4\ud2b8"),w.IMAGE=new w("image","\uc774\ubbf8\uc9c0"),w.CANVAS=new w("canvas","\uce94\ubc84\uc2a4");var L,N=i(15),A=i(193),P=i(400),D=i(388),R=i(389),_=i(170),B=i.n(_),U=i(172),F=i.n(U),W=i(173),G=i.n(W),H=i(174),J=i.n(H),z=i(66),X=i.n(z),Y=i(94);!function(e){e.TEXT="text/plain"}(L||(L={}));var V=function(){function e(){Object(M.a)(this,e)}return Object(I.a)(e,null,[{key:"writeText",value:function(e,t){var i=new Blob([t],{type:L.TEXT}),n=window.URL.createObjectURL(i);this.write(e,n)}},{key:"write",value:function(e,t){var i=document.createElement("a");i.download=e,i.href=t,i.click()}},{key:"read",value:function(){var e=Object(Y.a)(X.a.mark((function e(t){return X.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,i){var n=new FileReader;n.onload=function(){return e(n.result)},n.onerror=function(){return i()},n.readAsText(t)})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),Z=i(397);function K(){var e=s.a.useState(null),t=Object(N.a)(e,2),i=t[0],n=t[1],o=y().canvasStore,r=s.a.useRef(null),a=function(){n(null)};return Object(l.jsxs)("div",{children:[Object(l.jsx)("input",{type:"file",onChange:function(e){var t,i=null===(t=e.target.files)||void 0===t?void 0:t.item(0);e.target.value="",i&&V.read(i).then((function(e){o.canvas.loadFromJSON(e,(function(){}))})).catch((function(e){return console.error(e)}))},ref:r,style:{display:"none"},accept:"application/json"}),Object(l.jsx)(j,{icon:Object(l.jsx)(B.a,{}),text:"\uba54\ub274",onClick:function(e){n(e.currentTarget)}}),Object(l.jsx)(A.a,{anchorEl:i,keepMounted:!0,open:Boolean(i),onClose:a,children:Object(l.jsxs)(Z.a,{children:[Object(l.jsxs)(P.a,{onClick:function(){var e;null===(e=r.current)||void 0===e||e.click(),a()},children:[Object(l.jsx)(D.a,{children:Object(l.jsx)(F.a,{fontSize:"small"})}),Object(l.jsx)(R.a,{primary:"\uc5f4\uae30"})]}),Object(l.jsxs)(P.a,{onClick:function(){V.writeText("canvas.json",JSON.stringify(o.canvas.toJSON())),a()},children:[Object(l.jsx)(D.a,{children:Object(l.jsx)(G.a,{fontSize:"small"})}),Object(l.jsx)(R.a,{primary:"\uc800\uc7a5"})]}),Object(l.jsxs)(P.a,{onClick:function(){var e=o.canvas.toDataURL();V.write("canvas.png",e),a()},children:[Object(l.jsx)(D.a,{children:Object(l.jsx)(J.a,{fontSize:"small"})}),Object(l.jsx)(R.a,{primary:"\uc774\ubbf8\uc9c0\ub85c \uc800\uc7a5"})]})]})})]})}var q=i(178),Q=i.n(q),$=i(180),ee=i.n($),te=i(179),ie=i.n(te),ne=Object(c.a)((function(){return{left:{justifyContent:"flex-start"},center:{display:"flex",flex:1,justifyContent:"center"},right:{justifyContent:"flex-end"}}})),se=Object(S.a)((function(){var e=ne(),t=y().canvasStore;return Object(l.jsx)(f.a,{children:Object(l.jsxs)(O.a,{variant:"dense",children:[Object(l.jsx)("div",{className:e.left,children:Object(l.jsx)(K,{})}),Object(l.jsxs)("div",{className:e.center,children:[Object(l.jsx)(j,{icon:Object(l.jsx)(E.a,{}),text:w.SELECT.display,onClick:function(){return t.setCanvasMode(w.SELECT)},selected:t.canvasMode===w.SELECT}),Object(l.jsx)(j,{icon:Object(l.jsx)(T.a,{}),text:w.BRUSH.display,onClick:function(){return t.setCanvasMode(w.BRUSH)},selected:t.canvasMode===w.BRUSH}),Object(l.jsx)(j,{icon:Object(l.jsx)(k.a,{}),text:w.SHAPE.display,onClick:function(){return t.setCanvasMode(w.SHAPE)},selected:t.canvasMode===w.SHAPE}),Object(l.jsx)(j,{icon:Object(l.jsx)(Q.a,{}),text:w.TEXT.display,onClick:function(){return t.setCanvasMode(w.TEXT)},selected:t.canvasMode===w.TEXT}),Object(l.jsx)(j,{icon:Object(l.jsx)(ie.a,{}),text:w.IMAGE.display,onClick:function(){return t.setCanvasMode(w.IMAGE)},selected:t.canvasMode===w.IMAGE}),Object(l.jsx)(j,{icon:Object(l.jsx)(ee.a,{}),text:w.CANVAS.display,onClick:function(){return t.setCanvasMode(w.CANVAS)},selected:t.canvasMode===w.CANVAS})]}),Object(l.jsx)("div",{className:e.right})]})})})),oe=i(410),re=i(23),ae=function(){function e(t,i){Object(M.a)(this,e),this.value=t,this.display=i,e._values.push(this)}return Object(I.a)(e,[{key:"getBrush",value:function(t){switch(this){case e.PENCIL:return new re.fabric.PencilBrush(t);case e.CIRCLE:return new re.fabric.CircleBrush(t);case e.SPRAY:return new re.fabric.SprayBrush(t);default:return new re.fabric.PencilBrush(t)}}}],[{key:"values",value:function(){return this._values}},{key:"valueOf",value:function(e){return this.values().find((function(t){return t.value===e}))}}]),e}();ae._values=[],ae.PENCIL=new ae("pencil","\uc5f0\ud544"),ae.CIRCLE=new ae("circle","\uc6d0\ud615"),ae.SPRAY=new ae("spray","\uc2a4\ud504\ub808\uc774");var ce,le=i(101),ue=i(102),he=i(396),ve=i(408),de=i(103),be=i(409),je=Object(c.a)((function(){return{label:{display:"flex",justifyContent:"space-between"}}})),fe=function(e){var t=e.label,i=e.value,n=e.onChange,s=e.prefix,o=e.min,r=e.max,a=je();return Object(l.jsxs)("div",{children:[Object(l.jsxs)("div",{className:a.label,children:[Object(l.jsx)(de.a,{variant:"caption",children:t}),Object(l.jsx)(ve.a,{value:i,margin:"dense",inputProps:{min:1,max:100,type:"number"},endAdornment:Object(l.jsx)(be.a,{position:"end",children:s})})]}),Object(l.jsx)("div",{children:Object(l.jsx)(he.a,{min:o,max:r,value:i,onChange:function(e,t){"number"===typeof t&&n(t)}})})]})},Oe=i(45),Se=i(96),pe=i(393),xe=Object(c.a)((function(){return{colorBox:{width:"100%",height:35,border:1,borderStyle:"solid",borderColor:"#c0c0c0",backgroundColor:function(e){return e.color},cursor:function(e){return e.disabled?"default":"pointer"}}}})),ye=function(e){var t=xe(e),i=s.a.useState(null),n=Object(N.a)(i,2),o=n[0],r=n[1],a=!!o;return Object(l.jsxs)("div",{children:[e.label&&Object(l.jsx)(de.a,{variant:"caption",children:e.label}),Object(l.jsxs)("div",{children:[Object(l.jsx)("div",{className:t.colorBox,onClick:function(e){r(e.currentTarget)}}),Object(l.jsx)(pe.a,{open:a&&!e.disabled,anchorEl:o,onClose:function(){r(null)},children:Object(l.jsx)(Se.a,{color:e.color,disableAlpha:e.disableAlpha,onChangeComplete:e.onChange})})]})]})},ge=function(e){return Object(l.jsxs)("div",{children:[Object(l.jsx)(oe.a,{mb:2,children:Object(l.jsx)(ye,Object(Oe.a)({},e))}),Object(l.jsx)(Se.b,{width:"100%",color:e.color,onChangeComplete:e.onChange})]})},Ee=i(394),me=i(411),ke=function(e){var t=s.a.useRef();return s.a.useEffect((function(){t.current=e})),t.current},Ce=i(383),Te=function(e){var t=e.color,i=e.onChange,n=ke(t),o=Object(Ce.a)(),r=s.a.useState(t?"solid":"none"),a=Object(N.a)(r,2),c=a[0],u=a[1];return Object(l.jsxs)(oe.a,{display:"flex",children:[Object(l.jsx)(oe.a,{mr:1.5,flexBasis:35,children:Object(l.jsx)(ye,{color:t,onChange:function(e){var t=e.rgb.a||0===e.rgb.a?"rgba(".concat(e.rgb.r,", ").concat(e.rgb.g,", ").concat(e.rgb.b,", ").concat(e.rgb.a,")"):e.hex;i(t)},disabled:"none"===c})}),Object(l.jsx)(oe.a,{flex:1,children:Object(l.jsx)(me.a,{variant:"standard",fullWidth:!0,children:Object(l.jsxs)(Ee.a,{value:c,onChange:function(e){var t=e.target.value;u(t),i("none"===t?void 0:n||o.palette.primary.main)},children:[Object(l.jsx)(P.a,{value:"none",children:Object(l.jsx)("em",{children:"\uc5c6\uc74c"})}),Object(l.jsx)(P.a,{value:"solid",children:"\ub2e8\uc0c9"})]})})})]})},Me=i(185),Ie=i.n(Me),we=i(186),Le=i.n(we),Ne=i(187),Ae=i.n(Ne),Pe=i(401),De=i(412),Re=[8,9,10,11,12,14,16,18,20,22,24,26,28,36,48,72,94,130];!function(e){e[e.DEFAULT=0]="DEFAULT",e[e.GOOGLE=1]="GOOGLE"}(ce||(ce={}));var _e="left",Be="center",Ue="right",Fe="normal",We="bold",Ge="normal",He="italic",Je=function(){function e(t,i,n){Object(M.a)(this,e),this.value=t,this.display=i,this.type=n,e._values.push(this)}return Object(I.a)(e,null,[{key:"values",value:function(){return this._values}},{key:"valueOf",value:function(e){return this.values().find((function(t){return t.value===e}))}},{key:"getGoogleFonts",value:function(){return this.values().filter((function(e){return e.type===ce.GOOGLE}))}}]),e}();Je._values=[],Je.TIMES_NEW_ROMAN=new Je("Times New Roman","Times New Roman",ce.DEFAULT),Je.NOTO_SANS_KR=new Je("Noto Sans KR","\ub178\ud1a0\uc0b0\uc2a4",ce.GOOGLE),Je.NANUM_GOTHIC=new Je("Nanum Gothic","\ub098\ub214\uace0\ub515",ce.GOOGLE),Je.NANUM_PEN_SCRIPT=new Je("Nanum Pen Script","\ub098\ub214\ud39c",ce.GOOGLE),Je.SONG_MYUNG=new Je("Song Myung","\uc1a1\uba85",ce.GOOGLE);var ze,Xe=function(e){var t=e.textAlign,i=e.onChange;return Object(l.jsxs)(Pe.a,{value:t,exclusive:!0,onChange:function(e,t){i&&i(t||_e)},"aria-label":"text alignment",fullWidth:!0,children:[Object(l.jsx)(De.a,{value:_e,"aria-label":"left aligned",children:Object(l.jsx)(Ie.a,{})}),Object(l.jsx)(De.a,{value:Be,"aria-label":"centered",children:Object(l.jsx)(Le.a,{})}),Object(l.jsx)(De.a,{value:Ue,"aria-label":"right aligned",children:Object(l.jsx)(Ae.a,{})})]})},Ye=i(188),Ve=i.n(Ye),Ze=i(189),Ke=i.n(Ze),qe=i(190),Qe=i.n(qe);!function(e){e.BOLD="BOLD",e.ITALIC="ITALIC",e.UNDERLINED="UNDERLINED"}(ze||(ze={}));var $e=function(e){var t=e.bold,i=e.italic,n=e.underline,o=e.toggleBold,r=e.toggleItalic,a=e.toggleUnderline,c=s.a.useMemo((function(){var e=[];return t&&e.push(ze.BOLD),i&&e.push(ze.ITALIC),n&&e.push(ze.UNDERLINED),e}),[t,i,n]);return Object(l.jsxs)(Pe.a,{value:c,onChange:function(e,t){o(t.includes(ze.BOLD)),r(t.includes(ze.ITALIC)),a(t.includes(ze.UNDERLINED))},"aria-label":"text formatting",fullWidth:!0,children:[Object(l.jsx)(De.a,{value:ze.BOLD,"aria-label":"bold",children:Object(l.jsx)(Ve.a,{})}),Object(l.jsx)(De.a,{value:ze.ITALIC,"aria-label":"italic",children:Object(l.jsx)(Ke.a,{})}),Object(l.jsx)(De.a,{value:ze.UNDERLINED,"aria-label":"underlined",children:Object(l.jsx)(Qe.a,{})})]})},et=i(413),tt=i(191),it=i.n(tt),nt=function(e){var t=e.onChange,i=s.a.useRef(null);return Object(l.jsxs)(l.Fragment,{children:[Object(l.jsx)("input",{ref:i,type:"file",style:{display:"none"},accept:"image/*",multiple:!0,onChange:function(e){if(t){var i=e.target.files?Array.from(e.target.files):[];t(i)}}}),Object(l.jsx)(et.a,{variant:"contained",color:"primary",startIcon:Object(l.jsx)(it.a,{}),onClick:function(){var e;return null===(e=i.current)||void 0===e?void 0:e.click()},children:"\uc774\ubbf8\uc9c0 \ucd94\uac00"})]})},st=Object(c.a)((function(e){return{root:{display:"flex",flexDirection:"column",height:"100%"},title:{marginBottom:e.spacing(3)},propBoxWrapper:{flex:1,display:"flex",flexDirection:"column"}}})),ot=Object(S.a)((function(e){var t=e.children,i=st(),n=y(),s=n.canvasStore,o=n.objectStore;return Object(l.jsxs)("div",{className:i.root,children:[Object(l.jsx)("div",{className:i.title,children:Object(l.jsx)(de.a,{variant:"h6",color:"primary",children:o.activeObject?o.getObjectTypeName():s.canvasMode.display})}),Object(l.jsx)("div",{className:i.propBoxWrapper,children:t})]})})),rt=i(194),at=function(e){var t=e.label,i=e.children,n=Object(rt.a)(e,["label","children"]);return Object(l.jsxs)(oe.a,Object(Oe.a)(Object(Oe.a)({},n),{},{children:[t&&Object(l.jsx)(oe.a,{mb:1,children:Object(l.jsx)(de.a,{variant:"caption",children:t})}),i]}))},ct=Object(c.a)((function(e){return{button:{borderRadius:"4px",cursor:"pointer",padding:e.spacing(1),marginRight:e.spacing(.5),color:e.palette.text.primary,"&:hover":{backgroundColor:e.palette.primary.main,color:e.palette.background.default}},selected:{backgroundColor:e.palette.primary.main,color:e.palette.background.default}}})),lt=Object(S.a)((function(){var e=ct(),t=y().brushStore;return Object(l.jsxs)(ot,{children:[!t.item&&Object(l.jsx)("div",{children:Object(l.jsx)(at,{label:"\ubaa8\uc591",mb:3,children:Object(l.jsxs)(oe.a,{display:"flex",children:[Object(l.jsx)("div",{className:Object(d.a)(e.button,t.brushType===ae.PENCIL&&e.selected),onClick:function(){return t.setBrushType(ae.PENCIL)},children:Object(l.jsx)(le.a,{icon:ue.b,size:"lg"})}),Object(l.jsx)("div",{className:Object(d.a)(e.button,t.brushType===ae.SPRAY&&e.selected),onClick:function(){return t.setBrushType(ae.SPRAY)},children:Object(l.jsx)(le.a,{icon:ue.c,size:"lg"})}),Object(l.jsx)("div",{className:Object(d.a)(e.button,t.brushType===ae.CIRCLE&&e.selected),onClick:function(){return t.setBrushType(ae.CIRCLE)},children:Object(l.jsx)(le.a,{icon:ue.a,size:"lg"})})]})})}),Object(l.jsx)(at,{mb:3,children:Object(l.jsx)(fe,{label:"\ub450\uaed8",value:t.strokeWidth,onChange:function(e){return t.setStrokeWidth(e)},prefix:"px",min:1})}),Object(l.jsx)(at,{label:"\uc0c9\uc0c1",children:Object(l.jsx)(ge,{color:t.stroke,onChange:function(e){return t.setStroke(e.hex)},disableAlpha:!0})})]})})),ut=function(){function e(t,i){Object(M.a)(this,e),this.value=t,this.display=i,e._values.push(this)}return Object(I.a)(e,[{key:"getShape",value:function(t){switch(this){case e.RECT:return new re.fabric.Rect(t);case e.ELLIPSE:return new re.fabric.Ellipse(t);case e.TRIANGLE:return new re.fabric.Triangle(t);default:return new re.fabric.Rect(t)}}}],[{key:"values",value:function(){return this._values}},{key:"valueOf",value:function(e){return this.values().find((function(t){return t.value===e}))}}]),e}();ut._values=[],ut.RECT=new ut("rect","\uc0ac\uac01\ud615"),ut.ELLIPSE=new ut("ellipse","\uc6d0"),ut.TRIANGLE=new ut("triangle","\uc0bc\uac01\ud615");var ht,vt=Object(c.a)((function(e){return{button:{borderRadius:"4px",cursor:"pointer",padding:e.spacing(1),marginRight:e.spacing(.5),height:40,"&:hover":{background:e.palette.primary.main,"& svg > *":{stroke:e.palette.background.default}}},selected:{background:e.palette.primary.main,"& svg > *":{stroke:e.palette.background.default}},propBox:{"& > div":{marginBottom:e.spacing(3)}}}})),dt=Object(S.a)((function(){var e=vt(),t=y().shapeStore;return Object(l.jsx)(ot,{children:Object(l.jsxs)("div",{className:e.propBox,children:[!t.item&&Object(l.jsx)("div",{children:Object(l.jsx)(at,{label:"\ubaa8\uc591",children:Object(l.jsxs)(oe.a,{display:"flex",children:[Object(l.jsx)("div",{className:Object(d.a)(e.button,t.shapeType===ut.ELLIPSE&&e.selected),onClick:function(){return t.setShapeType(ut.ELLIPSE)},children:Object(l.jsx)("svg",{height:"24",width:"24",children:Object(l.jsx)("circle",{cx:"12",cy:"12",r:"10",stroke:"black",fill:"transparent",strokeWidth:2})})}),Object(l.jsx)("div",{className:Object(d.a)(e.button,t.shapeType===ut.RECT&&e.selected),onClick:function(){return t.setShapeType(ut.RECT)},children:Object(l.jsx)("svg",{width:"24",height:"24",children:Object(l.jsx)("rect",{width:"24",height:"24",stroke:"black",fill:"transparent",strokeWidth:4})})}),Object(l.jsx)("div",{className:Object(d.a)(e.button,t.shapeType===ut.TRIANGLE&&e.selected),onClick:function(){return t.setShapeType(ut.TRIANGLE)},children:Object(l.jsx)("svg",{width:"24",height:"24",children:Object(l.jsx)("polygon",{points:"12,2 22,22 2,22",stroke:"black",fill:"transparent",strokeWidth:2})})})]})})}),Object(l.jsx)(at,{label:"\ucc44\uc6b0\uae30",children:Object(l.jsx)(Te,{color:t.fill,onChange:function(e){return t.setFill(e)}})}),Object(l.jsx)(at,{label:"\uc120 \uc0c9\uc0c1",children:Object(l.jsx)(Te,{color:t.stroke,onChange:function(e){return t.setStroke(e)}})}),Object(l.jsx)(at,{children:Object(l.jsx)(fe,{label:"\uc120 \ub450\uaed8",value:t.strokeWidth,onChange:function(e){return t.setStrokeWidth(e)},prefix:"px"})})]})})})),bt=Object(c.a)((function(e){return{propBox:{"& > *":{marginBottom:e.spacing(3)}}}})),jt=Object(S.a)((function(){var e=bt(),t=y().textStore;return Object(l.jsx)(ot,{children:Object(l.jsxs)("div",{className:e.propBox,children:[Object(l.jsx)(at,{label:"\ud3f0\ud2b8",children:Object(l.jsx)(me.a,{variant:"standard",fullWidth:!0,children:Object(l.jsx)(Ee.a,{value:t.fontFamily,onChange:function(e){var i=e.target.value;t.setFontFamily(i)},children:Je.values().map((function(e){return Object(l.jsx)(P.a,{value:e.value,style:{fontFamily:e.value},children:e.display},e.value)}))})})}),Object(l.jsx)(at,{label:"\ud3f0\ud2b8 \ud06c\uae30",children:Object(l.jsxs)(oe.a,{display:"flex",children:[Object(l.jsx)(oe.a,{flex:1,mr:1.5,children:Object(l.jsx)(me.a,{variant:"standard",fullWidth:!0,children:Object(l.jsxs)(Ee.a,{value:t.fontSize.toString(),onChange:function(e){var i=parseInt(e.target.value,10);t.setFontSize(i)},children:[Object(l.jsx)(P.a,{value:t.fontSize,children:t.fontSize}),Re.map((function(e){return t.fontSize!==e&&Object(l.jsx)(P.a,{value:e,children:e},e)}))]})})}),Object(l.jsx)(oe.a,{flexBasis:35,children:Object(l.jsx)(ye,{color:t.fill,onChange:function(e){return t.setFill(e.hex)}})})]})}),Object(l.jsx)(at,{label:"\ud3f0\ud2b8 \uc2a4\ud0c0\uc77c",children:Object(l.jsx)($e,{bold:t.isBold(),italic:t.isItalic(),underline:t.underline,toggleBold:function(e){return t.setBold(e)},toggleItalic:function(e){return t.setItalic(e)},toggleUnderline:function(e){return t.setUnderline(e)}})}),Object(l.jsx)(at,{label:"\uc815\ub82c",children:Object(l.jsx)(Xe,{textAlign:t.textAlign,onChange:function(e){return t.setTextAlign(e)}})})]})})})),ft=i(398),Ot=Object(S.a)((function(){var e=y().canvasStore,t=s.a.useState(e.width),i=Object(N.a)(t,2),n=i[0],o=i[1],r=s.a.useState(e.height),a=Object(N.a)(r,2),c=a[0],u=a[1];return Object(l.jsxs)(ot,{children:[Object(l.jsx)(at,{label:"\uce94\ubc84\uc2a4 \ud06c\uae30 \uc870\uc815",mb:3,children:Object(l.jsxs)(oe.a,{display:"flex",children:[Object(l.jsx)(oe.a,{flex:1,mr:1.5,children:Object(l.jsxs)(me.a,{variant:"standard",fullWidth:!0,children:[Object(l.jsx)(ft.a,{htmlFor:"canvas-width",children:"\ub108\ube44"}),Object(l.jsx)(ve.a,{id:"canvas-width",type:"number",value:n,onChange:function(e){return o(parseInt(e.target.value))},onBlur:function(){return e.setWidth(n)},endAdornment:Object(l.jsx)(be.a,{position:"end",children:"px"})})]})}),Object(l.jsx)(oe.a,{flex:1,children:Object(l.jsxs)(me.a,{variant:"standard",fullWidth:!0,children:[Object(l.jsx)(ft.a,{htmlFor:"canvas-width",children:"\ub192\uc774"}),Object(l.jsx)(ve.a,{id:"canvas-width",type:"number",value:c,onChange:function(e){return u(parseInt(e.target.value))},onBlur:function(){return e.setHeight(c)},endAdornment:Object(l.jsx)(be.a,{position:"end",children:"px"})})]})})]})}),Object(l.jsx)(at,{label:"\ubc30\uacbd",children:Object(l.jsx)(ge,{color:e.backgroundColor,onChange:function(t){return e.setBackgroundColor(t.hex)},disableAlpha:!0})})]})})),St=function(){return Object(l.jsx)(ot,{children:"\uc624\ube0c\uc81d\ud2b8\ub97c \uc120\ud0dd\ud558\uba74 \uc18d\uc131\uc744 \ubcc0\uacbd\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4."})},pt=i(402),xt=Object(S.a)((function(){var e=y().imageStore;return Object(l.jsxs)(ot,{children:[Object(l.jsx)(at,{mb:3,children:Object(l.jsx)(nt,{onChange:function(t){return e.upload(t)}})}),Object(l.jsx)(at,{children:Object(l.jsx)(pt.a,{container:!0,spacing:1,children:e.uploadedImages.map((function(t){return Object(l.jsx)(pt.a,{item:!0,onClick:function(){return e.addImage(t.dataUrl)},style:{cursor:"pointer"},children:Object(l.jsx)("img",{src:t.dataUrl,alt:t.name,style:{width:"100%",objectFit:"cover"}})},t.name)}))})})]})})),yt=Object(c.a)((function(e){return{root:{padding:e.spacing(3),height:"100%"}}})),gt=Object(S.a)((function(){var e=yt(),t=y(),i=t.canvasStore,n=t.objectStore,o=i.canvasMode,r=n.activeObject;return Object(l.jsx)(s.a.Fragment,{children:Object(l.jsxs)("div",{className:e.root,children:[!r&&Object(l.jsxs)(s.a.Fragment,{children:[o===w.SELECT&&Object(l.jsx)(St,{}),o===w.BRUSH&&Object(l.jsx)(lt,{}),o===w.SHAPE&&Object(l.jsx)(dt,{}),o===w.TEXT&&Object(l.jsx)(jt,{}),o===w.IMAGE&&Object(l.jsx)(xt,{}),o===w.CANVAS&&Object(l.jsx)(Ot,{})]}),r&&Object(l.jsxs)(s.a.Fragment,{children:[n.isPath()&&Object(l.jsx)(lt,{}),n.isShape()&&Object(l.jsx)(dt,{}),n.isText()&&Object(l.jsx)(jt,{}),n.isImage()&&Object(l.jsx)(xt,{})]})]})})})),Et=Object(c.a)((function(e){return{root:{display:"flex",flexDirection:"column",width:"100vw",height:"100vh"},flexBox:{display:"flex",flex:1},contents:{display:"flex"},left:{flexBasis:"".concat(260,"px")},canvasWrapper:{display:"flex",justifyContent:"center",alignItems:"center",flex:1,backgroundColor:e.palette.grey.A400,padding:e.spacing(3)}}})),mt=Object(S.a)((function(){var e=Et(),t=y(),i=s.a.useRef(null);return s.a.useEffect((function(){if(i.current)return t.init(i.current),t.onInit(),function(){return t.onDestroy()}}),[t,i]),Object(l.jsxs)(h,{children:[Object(l.jsx)(se,{}),Object(l.jsxs)("div",{className:e.root,children:[Object(l.jsx)(O.a,{variant:"dense"}),Object(l.jsxs)("div",{className:e.flexBox,children:[Object(l.jsx)("div",{className:e.left,children:Object(l.jsx)(gt,{})}),Object(l.jsx)("div",{className:e.canvasWrapper,ref:i})]})]})]})})),kt=i(14),Ct={brushType:ae.PENCIL,stroke:"#000000",strokeWidth:1},Tt=function(){function e(t){Object(M.a)(this,e),this.rootStore=t,this.brushType=Ct.brushType,this.stroke=Ct.stroke,this.strokeWidth=Ct.strokeWidth,this.item=void 0,this.listeners=void 0,this.canvas=void 0,this.selectionEventStore=void 0,this.objectStore=void 0,Object(kt.l)(this),t.canvasStore.registerCanvasModeManager(w.BRUSH,this),this.canvas=t.canvasStore.canvas,this.selectionEventStore=t.selectionEventStore,this.objectStore=t.objectStore,this.listeners={updateObject:this.updateObject.bind(this)}}return Object(I.a)(e,[{key:"onInit",value:function(){this.addReactions()}},{key:"onDestroy",value:function(){this.removeReactions()}},{key:"onSessionStart",value:function(){this.canvas.isDrawingMode=!0,this.setBrushType(this.brushType)}},{key:"onSessionEnd",value:function(){this.canvas.isDrawingMode=!1}},{key:"setBrushType",value:function(e){this.brushType=e,this.setFreeDrawingBrush()}},{key:"updateStroke",value:function(e){this.stroke=e||Ct.stroke,this.canvas.freeDrawingBrush.color=this.stroke}},{key:"setStroke",value:function(e){this.updateStroke(e),this.objectStore.setStroke(e)}},{key:"updateStrokeWidth",value:function(e){this.strokeWidth=e||Ct.strokeWidth,this.canvas.freeDrawingBrush.width=this.strokeWidth}},{key:"setStrokeWidth",value:function(e){this.updateStrokeWidth(e),this.objectStore.setStrokeWidth(e)}},{key:"setFreeDrawingBrush",value:function(){this.canvas.freeDrawingBrush=this.brushType.getBrush(this.canvas),this.canvas.freeDrawingBrush.color=this.stroke,this.canvas.freeDrawingBrush.width=this.strokeWidth}},{key:"updateObject",value:function(e){this.isBrush(e)?(this.item=e,this.updatePathStyles()):this.item=void 0}},{key:"updatePathStyles",value:function(){if(this.item){var e=this.item,t=e.stroke,i=e.strokeWidth;this.updateStroke(t),this.updateStrokeWidth(i)}}},{key:"isBrush",value:function(e){return this.objectStore.isPath(e)}},{key:"addReactions",value:function(){this.selectionEventStore.subscribe(this.listeners.updateObject)}},{key:"removeReactions",value:function(){this.selectionEventStore.unsubscribe(this.listeners.updateObject)}}]),e}(),Mt=500,It=500,wt="#ffffff",Lt=function(){function e(t,i){Object(M.a)(this,e),this.rootStore=t,this.canvas=i,this.canvasModeManagers=new Map,this.width=Mt,this.height=It,this.backgroundColor=wt,this.canvasMode=w.CANVAS,Object(kt.l)(this)}return Object(I.a)(e,[{key:"onInit",value:function(){this.canvas.setWidth(this.width),this.canvas.setHeight(this.height),this.canvas.setBackgroundColor(this.backgroundColor,(function(){})),this.setCanvasMode(this.canvasMode)}},{key:"onDestroy",value:function(){this.canvas.dispose()}},{key:"registerCanvasModeManager",value:function(e,t){this.canvasModeManagers.set(e,t)}},{key:"setCanvasMode",value:function(e){var t,i,n=this.canvasMode;this.canvasMode=e,this.canvas.discardActiveObject().renderAll(),this.setAllCursor("default"),this.setSelectable(!1),null===(t=this.canvasModeManagers.get(n))||void 0===t||t.onSessionEnd(),null===(i=this.canvasModeManagers.get(e))||void 0===i||i.onSessionStart()}},{key:"setSelectable",value:function(e){this.canvas.selection=e,this.canvas.getObjects().forEach((function(t){t.selectable=e}))}},{key:"setDefaultCursor",value:function(e){this.canvas.defaultCursor=e}},{key:"setHoverCursor",value:function(e){this.canvas.getObjects().forEach((function(t){t.hoverCursor=e}))}},{key:"setAllCursor",value:function(e){this.setDefaultCursor(e),this.setHoverCursor(e)}},{key:"setWidth",value:function(e){this.width=e,this.canvas.setWidth(e)}},{key:"setHeight",value:function(e){this.height=e,this.canvas.setHeight(e)}},{key:"setBackgroundColor",value:function(e){this.backgroundColor=e,this.canvas.setBackgroundColor(e,(function(){}))}}]),e}();!function(e){e.MOUSE_UP="mouse:up",e.MOUSE_DOWN="mouse:down",e.MOUSE_MOVE="mouse:move"}(ht||(ht={}));var Nt=function(){function e(t){Object(M.a)(this,e),this.rootStore=t,this.listeners=void 0,this.startCursorPosition={x:0,y:0},this.currentCursorPosition={x:0,y:0},this.observer=new Map,this.listeners={onMouseDown:this.onMouseDown.bind(this),onMouseUp:this.onMouseUp.bind(this),onMouseMove:this.onMouseMove.bind(this)}}return Object(I.a)(e,[{key:"onInit",value:function(){this.addEventListeners()}},{key:"onDestroy",value:function(){this.removeEventListeners()}},{key:"subscribe",value:function(e,t){var i;this.observer.has(e)||this.observer.set(e,[]),null===(i=this.observer.get(e))||void 0===i||i.push(t)}},{key:"unsubscribe",value:function(e,t){var i;this.observer.set(e,(null===(i=this.observer.get(e))||void 0===i?void 0:i.filter((function(e){return e!==t})))||[])}},{key:"onMouseDown",value:function(e){var t,i=this;this.startCursorPosition=Object(Oe.a)({},this.getCursorPosition(e)),this.currentCursorPosition=Object(Oe.a)({},this.getCursorPosition(e)),null===(t=this.observer.get(ht.MOUSE_DOWN))||void 0===t||t.forEach((function(e){return e({startCursorPosition:i.startCursorPosition,currentCursorPosition:i.currentCursorPosition})}))}},{key:"onMouseMove",value:function(e){var t,i=this;this.currentCursorPosition=Object(Oe.a)({},this.getCursorPosition(e)),null===(t=this.observer.get(ht.MOUSE_MOVE))||void 0===t||t.forEach((function(e){return e({startCursorPosition:i.startCursorPosition,currentCursorPosition:i.currentCursorPosition})}))}},{key:"onMouseUp",value:function(e){var t,i=this;this.currentCursorPosition=Object(Oe.a)({},this.getCursorPosition(e)),null===(t=this.observer.get(ht.MOUSE_UP))||void 0===t||t.forEach((function(e){return e({startCursorPosition:i.startCursorPosition,currentCursorPosition:i.currentCursorPosition})}))}},{key:"addEventListeners",value:function(){var e=this.rootStore.canvasStore.canvas;e.on(ht.MOUSE_DOWN,this.listeners.onMouseDown),e.on(ht.MOUSE_MOVE,this.listeners.onMouseMove),e.on(ht.MOUSE_UP,this.listeners.onMouseUp)}},{key:"removeEventListeners",value:function(){var e=this.rootStore.canvasStore.canvas;e.off(ht.MOUSE_DOWN,this.listeners.onMouseDown),e.off(ht.MOUSE_MOVE,this.listeners.onMouseMove),e.off(ht.MOUSE_UP,this.listeners.onMouseUp)}},{key:"getCursorPosition",value:function(e){return this.rootStore.canvasStore.canvas.getPointer(e.e)}}]),e}(),At=document.createElement("img");At.src="data:image/svg+xml,%3C%3Fxml version='1.0' encoding='utf-8'%3F%3E%3C!DOCTYPE svg PUBLIC '-//W3C//DTD SVG 1.1//EN' 'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd'%3E%3Csvg version='1.1' id='Ebene_1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' width='595.275px' height='595.275px' viewBox='200 215 230 470' xml:space='preserve'%3E%3Ccircle style='fill:%23F44336;' cx='299.76' cy='439.067' r='218.516'/%3E%3Cg%3E%3Crect x='267.162' y='307.978' transform='matrix(0.7071 -0.7071 0.7071 0.7071 -222.6202 340.6915)' style='fill:white;' width='65.545' height='262.18'/%3E%3Crect x='266.988' y='308.153' transform='matrix(0.7071 0.7071 -0.7071 0.7071 398.3889 -83.3116)' style='fill:white;' width='65.544' height='262.179'/%3E%3C/g%3E%3C/svg%3E";var Pt,Dt=function(){function e(){Object(M.a)(this,e)}return Object(I.a)(e,null,[{key:"init",value:function(e){re.fabric.Object.prototype.controls.deleteControl=new re.fabric.Control({x:.5,y:-.5,offsetY:-16,offsetX:16,cursorStyle:"pointer",mouseUpHandler:e,render:this.renderIcon(At)})}},{key:"renderIcon",value:function(e){return function(t,i,n,s,o){var r=o.cornerSize;r&&(t.save(),t.translate(i,n),t.rotate(re.fabric.util.degreesToRadians(o.angle||0)),t.drawImage(e,-r/2,-r/2,r,r),t.restore())}}}]),e}();!function(e){e.SELECTION_CLEARED="selection:cleared",e.SELECTION_CREATED="selection:created",e.SELECTION_UPDATED="selection:updated"}(Pt||(Pt={}));var Rt,_t=function(){function e(t){Object(M.a)(this,e),this.rootStore=t,this.canvasStore=void 0,this.listeners=void 0,this.observer=new Set,this.activeObject=void 0,Object(kt.l)(this),this.canvasStore=t.canvasStore,this.listeners={onSelected:this.onSelected.bind(this),onCleared:this.onCleared.bind(this)},this.addEventListeners(),this.initControl()}return Object(I.a)(e,[{key:"onSelected",value:function(e){var t=e.target;t&&(this.activeObject=t)}},{key:"onCleared",value:function(){this.activeObject=void 0}},{key:"addEventListeners",value:function(){var e=this;this.canvasStore.canvas.on(Pt.SELECTION_CREATED,this.listeners.onSelected),this.canvasStore.canvas.on(Pt.SELECTION_UPDATED,this.listeners.onSelected),this.canvasStore.canvas.on(Pt.SELECTION_CLEARED,this.listeners.onCleared),Object(kt.o)((function(){return e.activeObject}),(function(){return e.observer.forEach((function(t){return t(e.activeObject)}))}))}},{key:"initControl",value:function(){Dt.init(this.removeActiveObjects)}},{key:"removeActiveObjects",value:function(e,t){var i=t.target.canvas;return!!i&&(0!==i.getActiveObjects().length&&(i.getActiveObjects().forEach((function(e){return i.remove(e)})),i.discardActiveObject(),i.requestRenderAll(),!0))}},{key:"subscribe",value:function(e){this.observer.add(e)}},{key:"unsubscribe",value:function(e){this.observer.delete(e)}}]),e}();!function(e){e.OBJECT_SCALING="object:scaling",e.OBJECT_MODIFIED="object:modified"}(Rt||(Rt={}));var Bt=function(){function e(t){Object(M.a)(this,e),this.rootStore=t,this.listeners=void 0,this.observer=new Map,this.listeners={onScaling:this.onScaling.bind(this),onModified:this.onModified.bind(this)}}return Object(I.a)(e,[{key:"onInit",value:function(){this.addEventListener()}},{key:"onDestroy",value:function(){this.removeEventListener()}},{key:"addEventListener",value:function(){var e=this.rootStore.canvasStore.canvas;e.on(Rt.OBJECT_SCALING,this.listeners.onScaling),e.on(Rt.OBJECT_MODIFIED,this.listeners.onModified)}},{key:"removeEventListener",value:function(){var e=this.rootStore.canvasStore.canvas;e.off(Rt.OBJECT_SCALING,this.listeners.onScaling),e.off(Rt.OBJECT_MODIFIED,this.listeners.onModified)}},{key:"onScaling",value:function(e){var t;null===(t=this.observer.get(Rt.OBJECT_SCALING))||void 0===t||t.forEach((function(t){return t(e)}))}},{key:"onModified",value:function(e){var t;null===(t=this.observer.get(Rt.OBJECT_MODIFIED))||void 0===t||t.forEach((function(t){return t(e)}))}},{key:"subscribe",value:function(e,t){var i;this.observer.has(e)||this.observer.set(e,new Set),null===(i=this.observer.get(e))||void 0===i||i.add(t)}},{key:"unsubscribe",value:function(e,t){var i;null===(i=this.observer.get(e))||void 0===i||i.delete(t)}}]),e}(),Ut={shapeType:ut.ELLIPSE,fill:void 0,strokeWidth:3,stroke:"#000000"},Ft=function(){function e(t){Object(M.a)(this,e),this.rootStore=t,this.canvas=void 0,this.mouseEventStore=void 0,this.selectionEventStore=void 0,this.objectStore=void 0,this.listeners=void 0,this.isDragMode=!1,this.item=void 0,this.fill=Ut.fill,this.shapeType=Ut.shapeType,this.strokeWidth=Ut.strokeWidth,this.stroke=Ut.stroke,Object(kt.l)(this),t.canvasStore.registerCanvasModeManager(w.SHAPE,this),this.canvas=t.canvasStore.canvas,this.mouseEventStore=t.mouseEventStore,this.selectionEventStore=t.selectionEventStore,this.objectStore=t.objectStore,this.listeners={onMouseUp:this.onMouseUp.bind(this),onMouseDown:this.onMouseDown.bind(this),onMouseMove:this.onMouseMove.bind(this),updateObject:this.updateObject.bind(this)}}return Object(I.a)(e,[{key:"onInit",value:function(){this.addEventListeners(),this.addReactions()}},{key:"onDestroy",value:function(){this.removeEventListener(),this.removeReactions()}},{key:"onSessionStart",value:function(){this.rootStore.canvasStore.setAllCursor("crosshair")}},{key:"onSessionEnd",value:function(){}},{key:"setShapeType",value:function(e){this.shapeType=e}},{key:"setFill",value:function(e){this.fill=e,this.objectStore.setFill(e)}},{key:"setStroke",value:function(e){this.stroke=e,this.objectStore.setStroke(e)}},{key:"setStrokeWidth",value:function(e){this.strokeWidth=e,this.objectStore.setStrokeWidth(e)}},{key:"addReactions",value:function(){this.selectionEventStore.subscribe(this.listeners.updateObject)}},{key:"removeReactions",value:function(){this.selectionEventStore.unsubscribe(this.listeners.updateObject)}},{key:"updateObject",value:function(e){this.objectStore.isShape(e)?(this.item=e,this.updateShapeStyles()):this.item=void 0}},{key:"updateShapeStyles",value:function(){if(this.item){var e=this.item,t=e.stroke,i=e.strokeWidth,n=e.fill;this.fill="string"===typeof n?n:void 0,this.stroke=t,this.strokeWidth=i||Ut.strokeWidth}}},{key:"addEventListeners",value:function(){this.mouseEventStore.subscribe(ht.MOUSE_UP,this.listeners.onMouseUp),this.mouseEventStore.subscribe(ht.MOUSE_DOWN,this.listeners.onMouseDown),this.mouseEventStore.subscribe(ht.MOUSE_MOVE,this.listeners.onMouseMove)}},{key:"removeEventListener",value:function(){this.mouseEventStore.unsubscribe(ht.MOUSE_UP,this.listeners.onMouseUp),this.mouseEventStore.unsubscribe(ht.MOUSE_DOWN,this.listeners.onMouseDown),this.mouseEventStore.unsubscribe(ht.MOUSE_MOVE,this.listeners.onMouseMove)}},{key:"isShapeTool",value:function(){return this.rootStore.canvasStore.canvasMode===w.SHAPE}},{key:"onMouseDown",value:function(e){this.isShapeTool()&&(this.isDragMode=!0,this.item=this.shapeType.getShape({left:e.startCursorPosition.x,top:e.startCursorPosition.y,stroke:this.stroke,strokeWidth:this.strokeWidth,fill:this.fill,selectable:!1,hoverCursor:"default",strokeUniform:!0}),this.item.isType(ut.RECT.value)||this.item.isType(ut.TRIANGLE.value)?this.item.set({width:0,height:0}):this.item.isType(ut.ELLIPSE.value)&&this.item.set({rx:0,ry:0}),this.rootStore.canvasStore.canvas.add(this.item))}},{key:"onMouseMove",value:function(e){this.isShapeTool()&&this.isDragMode&&this.item&&(e.currentCursorPosition.x<e.startCursorPosition.x&&this.item.set({left:Math.abs(e.currentCursorPosition.x)}),e.currentCursorPosition.y<e.startCursorPosition.y&&this.item.set({top:Math.abs(e.currentCursorPosition.y)}),this.item.set({flipX:e.currentCursorPosition.x<e.startCursorPosition.x}),this.item.set({flipY:e.currentCursorPosition.y<e.startCursorPosition.y}),this.item.isType(ut.RECT.value)||this.item.isType(ut.TRIANGLE.value)?this.item.set({width:Math.abs(e.startCursorPosition.x-e.currentCursorPosition.x),height:Math.abs(e.startCursorPosition.y-e.currentCursorPosition.y)}):this.item.isType(ut.ELLIPSE.value)&&this.item.set({rx:Math.abs(e.startCursorPosition.x-e.currentCursorPosition.x)/2,ry:Math.abs(e.startCursorPosition.y-e.currentCursorPosition.y)/2}),this.rootStore.canvasStore.canvas.renderAll())}},{key:"onMouseUp",value:function(t){if(this.isShapeTool()&&this.item){if(this.isDragMode=!1,this.item.isType(ut.RECT.value)||this.item.isType(ut.TRIANGLE.value))this.item.set({width:Math.max(e.MIN_OBJECT_SIZE,this.item.width||e.MIN_OBJECT_SIZE),height:Math.max(e.MIN_OBJECT_SIZE,this.item.height||e.MIN_OBJECT_SIZE)}).setCoords();else if(this.item.isType(ut.ELLIPSE.value)){var i=this.item;i.set({rx:Math.max(e.MIN_OBJECT_SIZE/2,i.rx||e.MIN_OBJECT_SIZE/2),ry:Math.max(e.MIN_OBJECT_SIZE/2,i.ry||e.MIN_OBJECT_SIZE/2)}).setCoords()}var n=this.rootStore.canvasStore;n.setCanvasMode(w.SELECT),n.canvas.setActiveObject(this.item),n.canvas.renderAll(),this.item=void 0}}}]),e}();Ft.MIN_OBJECT_SIZE=30;var Wt=function e(t){Object(M.a)(this,e),this.rootStore=t,Object(kt.l)(this)},Gt=i(192),Ht=i.n(Gt),Jt={FONT_SIZE:Re[Re.length/2],FILL:"#000000",FONT_FAMILY:Je.TIMES_NEW_ROMAN.value,TEXT_ALIGN:_e,FONT_STYLE:Ge,FONT_WEIGHT:Fe,UNDERLINE:!1},zt=function(){function e(t){Object(M.a)(this,e),this.rootStore=t,this.selectionEventStore=void 0,this.mouseEventStore=void 0,this.objectEventStore=void 0,this.objectStore=void 0,this.canvas=void 0,this.listeners=void 0,this.fontStyle=Jt.FONT_STYLE,this.fontWeight=Jt.FONT_WEIGHT,this.autoRenderId=void 0,this.fontSize=Jt.FONT_SIZE,this.fill=Jt.FILL,this.fontFamily=Jt.FONT_FAMILY,this.textAlign=Jt.TEXT_ALIGN,this.underline=Jt.UNDERLINE,this.item=void 0,Object(kt.l)(this),t.canvasStore.registerCanvasModeManager(w.TEXT,this),this.loadFont(),this.selectionEventStore=t.selectionEventStore,this.mouseEventStore=t.mouseEventStore,this.objectEventStore=t.objectEventStore,this.objectStore=t.objectStore,this.canvas=t.canvasStore.canvas,this.listeners={onMouseUp:this.onMouseUp.bind(this),onModified:this.onModified.bind(this),updateObject:this.updateObject.bind(this)}}return Object(I.a)(e,[{key:"onInit",value:function(){this.addEventListener(),this.addFontAutoRender()}},{key:"onDestroy",value:function(){this.removeEventListener(),this.removeFontAutoRender()}},{key:"onSessionStart",value:function(){this.rootStore.canvasStore.setAllCursor("text")}},{key:"onSessionEnd",value:function(){}},{key:"setFontSize",value:function(e){this.fontSize=e,this.item&&(this.item.set({fontSize:e}),this.canvas.renderAll())}},{key:"setFill",value:function(e){this.fill=e,this.objectStore.setFill(e)}},{key:"setFontFamily",value:function(e){var t;this.fontFamily=e,null===(t=this.item)||void 0===t||t.set({fontFamily:e})}},{key:"setTextAlign",value:function(e){var t;this.textAlign=e,null===(t=this.item)||void 0===t||t.set({textAlign:e})}},{key:"setUnderline",value:function(e){var t;this.underline=e,null===(t=this.item)||void 0===t||t.set({underline:e})}},{key:"setBold",value:function(e){var t,i=e?We:Fe;this.fontWeight=i,null===(t=this.item)||void 0===t||t.set({fontWeight:i})}},{key:"isBold",value:function(){return this.fontWeight===We}},{key:"setItalic",value:function(e){var t,i=e?"italic":"normal";this.fontStyle=i,null===(t=this.item)||void 0===t||t.set({fontStyle:i})}},{key:"isItalic",value:function(){return"italic"===this.fontStyle}},{key:"addEventListener",value:function(){this.mouseEventStore.subscribe(ht.MOUSE_UP,this.listeners.onMouseUp),this.objectEventStore.subscribe(Rt.OBJECT_MODIFIED,this.listeners.onModified),this.selectionEventStore.subscribe(this.listeners.updateObject)}},{key:"removeEventListener",value:function(){this.mouseEventStore.unsubscribe(ht.MOUSE_UP,this.listeners.onMouseUp),this.objectEventStore.unsubscribe(Rt.OBJECT_MODIFIED,this.listeners.onModified),this.selectionEventStore.unsubscribe(this.listeners.updateObject)}},{key:"updateObject",value:function(e){e&&this.objectStore.isText(e)?(this.item=e,this.updateTextStyles()):this.item=void 0}},{key:"updateTextStyles",value:function(){if(this.item){var e=this.item,t=e.fontSize,i=e.fill,n=e.fontFamily,s=e.textAlign,o=e.fontStyle,r=e.fontWeight,a=e.underline;this.fontSize=t||Jt.FONT_SIZE,this.fill="string"===typeof i?i:Jt.FILL,this.fontFamily=n||Jt.FONT_FAMILY,this.textAlign=s||Jt.TEXT_ALIGN,this.fontStyle=o===Ge||o===He?o:Jt.FONT_STYLE,this.fontWeight="string"===typeof r?r:Jt.FONT_WEIGHT,this.underline=!!a}}},{key:"onMouseUp",value:function(e){if(this.isTextTool()){this.item=new re.fabric.IText("\ud14d\uc2a4\ud2b8\ub97c \uc785\ub825\ud574\uc8fc\uc138\uc694",{top:e.currentCursorPosition.y,left:e.currentCursorPosition.x,fontSize:this.fontSize,fill:this.fill,fontFamily:this.fontFamily,textAlign:this.textAlign,fontStyle:this.fontStyle,fontWeight:this.fontWeight,underline:this.underline,lockUniScaling:!0}),this.item.setControlVisible("mt",!1),this.item.setControlVisible("mb",!1),this.item.setControlVisible("ml",!1),this.item.setControlVisible("mr",!1);var t=this.rootStore.canvasStore;t.canvas.add(this.item),t.setCanvasMode(w.SELECT),t.canvas.setActiveObject(this.item),this.item.selectAll(),this.item.enterEditing()}}},{key:"onModified",value:function(e){var t=e.target;if(t&&this.objectStore.isText(t)){var i=t,n=parseInt(((i.fontSize||Jt.FONT_SIZE)*(i.scaleX||1)).toFixed(0),10);i.set({scaleX:1,scaleY:1}),this.setFontSize(n)}}},{key:"isTextTool",value:function(){return this.rootStore.canvasStore.canvasMode===w.TEXT}},{key:"loadFont",value:function(){Ht.a.load({google:{families:Je.getGoogleFonts().map((function(e){return e.value}))}})}},{key:"addFontAutoRender",value:function(){var e=this;this.autoRenderId=setInterval((function(){e.canvas.getActiveObjects().filter((function(t){return e.objectStore.isText(t)})).forEach((function(e){var t=e;t.initDimensions(),t.dirty=!0})),re.fabric.util.clearFabricFontCache(),e.canvas.renderAll()}),1e3)}},{key:"removeFontAutoRender",value:function(){this.autoRenderId&&clearInterval(this.autoRenderId)}}]),e}(),Xt=function(){function e(t){Object(M.a)(this,e),this.rootStore=t,t.canvasStore.registerCanvasModeManager(w.SELECT,this)}return Object(I.a)(e,[{key:"onSessionStart",value:function(){this.rootStore.canvasStore.setSelectable(!0),this.rootStore.canvasStore.setHoverCursor("move")}},{key:"onSessionEnd",value:function(){}}]),e}(),Yt=function(){function e(t){Object(M.a)(this,e),this.rootStore=t,this.selectionEventStore=void 0,this.listeners=void 0,this.activeObject=void 0,Object(kt.l)(this),this.selectionEventStore=t.selectionEventStore,this.listeners={updateObject:this.updateObject.bind(this)}}return Object(I.a)(e,[{key:"onInit",value:function(){this.addReactions()}},{key:"onDestroy",value:function(){this.removeReactions()}},{key:"updateObject",value:function(e){this.activeObject=e}},{key:"addReactions",value:function(){this.selectionEventStore.subscribe(this.listeners.updateObject)}},{key:"removeReactions",value:function(){this.selectionEventStore.unsubscribe(this.listeners.updateObject)}},{key:"isRect",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.activeObject;return null===e||void 0===e?void 0:e.isType(ut.RECT.value)}},{key:"isEllipse",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.activeObject;return null===e||void 0===e?void 0:e.isType(ut.ELLIPSE.value)}},{key:"isTriangle",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.activeObject;return null===e||void 0===e?void 0:e.isType(ut.TRIANGLE.value)}},{key:"isShape",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.activeObject;return this.isRect(e)||this.isEllipse(e)||this.isTriangle(e)}},{key:"isPath",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.activeObject;return null===e||void 0===e?void 0:e.isType("path")}},{key:"isText",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.activeObject;return null===e||void 0===e?void 0:e.isType("i-text")}},{key:"isImage",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.activeObject;return null===e||void 0===e?void 0:e.isType("image")}},{key:"isActiveSelection",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.activeObject;return null===e||void 0===e?void 0:e.isType("activeSelection")}},{key:"isGroup",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.activeObject;return null===e||void 0===e?void 0:e.isType("group")}},{key:"getObjectTypeName",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.activeObject;return console.log(null===e||void 0===e?void 0:e.type),this.isRect(e)?ut.RECT.display:this.isEllipse(e)?ut.ELLIPSE.display:this.isTriangle(e)?ut.TRIANGLE.display:this.isPath(e)?"\ud328\uc2a4":this.isText(e)?"\ud14d\uc2a4\ud2b8":this.isImage(e)?"\uc774\ubbf8\uc9c0":this.isGroup(e)?"\uadf8\ub8f9":"\uc624\ube0c\uc81d\ud2b8"}},{key:"setFill",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.activeObject;this.setStyles("fill",e,t)}},{key:"setStroke",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.activeObject;this.setStyles("stroke",e,t)}},{key:"setStrokeWidth",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.activeObject;this.setStyles("strokeWidth",e,t)}},{key:"setScaleX",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.activeObject;this.setStyles("scaleX",e,t)}},{key:"setScaleY",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.activeObject;this.setStyles("scaleY",e,t)}},{key:"setStyles",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.activeObject;null===i||void 0===i||i.set(e,t)}}]),e}(),Vt=function(){function e(t){Object(M.a)(this,e),this.rootStore=t,this.uploadedImages=[],this.canvasStore=void 0,this.objectStore=void 0,Object(kt.l)(this),this.canvasStore=t.canvasStore,this.objectStore=t.objectStore}return Object(I.a)(e,[{key:"addImage",value:function(e){var t=this;re.fabric.Image.fromURL(e,(function(e){if(e.width&&e.height){if(e.width>t.canvasStore.width){var i=t.canvasStore.width/e.width*(3/4);t.objectStore.setScaleX(i,e),t.objectStore.setScaleY(i,e)}else if(e.height>t.canvasStore.height){var n=t.canvasStore.height/e.height*(3/4);t.objectStore.setScaleX(n,e),t.objectStore.setScaleY(n,e)}t.canvasStore.canvas.add(e)}}))}},{key:"upload",value:function(e){var t=this;e.forEach(function(){var e=Object(Y.a)(X.a.mark((function e(i){var n;return X.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.readFileAsync(i);case 2:"string"===typeof(n=e.sent)&&t.uploadedImages.push({name:i.name,dataUrl:n});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}},{key:"readFileAsync",value:function(e){return new Promise((function(t,i){var n=new FileReader;n.onload=function(){return t(n.result)},n.onerror=function(){return i()},n.readAsDataURL(e)}))}}]),e}(),Zt=new(function(){function e(){Object(M.a)(this,e),this.canvasElement=void 0,this.canvasStore=void 0,this.selectionEventStore=void 0,this.objectEventStore=void 0,this.mouseEventStore=void 0,this.objectStore=void 0,this.brushStore=void 0,this.shapeStore=void 0,this.textStore=void 0,this.imageStore=void 0,this.selectStore=void 0,this.UIStore=void 0,this.canvasElement=document.createElement("canvas"),document.body.append(this.canvasElement),this.canvasStore=new Lt(this,new re.fabric.Canvas(this.canvasElement)),this.selectionEventStore=new _t(this),this.objectEventStore=new Bt(this),this.mouseEventStore=new Nt(this),this.objectStore=new Yt(this),this.brushStore=new Tt(this),this.shapeStore=new Ft(this),this.textStore=new zt(this),this.imageStore=new Vt(this),this.selectStore=new Xt(this),this.UIStore=new Wt(this)}return Object(I.a)(e,[{key:"onInit",value:function(){Object.values(this).forEach((function(e){e.onInit&&e.onInit()}))}},{key:"onDestroy",value:function(){Object.values(this).forEach((function(e){e.onDestory&&e.onDestory()}))}},{key:"init",value:function(e){e.append(this.canvasElement.parentElement)}}]),e}()),Kt=i(97),qt=i(403),Qt=i(391),$t=i(134),ei=i.n($t),ti=function(){var e=s.a.useMemo((function(){return Object(Kt.a)({palette:{primary:{main:"#292929"},secondary:{main:"#aa75ff"}}})}),[]);return s.a.useEffect((function(){document.title="\uce94\ubc84\uc2a4",ei.a.initialize("G-4QR05JWTBZ"),ei.a.send(window.location.pathname)}),[]),Object(l.jsxs)(qt.a,{theme:e,children:[Object(l.jsx)(Qt.a,{}),Object(l.jsx)(x,{value:Zt,children:Object(l.jsx)(mt,{})})]})};r.a.render(Object(l.jsx)(ti,{}),document.getElementById("root"))}},[[339,1,2]]]);
//# sourceMappingURL=main.9a173342.chunk.js.map